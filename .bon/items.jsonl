{"id": "gdn-bazewe", "type": "action", "title": "Idle timer doesn't kill Claude mid-work", "brief": {"why": "5-minute idle timer fires purely on time, regardless of whether CC is actively streaming. Phone drops WiFi for 5 min during a long tool-use response → CC killed, response lost. Timer should only count down when Claude is idle AND no clients connected.", "what": "1. Bridge tracks streaming state (CC stdout activity) 2. Idle timer only starts when CC is idle AND clients.size === 0 3. Reset timer on any CC stdout activity", "done": "Claude doing a 10-minute tool-use sequence survives phone being away the whole time. Timer only fires after Claude finishes AND 5 min pass with no clients."}, "status": "done", "parent": "gdn-hatiho", "order": 9, "created_at": "2026-02-09T21:05:27Z", "created_by": "spm1001", "waiting_for": "After minimum tier. See docs/lifecycle-map.md medium tier.", "done_at": "2026-02-10T13:56:16Z"}
{"id": "gdn-bazogu", "type": "action", "title": "Check if auto_connect changed the stale session race (facipe interaction)", "brief": {"why": "Before tetini, page load connected via legacy ?session= path. Now it uses auto_connect + connectFolder — different code paths. facipe (page load bypasses picker) may be partially fixed or manifest differently.", "what": "1. Clear localStorage, reload page — should show picker (no auto-connect without stored folder) 2. Connect to folder, reload — should auto-connect (correct) 3. Compare with pre-tetini behaviour to see if facipe is resolved or changed", "done": "facipe status is known: either closed as side-effect of tetini, or updated with new reproduction steps"}, "status": "done", "parent": "gdn-cejaba", "order": 23, "created_at": "2026-02-09T23:23:11Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:59:36Z"}
{"id": "gdn-beceto", "type": "action", "title": "Push API with VAPID — phone in pocket notifications", "brief": {"why": "Notification API only works when the page is open. Push API works when the browser is quit or the PWA is backgrounded — the phone-in-pocket scenario. Bridge pushes to stored subscriptions when no WS clients are connected.", "what": "1. npm install web-push 2. Generate VAPID key pair, store in ~/.config/gueridon/vapid.json 3. Client subscribes via PushManager.subscribe() with applicationServerKey 4. Client sends PushSubscription to bridge via new WS message type 5. Bridge stores subscriptions in ~/.config/gueridon/push-subscriptions.json 6. On result event (bridge.ts L458) when clients.size === 0: webpush.sendNotification() 7. On AskUserQuestion when clients.size === 0: push with different message 8. SW push handler: showNotification with sound + vibration pattern 9. Vibration: short buzz for 'finished', double-buzz for 'needs input' 10. notificationclick: focus app with folder context in URL", "done": "Send prompt from phone. Lock phone, put in pocket. Phone buzzes when Claude finishes. Tap notification, land in the session."}, "status": "done", "parent": "gdn-jetune", "order": 4, "created_at": "2026-02-15T21:41:53Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["npm install web-push", "Generate VAPID key pair, store in ~/.config/gueridon/vapid.json", "Client subscribes via PushManager.subscribe() with applicationServerKey", "Client sends PushSubscription to bridge via new WS message type", "Bridge stores subscriptions in ~/.config/gueridon/push-subscriptions.json", "On result event (bridge.ts L458) when clients.size === 0: webpush.sendNotification()", "On AskUserQuestion when clients.size === 0: push with different message", "SW push handler: showNotification with sound + vibration pattern", "Vibration: short buzz for 'finished', double-buzz for 'needs input'", "notificationclick: focus app with folder context in URL"], "current": 10, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-15T22:26:44Z", "done_at": "2026-02-15T22:26:44Z"}
{"id": "gdn-besuse", "type": "outcome", "title": "Bridge handles real-world conditions without surprises", "brief": {"why": "Bridge is the single chokepoint between mobile clients and CC processes. Bugs here are invisible, hard to reproduce, and affect every session.", "what": "1. Fix spawnCC cwd bug 2. Clean up reset()/session message handling 3. Audit session-mode operations 4. Buffer user messages for replay 5. Fix reconnect folder status 6. Diagnose context burn 7. Extract IO handlers 8. Integration tests for idle guards, replay, smoke test, Test 7 fix", "done": "No garbled output, no zombie sessions, reconnect works reliably, integration tests prove it end-to-end."}, "status": "done", "order": 10, "created_at": "2026-02-10T20:11:39Z", "created_by": "spm1001", "done_at": "2026-02-21T21:47:47Z"}
{"id": "gdn-bezuwu", "type": "action", "title": "Reconnected session shows stale status in folder list", "brief": {"why": "After reconnecting to a session (replay from buffer), the folder list still shows the old status (paused/closed) instead of green/active. Technically correct — CC process hasn't respawned yet due to lazy loading — but misleading. User sees their conversation but the status dot says otherwise.", "what": "1. Trace folder list status derivation on reconnect — does activeByFolder get updated when replaying from buffer without a CC process? 2. Add a third visual state for 'has history, sleeping' (e.g. blue dot) — distinct from active (green) and paused (amber) 3. Eager spawn on reconnect to existing session (user is coming back to continue work) 4. Lazy spawn on fresh folder (no history, no reason to start CC until first prompt) 5. Update folder list status to reflect the eager/lazy split", "done": "Folder list status accurately reflects session state after reconnect. No misleading stale indicators."}, "status": "done", "parent": "gdn-besuse", "order": 5, "created_at": "2026-02-10T09:05:44Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add clientCount to SessionProcessInfo and update getActiveSessions filter", "Update bridge.ts wrapper to pass clients.size", "Update tests with clientCount fixtures and new cases", "Verify all tests pass"], "current": 4}, "done_at": "2026-02-12T19:20:09Z"}
{"id": "gdn-bikale", "type": "action", "title": "Resumed sessions still show orange dot in folder list", "brief": {"why": "After resuming a paused (orange dot) session, the folder list still shows it as paused/orange even though it is now live again. The folder state doesn't update to reflect that the session has been reconnected and the CC process is running.", "what": "1. Check what triggers folder status refresh — is it only on connectFolder or does it poll? 2. After resume, folder state should transition from paused to active 3. May need to emit a status update event when session reconnects", "done": "Folder list shows correct status (green/active) after resuming a previously paused session"}, "status": "done", "parent": "gdn-hatiho", "order": 14, "created_at": "2026-02-10T08:49:43Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:52:34Z"}
{"id": "gdn-bineme", "type": "action", "title": "Slash command button inconsistently visible", "brief": {"why": "The / button is display:none until CC's init event delivers slash_commands. Before first prompt (CC not spawned), on reconnect, or if init doesn't include commands — no button. Inconsistent across screenshots. Even when slash commands aren't loaded yet, the button should be present as a UI element.", "what": "1. Show / button whenever a folder is selected (not gated on slashCommands data) 2. If tapped before commands have loaded, show a placeholder or trigger CC spawn 3. Alternatively, populate with client-side local commands (exit, compact, context, cost) immediately, merge server commands when init arrives", "done": "/ button visible whenever a folder is connected. Local commands always available. Server commands merge in after init."}, "status": "done", "parent": "gdn-situwu", "order": 51, "created_at": "2026-02-23T22:56:22Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:47:51Z"}
{"id": "gdn-bogavu", "type": "action", "title": "Deterministic UI testing without CC", "brief": {"why": "Testing UI requires real CC (15s waits, non-deterministic). Need sub-second, repeatable visual tests via state injection.", "what": "1. Create fixture-harness.ts (state injection + message builders) 2. Wire ?fixture= param in main.ts 3. Create kitchen-sink fixture JSON 4. Create tool-chain fixture 5. Create ask-user fixture 6. Verify with passe screenshot", "done": "/?fixture=kitchen-sink renders table/code/lists. Passe screenshot produces identical output across rebuilds. No WS connection or folder picker in fixture mode."}, "status": "done", "parent": "gdn-situwu", "order": 18, "created_at": "2026-02-17T03:29:33Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Create fixture-harness.ts (state injection + message builders)", "Wire ?fixture= param in main.ts", "Create kitchen-sink fixture JSON", "Create tool-chain fixture", "Create ask-user fixture", "Verify with passe screenshot"], "current": 6, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-17T03:35:07Z", "done_at": "2026-02-17T03:35:07Z"}
{"id": "gdn-bojijo", "type": "action", "title": "Context gauge accuracy — verify against /context", "brief": {"why": "Gauge shows 36% but no way to cross-check from -p mode. If the percentage is wrong, users make bad decisions about session length. The gauge was the first feature built and hasn't been validated against CC's own /context output since.", "what": "1. Manually compare gauge % with /context output in a desktop CC session on the same folder 2. Check contextWindow source — is it hardcoded, inferred from model name, or reported by CC? 3. Check if usage survives replay (should it? probably not — replay doesn't consume new tokens) 4. If CC reports contextWindow in result events, use that; if not, document the assumption", "done": "Gauge percentage matches /context within 5%. Source of contextWindow value is documented."}, "status": "done", "parent": "gdn-paciju", "order": 3, "created_at": "2026-02-10T09:10:37Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-16T19:37:36Z"}
{"id": "gdn-bubasa", "type": "action", "title": "Integration test for idle guards in test-bridge.ts", "brief": {"why": "checkIdle is tested as pure function (21 tests) but the wiring in bridge.ts (scheduleIdleCheck → checkIdle → kill/recheck) is only testable with a running bridge. Same gap pattern as other bridge IO.", "what": "1. Add test: send prompt, disconnect WS, wait past IDLE_TIMEOUT_MS, verify CC still alive (mid-turn) 2. Add test: CC finishes turn, verify grace period, then kill 3. Add test: safety cap kills after MAX_IDLE_MS", "done": "test-bridge.ts has 3 idle guard integration tests that pass against running bridge"}, "status": "done", "parent": "gdn-puzoni", "order": 2, "created_at": "2026-02-10T05:57:04Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T21:47:01Z", "updated_by": "edited", "done_at": "2026-02-21T22:56:10Z"}
{"id": "gdn-bujove", "type": "outcome", "title": "Opening the app and picking a folder just works", "brief": {"why": "4 actions spanning folder selector UI and bridge — dashboard status, new folder creation, close trigger, and service worker. All about the first-and-last thing you interact with.", "what": "1. Folder list shows live session status 2. New folder creation with fun names 3. Mobile close trigger and nudge 4. Service worker caches app shell for offline", "done": "App loads offline, folder list is a dashboard, new folders are fun, sessions close gracefully"}, "status": "done", "order": 13, "created_at": "2026-02-10T20:11:42Z", "created_by": "spm1001", "done_at": "2026-02-21T22:27:15Z"}
{"id": "gdn-burera", "type": "action", "title": "Idle guards: don't kill CC while it's working", "brief": {"why": "Bridge kills CC after 5min of no WS clients regardless of whether CC is mid-turn. Long tool executions get killed.", "what": "1. IdleGuard interface + checkIdle pure function in bridge-logic.ts 2. ActiveTurnGuard with staleness detection 3. Grace period after work completes 4. Wire into bridge.ts replacing old single-timer 5. Tests", "done": "CC survives idle timeout when mid-turn. Stale CC (10min no output) gets killed. Grace period grants 5min after work finishes. Safety cap at 30min. 21 tests pass."}, "status": "done", "parent": "gdn-cejaba", "order": 25, "created_at": "2026-02-10T05:56:42Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T05:56:46Z"}
{"id": "gdn-cahato", "type": "action", "title": "New folder creation with fun names", "brief": {"why": "Sometimes you start fresh — new project, new experiment. 'New folder' creates ~/Repos/<name>, git inits it, and starts a session there. Auto-naming removes friction and adds character.", "what": "1. Add 'New folder' option to folder selector 2. Generate fun name (adjective-noun, alliterative, or similar) 3. mkdir ~/Repos/<name> && git init 4. Connect to new folder automatically", "done": "Tapping 'New folder' creates a git-initialised directory with a fun auto-generated name and starts a session in it."}, "status": "done", "parent": "gdn-bujove", "order": 2, "created_at": "2026-02-08T22:13:16Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T00:14:58Z"}
{"id": "gdn-cahoci", "type": "action", "title": "Message queueing — bridge as postmaster", "brief": {"why": "If Claude is mid-turn, user messages are rejected. Would be great to queue them so Claude gets the message when it surfaces.", "what": "1. Bridge accepts prompt messages while CC is mid-turn 2. Queue on session object 3. Flush queue when result event fires 4. Client shows queued status", "done": "User can type a follow-up while Claude is working. It arrives as soon as Claude finishes."}, "status": "done", "parent": "gdn-lefoze", "order": 2, "created_at": "2026-02-15T19:30:54Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Bridge accepts prompt messages while CC is mid-turn", "Queue on session object", "Flush queue when result event fires", "Client shows queued status"], "current": 4, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-15T20:52:41Z", "done_at": "2026-02-15T20:52:41Z"}
{"id": "gdn-cawuge", "type": "action", "title": "Context fuel gauge and compaction visibility", "brief": {"why": "Mobile sessions run long without visibility into context usage. Users need a glanceable indicator (not a command to type) and notification when compaction happens, so they can manage session length.", "what": "1. Track usage from CC result events in adapter (input_tokens / contextWindow = percent) 2. Build context gauge component with color thresholds (>70% yellow, >90% red) 3. Detect compaction (input_tokens drop between turns) and surface as notification 4. Use hybrid estimation from pi-mono: last known usage + chars/4 for trailing messages", "done": "Context percentage visible in mobile UI, updates after each turn, yellow/red thresholds work, compaction events shown as notifications"}, "status": "done", "parent": "gdn-cejaba", "order": 5, "created_at": "2026-02-08T10:31:56Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-08T17:57:19Z"}
{"id": "gdn-cejaba", "type": "outcome", "title": "Access Claude Code from mobile with full harness", "brief": {"why": "Claude Code is terminal-only. Full experience (MCPs, CLAUDE.md, skills, tools) needs to be accessible from phone/tablet on home network, using MAX subscription instead of API billing.", "what": "1. ClaudeCodeAgent adapter implementing pi-web-ui Agent interface 2. JSONL event mapper (CC events → pi AgentEvents) 3. Node.js bridge server (WebSocket ↔ stdio) 4. Web app shell with pi-web-ui components 5. Directory picker for session launch 6. Tool execution viewer 7. AskUserQuestion mobile rendering", "done": "Can use guéridon daily on my phone: repeatable test workflow, clean mobile UI, connection failures handled gracefully, image input works, can create new folders. Core loop is reliable enough for real work."}, "status": "done", "order": 2, "created_at": "2026-02-08T10:31:43Z", "created_by": "spm1001", "done_at": "2026-02-10T20:12:07Z"}
{"id": "gdn-celuko", "type": "action", "title": "Resolve artifacts tool mismatch", "brief": {"why": "ChatPanel.setAgent() injects an artifacts tool via toolsFactory. CC doesn't know about this tool — it uses Write for artifacts. The artifacts panel will show UI that doesn't map to CC's capabilities.", "what": "1. Check if CC supports an artifacts-equivalent tool or if Write is the only path 2. If CC handles artifacts differently, map to appropriate UI rendering 3. If no CC artifacts support, remove artifacts tool injection and document why", "done": "Artifacts either render correctly through CC's tool output, or the artifacts path is cleanly removed with a note explaining CC's approach"}, "status": "done", "parent": "gdn-paciju", "order": 5, "created_at": "2026-02-08T17:58:07Z", "created_by": "spm1001", "waiting_for": "Deferred: CC uses Write for artifacts, text chat works fine without artifacts panel. Revisit when core mobile flow is solid.", "done_at": "2026-02-24T05:13:15Z"}
{"id": "gdn-cewibe", "type": "action", "title": "Jump to top and jump to bottom tappable controls (lost in v2 rewrite)", "brief": {"why": "Long conversations on mobile need quick navigation — no keyboard shortcuts available, scrolling through a long session is tedious", "what": "1. Floating jump-to-bottom button (appears when scrolled up) 2. Jump-to-top gesture or button 3. Keep controls minimal and out of the way", "done": "Tappable controls for top/bottom navigation, unobtrusive when not needed"}, "status": "done", "parent": "gdn-situwu", "order": 5, "created_at": "2026-02-10T08:18:40Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T00:14:58Z", "updated_at": "2026-02-23T22:45:24Z", "updated_by": "edited"}
{"id": "gdn-cihuvu", "type": "action", "title": "Message box placeholder as status channel", "brief": {"why": "The input placeholder 'Message Claude...' is static and wastes prime screen real estate. It could communicate state: connection progress, model name, busy status.", "what": "1. Placeholder shows 'Choose a folder...' when no folder selected (tapping opens switcher) 2. Placeholder shows 'Connecting...' during reconnect 3. Changes to 'Message Claude Opus 4.6' (actual model from session.model) when connected and idle 4. Shows 'Thinking...' when Claude is working (status === 'working') 5. Input remains enabled during Thinking (user can queue messages)", "done": "Placeholder reflects current state across all phases: no folder → connecting → connected (with model name). Tapping placeholder when no folder selected opens the folder chooser."}, "status": "done", "parent": "gdn-situwu", "order": 36, "created_at": "2026-02-23T22:33:27Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T22:57:50Z", "updated_by": "edited", "done_at": "2026-02-23T23:47:51Z"}
{"id": "gdn-cocara", "type": "action", "title": "Parallel tool call failures don't cascade", "brief": {"why": "When CC runs parallel tool calls and one fails, the bridge marks siblings as errored too. Claude loses valid results, wastes tokens re-running them, and can't tell real failures from collateral damage.", "what": "1. Investigate how CC reports parallel tool results in stream-json 2. Check whether the sibling poisoning is bridge-side or CC-side 3. If bridge-side, ensure each tool result is forwarded independently 4. If CC-side, document as upstream limitation", "done": "Investigated in wt-sleuthing session b535b0c5. Confirmed CC-side behaviour — bridge forwards each tool result independently, but CC itself emits <tool_use_error>Sibling tool call errored</tool_use_error>. Upstream limitation, not bridge-side."}, "status": "done", "parent": "gdn-zewumo", "order": 1, "created_at": "2026-02-11T07:58:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:34:53Z"}
{"id": "gdn-cofuci", "type": "action", "title": "Session exit and closure nudge on mobile", "brief": {"why": "Desktop /exit is typed, Ctrl-C works. Mobile has neither. User has no way to intentionally end a conversation and start fresh. The fuel gauge already tracks context — when it hits amber/red, nudge the user to wrap up.", "what": "1. Verify whether /exit works through bridge stdin 2. If not, add bridge-level session termination endpoint 3. Add close/wrap-up button in UI (perhaps in gauge area when amber/red) 4. On tap, send close-session signal to CC 5. When gauge hits amber, show nudge toast 6. Ensure ended session doesn't resume on next folder connect — .exit marker written 7. On explicit close, write handoff and return to lobby", "done": "User can tap to close a session. /exit or equivalent cleanly ends session. Amber gauge shows closure nudge. Next connect to same folder starts fresh. No ghost process left behind."}, "status": "done", "parent": "gdn-situwu", "order": 21, "created_at": "2026-02-08T22:13:27Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T07:11:33Z", "updated_by": "stepped", "tactical": {"steps": ["Add ssePostExit() function after ssePostAbort()", "Add exitSession() function", "Add long-press handler on status bar (800ms confirm)", "Add tap handler on context gauge when amber/red", "Test and verify all triggers work"], "current": 5, "session": "/home/modha/Repos/gueridon"}, "done_at": "2026-02-23T07:11:33Z"}
{"id": "gdn-cogoga", "type": "action", "title": "Wire showError to all bridge error paths", "brief": {"why": "showError (persistent banner) only fires on onFolderConnectFailed. Process exits, bridge errors, and early exit diagnostics still go to console.error or showToast. Users don't see these on mobile.", "what": "1. Audit all onBridgeError, onProcessExit, and error event paths in main.ts 2. Route connection-class errors to showError with appropriate action buttons 3. Keep transient info (compaction, image format) on showToast", "done": "All user-relevant errors show as persistent banners. Console-only errors are limited to debug-level issues."}, "status": "done", "parent": "gdn-situwu", "order": 14, "created_at": "2026-02-15T20:29:31Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Audit all onBridgeError, onProcessExit, and error event paths in main.ts", "Route connection-class errors to showError with appropriate action buttons", "Keep transient info (compaction, image format) on showToast"], "current": 3, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-15T21:04:06Z", "done_at": "2026-02-15T21:04:06Z"}
{"id": "gdn-copuhu", "type": "action", "title": "Hot cert reload without bridge restart", "brief": {"why": "Monthly cert renewal restarts the bridge, killing all CC processes and in-flight turns. Single-user so rare pain, but avoidable.", "what": "1. Watch cert files with fs.watch or chokidar 2. On change, read new cert/key and call server.setSecureContext() 3. Remove restart from gueridon-cert-renew.service 4. Test: manually run renewal, verify bridge stays up and new cert is served", "done": "Cert renewal happens without any visible disruption. No process restart, no dropped sessions."}, "status": "done", "parent": "gdn-jetune", "order": 5, "created_at": "2026-02-15T22:17:23Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T22:22:20Z"}
{"id": "gdn-cukopi", "type": "action", "title": "AskUserQuestion buttons disappear after push notification interaction", "brief": {"why": "On mobile, when a push notification arrives and the user returns to the app, pending AskUserQuestion tappable buttons sometimes vanish. The user can't answer the question without reloading. Reported multiple times.", "what": "1. Reproduce: trigger AskUserQuestion, background the app, tap push notification to return 2. Identify whether the buttons are lost on WS reconnect, page visibility change, or re-render 3. Fix — ensure pending questions survive app backgrounding and notification interaction 4. Test the fix", "done": "AskUserQuestion buttons persist after backgrounding and returning via push notification"}, "status": "done", "parent": "gdn-situwu", "order": 17, "created_at": "2026-02-16T18:52:05Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-24T05:13:15Z"}
{"id": "gdn-dacega", "type": "action", "title": "Build test catches transitive dependency failures", "brief": {"why": "npm run build would have caught the @smithy import failure from session 3. Currently no build-time test exists — transitive dependency issues only surface when someone manually runs a production build.", "what": "1. Add a vitest test that runs npm run build and asserts exit code 0 2. Consider adding to a pre-commit hook or CI", "done": "npm test includes a build check. Transitive import failures are caught automatically."}, "status": "done", "parent": "gdn-vevoca", "order": 7, "created_at": "2026-02-09T09:44:44Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add a vitest test that runs npm run build and asserts exit code 0", "Consider adding to a pre-commit hook or CI"], "current": 2}, "done_at": "2026-02-09T09:55:09Z"}
{"id": "gdn-dadupo", "type": "action", "title": "User-friendly docs for other people and their Claudes", "brief": {"why": "Can't ship without docs. Current CLAUDE.md is internal. Other users need setup instructions, architecture overview, and troubleshooting.", "what": "1. Write README.md with quick start, prerequisites, deployment 2. Simplify CLAUDE.md for external consumption 3. Add troubleshooting section", "done": "A new user can clone, deploy, and use Guéridon from README alone"}, "status": "done", "parent": "gdn-lefoze", "order": 1, "created_at": "2026-02-15T19:30:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-21T22:48:48Z"}
{"id": "gdn-darovu", "type": "action", "title": "Teletype text appearance animation during Claude thinking", "brief": {"why": "StreamingMessageContainer renders every partial update as it arrives from CC, causing a teletype effect that's painful to watch on mobile. Content should appear in readable chunks, not character-by-character.", "what": "Superseded by gdn-hanaje (Coalesce CC partials before forwarding to clients). Root cause identified as bridge-side transport issue, not client-side rendering. The teletype effect is caused by the bridge forwarding every CC stdout line as a separate ws.send() at token rate — on mobile/cellular, network delivery is lumpy, producing visible text dribble. Fix is tick-based conflation in the bridge, not animation in the client.", "done": "Streaming text appears in readable chunks. No visible character-by-character teletype effect."}, "status": "done", "parent": "gdn-situwu", "order": 3, "created_at": "2026-02-10T08:18:31Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T21:42:41Z"}
{"id": "gdn-defedu", "type": "action", "title": "Context gauge shows wrong percentage at session start", "brief": {"why": "Likely not a separate bug — context gauge was reading odd-opal session's context because folder switch didn't isolate (gdn-padebo). Note: the percentage represents FREE space, not used. If fixing gdn-padebo resolves this, close as duplicate. Only investigate independently if gauge is still wrong after folder isolation fix.", "what": "1. Trace contextPercent through adapter reset and folder switch 2. Check if CC sends context info on resume that gets misread 3. Verify against /context endpoint", "done": "Fresh session shows plausible context % (low single digits), not 93%"}, "status": "done", "parent": "gdn-paciju", "order": 7, "created_at": "2026-02-16T07:06:30Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-16T07:10:38Z", "done_at": "2026-02-16T19:37:26Z"}
{"id": "gdn-dejave", "type": "action", "title": "Typing indicator in bridge protocol", "brief": {"why": "Claude can't tell if the human is mid-thought or has walked away. Short messages could be 'quick ack, more coming' or 'that's everything'. Native CC has input indicators. The bridge could surface composing state to Claude via a protocol message.", "what": "1. Add composing/idle state to bridge protocol (client sends typing start/stop) 2. Decide whether to surface this to CC (via system message? via tool result metadata?) 3. Keep it lightweight — no heartbeat overhead", "done": "Claude can distinguish 'user is typing' from 'user is waiting for me'. No false positives from idle connections."}, "status": "open", "parent": "gdn-zewumo", "order": 4, "created_at": "2026-02-11T07:59:23Z", "created_by": "spm1001", "waiting_for": "No CC stdin mechanism for ambient state; archive", "updated_at": "2026-02-23T20:54:50Z", "updated_by": "waited"}
{"id": "gdn-dicire", "type": "outcome", "title": "Bridge classifies and surfaces slash commands systematically", "brief": {"why": "Slash commands are handled ad-hoc: /exit has a one-off interceptor, local commands were silently dropped (now fixed), and the bridge has no awareness of what commands exist. CC already provides the data (slash_commands and skills arrays in init events) — we just need to use it.", "what": "1. Command registry pure functions in bridge-logic.ts 2. Wire registry into bridge session from init events 3. Forward command list to clients via new bridge message 4. Store command list in adapter for future autocomplete", "done": "Bridge logs command classification on init, client receives commandList message with categories, all existing tests pass plus new registry tests"}, "status": "done", "order": 17, "created_at": "2026-02-12T06:57:57Z", "created_by": "spm1001", "done_at": "2026-02-21T22:30:30Z"}
{"id": "gdn-donave", "type": "action", "title": "Merge idle-guards + keduci-zaseze + facipe-bazogu into main", "brief": {"why": "Three worktree branches diverged from main. All touch bridge.ts and bridge-logic.ts. Session interface changes (idle guards adds fields, removes idleTimer) need manual resolution.", "what": "1. Merge keduci-zaseze into main (largest diff, most active) 2. Merge idle-guards (Session interface conflict expected) 3. Merge facipe-bazogu 4. Run full test suite after each merge 5. Remove worktrees (git worktree remove)", "done": "main has all three branches merged, 280+ tests pass, worktrees cleaned up"}, "status": "done", "parent": "gdn-cejaba", "order": 26, "created_at": "2026-02-10T05:56:56Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Merge keduci-zaseze into main (largest diff, most active)", "Merge idle-guards (Session interface conflict expected)", "Merge facipe-bazogu", "Run full test suite after each merge", "Remove worktrees (git worktree remove)"], "current": 5}, "done_at": "2026-02-10T07:50:25Z"}
{"id": "gdn-dosiji", "type": "action", "title": "Horizontal scroll possible in Safari (not standalone) — should be locked", "brief": {"why": "In Safari (not web app mode), long content like code blocks or wide text allows the entire page to scroll horizontally, showing clipped content on both sides. Should be locked to vertical scroll only.", "what": "1. Add overflow-x: hidden to body and/or html 2. Ensure code blocks still scroll independently within their container (overflow-x: auto on pre is fine, parent must clip) 3. Test in Safari — not just standalone mode", "done": "Cannot scroll the page horizontally in Safari. Code blocks scroll within their own container."}, "status": "done", "parent": "gdn-situwu", "order": 41, "created_at": "2026-02-23T22:36:11Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:02:32Z"}
{"id": "gdn-dozosa", "type": "outcome", "title": "returnToLobby unit test in ws-transport.test.ts", "brief": {"why": "returnToLobby had a WS onclose race that created duplicate connections. Fixed by detaching handlers before close. Without a test, this could regress.", "what": "Add test: returnToLobby detaches old WS handlers, creates single new connection, deferred connectFolder fires on lobby", "done": "ws-transport.test.ts covers returnToLobby lifecycle including handler detach"}, "status": "done", "order": 8, "created_at": "2026-02-09T15:00:11Z", "created_by": "spm1001", "done_at": "2026-02-09T15:46:40Z"}
{"id": "gdn-facipe", "type": "action", "title": "Page load bypasses folder picker — silently connects to stale session", "brief": {"why": "Every page load auto-connects to whatever folder was last active instead of showing the folder picker. Users opening guéridon fresh expect to choose. Flagged in two handoffs but never tracked.", "what": "1. Trace why WS connects with ?session= on fresh page load 2. Check if bridge sends 'connected' on stale session 3. Decide: should fresh load always go to lobby, or only when no active session?", "done": "Fresh page load shows folder picker (or intentional auto-reconnect with clear UX)"}, "status": "done", "parent": "gdn-cejaba", "order": 22, "created_at": "2026-02-09T22:47:47Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:59:36Z"}
{"id": "gdn-fapumi", "type": "action", "title": "Run tests, fix regressions from console.log removal, add tests for new modules", "brief": {"why": "Replacing 40 console calls risks breaking tests that mock or assert on console output. New modules need their own tests.", "what": "1) Run existing test suite and fix any failures from console.log removal. 2) Add unit tests for event-bus (emit/subscribe round-trip). 3) Add unit tests for status-buffer (ring buffer wrap, getRecent ordering). 4) Add unit tests for logger (level filtering, stderr output, LOG_FILE). 5) Verify /status and /client-error in integration tests if feasible.", "done": "All existing tests pass. New modules have unit tests. No regressions."}, "status": "done", "parent": "gdn-wecimo", "order": 12, "created_at": "2026-02-22T17:28:32Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Run full test suite and identify failures", "Fix any regressions", "Verify all tests pass"], "current": 3, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-23T06:53:33Z", "updated_by": "stepped", "done_at": "2026-02-23T06:53:33Z"}
{"id": "gdn-febuhu", "type": "action", "title": "Scroll to bottom on resume and new messages", "brief": {"why": "On session resume the conversation stays at current scroll position instead of jumping to the latest message — user has to manually scroll down to see where they left off", "what": "1. Auto-scroll to bottom on session resume/replay complete 2. Auto-scroll on new assistant message chunks during streaming 3. Respect user intent — if user has scrolled up to read, don't yank them down", "done": "Resume pins to bottom, streaming follows bottom, manual scroll-up is respected"}, "status": "done", "parent": "gdn-situwu", "order": 4, "created_at": "2026-02-10T08:18:36Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T00:14:58Z"}
{"id": "gdn-fecejo", "type": "action", "title": "Slash menu gets a search/filter box", "brief": {"why": "CC exposes dozens of slash commands (builtins + skills). On mobile, scrolling a long list to find a command is slow. The folder chooser already solved this with a filter input — slash menu should match.", "what": "1. Add a text input at the top of the slash sheet (below the handle, above the list) 2. Filter commands by name and description as user types 3. Auto-focus the input when the sheet opens 4. Follow the existing switcher-search pattern for styling", "done": "Typing in the slash sheet filter narrows visible commands in real time. Clearing shows all. Input auto-focuses on open. Visual style matches folder chooser search."}, "status": "open", "parent": "gdn-situwu", "order": 59, "created_at": "2026-02-24T06:05:47Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-fepegi", "type": "action", "title": "Worktree merge strategy and conflict hotspots", "brief": {"why": "Five worktrees (bridge, render, adapter, folder, cli) branching from same commit will diverge. package.json, vite.config.ts, and src/main.ts are touched by multiple workstreams. Bridge and folder worktrees have highest conflict risk since bujove (lifecycle) touches transport and besuse (bridge) touches the server side of the same connection.", "what": "1. Document merge order (independent branches first, conflicting ones last). 2. Identify shared files that need coordination. 3. Establish merge cadence — merge early, merge often. 4. Arc items committed only on main.", "done": "Documented merge strategy. First round of merges succeeds without surprise conflicts."}, "status": "done", "parent": "gdn-besuse", "order": 13, "created_at": "2026-02-11T13:57:26Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T00:14:58Z"}
{"id": "gdn-figina", "type": "action", "title": "Multi-WS sessions with broadcast", "brief": {"why": "Multiple browser tabs can connect to the same folder. They should share a CC process and all receive events. Currently Session.ws is a single WebSocket.", "what": "1. Change Session.ws from WebSocket|null to Set<WebSocket> 2. Add reverse map ws→sessionId for disconnect lookups 3. All sendToClient calls become broadcast to Set 4. Idle timer starts when Set empties (all tabs gone) 5. Ping/pong remains per-WebSocket 6. connectFolder checks activeByFolder — if session exists, join it", "done": "Two WS connections to same folder share one CC process. Both receive streamed events. Disconnecting one doesn't kill the session. Disconnecting both starts idle timer."}, "status": "done", "parent": "gdn-zovogo", "order": 3, "created_at": "2026-02-09T06:15:26Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Change Session.ws from WebSocket|null to Set<WebSocket>", "Add reverse map ws→sessionId for disconnect lookups", "All sendToClient calls become broadcast to Set", "Idle timer starts when Set empties (all tabs gone)", "Ping/pong remains per-WebSocket", "connectFolder checks activeByFolder — if session exists, join it"], "current": 6}, "done_at": "2026-02-09T07:17:19Z"}
{"id": "gdn-fihale", "type": "action", "title": "Unexpected new session instead of resuming existing one", "brief": {"why": "Sometimes connecting to a folder starts a fresh session instead of resuming the previous one. User expects continuity but gets a blank slate. May be related to idle timeout killing the process and resume not working, or session ID getting lost.", "what": "Root cause: resolveSessionForFolder treats ANY handoff as 'closed' — a stale handoff from session N blocks resume of session N+1. The handoff check needs to compare the handoff's sessionId against the latest session file's ID. Additionally, bridge restart wipes in-memory sessions Map, so it always falls through to disk-based resolution (which hits the stale handoff bug). Fix: 1. Compare handoff sessionId to latestSession.id — only treat as closed if they match 2. Add logging to resolveSessionForFolder so we can see which branch was taken 3. Consider persisting active session→folder mapping to survive bridge restarts", "done": "Reconnecting to a folder with existing history always resumes unless user explicitly started fresh"}, "status": "done", "parent": "gdn-besuse", "order": 18, "created_at": "2026-02-16T08:09:11Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-16T08:51:21Z", "tactical": {"steps": ["Compare handoff sessionId to latestSession.id — only treat as closed if they match", "Add logging to resolveSessionForFolder so we can see which branch was taken", "Consider persisting active session→folder mapping to survive bridge restarts"], "current": 3, "session": "/home/modha/Repos/gueridon"}, "done_at": "2026-02-16T08:51:21Z"}
{"id": "gdn-fiheju", "type": "action", "title": "Move isStreaming management into stream event handlers", "brief": {"why": "isStreaming is only set by prompt() — not by stream events. During replay, no prompt() is called, so endReplay() has to manually set isStreaming=true when streamMessage exists. This workaround will be confusing if someone later refactors the streaming pipeline.", "what": "1. Set isStreaming=true in startStreamMessage() (stream_event message_start handler) 2. Remove the isStreaming=true from prompt() since stream events will handle it 3. Remove the workaround in endReplay() 4. Verify all tests pass", "done": "isStreaming is managed by stream events, not prompt(). endReplay workaround removed."}, "status": "done", "parent": "gdn-paciju", "order": 1, "created_at": "2026-02-09T23:23:19Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:25:49Z"}
{"id": "gdn-fosoci", "type": "action", "title": "Clean up agent_end emit in reset() and async session message handling", "brief": {"why": "reset() emits agent_end to trigger UI sync — semantically loose, could cause bugs if agent_end gets specific behavior later. handleSessionMessage is async with a .catch() band-aid instead of a proper queue like lobby messages use.", "what": "1. Consider a dedicated 'agent_reset' event type instead of reusing agent_end 2. Add session message queue pattern matching lobby handler 3. Review subscription handler for agent_end-specific side effects", "done": "reset() uses purpose-built event, session messages have proper async error handling"}, "status": "done", "parent": "gdn-besuse", "order": 2, "created_at": "2026-02-09T22:48:09Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:14:27Z"}
{"id": "gdn-fuhepu", "type": "action", "title": "Bridge spawns CC with --allowed-tools instead of --dangerously-skip-permissions", "brief": {"why": "--dangerously-skip-permissions bypasses all safety checks. --allowed-tools + --permission-mode default lets settings.json govern Bash while auto-approving safe tools. Blocks sharing Guéridon with others.", "what": "1. Replace --dangerously-skip-permissions with --allowed-tools listing all tools permissively 2. Add --permission-mode default 3. Update tests", "done": "Bridge no longer uses --dangerously-skip-permissions. Allowed Bash patterns work without prompting. Setting PERMISSION_BYPASS=1 reverts to old behavior. Tests pass."}, "status": "done", "parent": "gdn-zewumo", "order": 11, "created_at": "2026-02-16T18:53:51Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T21:18:35Z", "updated_by": "edited", "done_at": "2026-02-23T21:18:39Z"}
{"id": "gdn-fuhola", "type": "action", "title": "Folder scan module with filesystem state derivation", "brief": {"why": "The bridge needs to enumerate ~/Repos/ folders and determine each one's session state (active/paused/closed/fresh) without maintaining a registry. CC already stores session files at ~/.claude/projects/<encoded>/ and handoffs at ~/.claude/handoffs/<encoded>/.", "what": "1. Create server/folders.ts with encodePath(), getLatestSession(), getLatestHandoff(), scanFolders() 2. Scan ~/Repos/ dirs, stat each for type 3. For each: check CC projects dir for .jsonl files (paused), check handoffs for .md files (closed) 4. State logic: active from runtime map, paused wins over closed, fresh if neither 5. Sort: active > paused > closed > fresh 6. Test standalone with a script that logs the enriched list", "done": "scanFolders() returns correct state for guéridon (paused), a fresh repo (fresh), and folders with handoffs (closed). Standalone test script verifies."}, "status": "done", "parent": "gdn-zovogo", "order": 1, "created_at": "2026-02-09T06:15:11Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Create server/folders.ts with encodePath(), getLatestSession(), getLatestHandoff(), scanFolders()", "Scan ~/Repos/ dirs, stat each for type", "For each: check CC projects dir for .jsonl files (paused), check handoffs for .md files (closed)", "State logic: active from runtime map, paused wins over closed, fresh if neither", "Sort: active > paused > closed > fresh", "Test standalone with a script that logs the enriched list"], "current": 6}, "done_at": "2026-02-09T06:17:17Z"}
{"id": "gdn-fuveso", "type": "action", "title": "Safari Reader Mode shows stale content after session switch", "brief": {"why": "Safari Reader Mode captures a snapshot of the DOM. Switching sessions changes the underlying content but Reader Mode retains its cached snapshot. Re-entering Reader Mode after a session switch shows the old session's content instead of the current one.", "what": "1. Investigate whether this is a Safari Reader Mode caching behaviour we can influence (meta tags, DOM mutation signals) 2. Check if there is a way to invalidate Reader Mode cache on session switch (document.title change, significant DOM restructure) 3. If Safari-side and unfixable, document as known limitation", "done": "Re-entering Reader Mode after a session switch shows current session content, OR documented as unfixable Safari behaviour with workaround noted."}, "status": "done", "parent": "gdn-cejaba", "order": 28, "created_at": "2026-02-10T08:49:12Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:52:32Z"}
{"id": "gdn-gabeda", "type": "action", "title": "Force refresh on mobile shows nothing when Tailscale tunnel is down", "brief": {"why": "When the DERP relay drops, the phone cannot reach kube at all — not just WS but HTTP too. Force refresh shows a blank page or spinner because the page itself cannot load. There is no offline fallback or service worker caching the app shell.", "what": "1. Add fetch handler to existing sw.js (public/sw.js) that caches the app shell (index.html + assets) — page loads even offline 2. App shows a clear offline/connecting state instead of blank 3. WS reconnect runs in background, UI updates when connection returns. NOTE: sw.js currently has skipWaiting() + clients.claim() which is safe for notification-only. When adding fetch caching, revisit — skipWaiting with a cache-breaking deploy could serve new cached assets to old running JS. Consider versioned cache names and only skipWaiting when cache schema is compatible.", "done": "Force refresh on mobile loads the app shell immediately even when kube is unreachable, shows a clear connecting state, and reconnects when Tailscale recovers"}, "status": "done", "parent": "gdn-situwu", "order": 22, "created_at": "2026-02-10T08:50:07Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T22:27:00Z", "updated_by": "edited", "done_at": "2026-02-23T23:53:00Z"}
{"id": "gdn-gaduku", "type": "action", "title": "StateBuilder handles AskUserQuestion tool calls", "brief": {"why": "AskUserQuestion is a special tool call — the old adapter detected it and fired onAskUser callback. The new StateBuilder treats it as a normal tool call. Questions show as raw JSON instead of tappable buttons.", "what": "1. Detect AskUserQuestion in StateBuilder (content_block_start name match) — suppress from tool deltas, emit new ask_user SSEDelta with parsed questions 2. Suppress the is_error tool_result that CC returns (don't emit tool_complete error) 3. Port bottom-sheet overlay from v1 ask-user-overlay.ts to vanilla JS — slide-up animation, backdrop blur, safe-area padding, 44px touch targets 4. Single-select tap sends immediately, multi-select toggles then confirms, 'type custom answer' dismiss 5. Wire answer back via POST /prompt as next user message\n\nPrior art: v1 had full implementation across src/ask-user-overlay.ts (~140 lines, Lit templates) and src/claude-code-agent.ts (~50 lines detection + suppression). Deleted in 3d47282 (v2 rewrite). Type defs (AskUserQuestionData, AskUserQuestionItem, AskUserOption), formatAnswer helper, stream-index suppression pattern, and error-result swallowing logic all reusable. UI design decisions (suppress tool card, suppress error result, bottom-sheet, single-select-sends-immediately) are proven from phone testing. Key difference: detection was in client-side Lit adapter, now goes in server-side StateBuilder.", "done": "AskUserQuestion renders as tappable buttons. User taps option, response delivered as tool_result, Claude continues."}, "status": "done", "parent": "gdn-paciju", "order": 10, "created_at": "2026-02-21T21:48:21Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-24T05:10:06Z", "updated_by": "stepped", "tactical": {"steps": ["Detect AskUserQuestion in StateBuilder (content_block_start name match) — suppress from tool deltas, emit new ask_user SSEDelta with parsed questions", "Suppress the is_error tool_result that CC returns (don't emit tool_complete error)", "Port bottom-sheet overlay from v1 ask-user-overlay.ts to vanilla JS — slide-up animation, backdrop blur, safe-area padding, 44px touch targets", "Single-select tap sends immediately, multi-select toggles then confirms, 'type custom answer' dismiss", "Wire answer back via POST /prompt as next user message Prior art: v1 had full implementation across src/ask-user-overlay.ts (~140 lines, Lit templates) and src/claude-code-agent.ts (~50 lines detection + suppression). Deleted in 3d47282 (v2 rewrite). Type defs (AskUserQuestionData, AskUserQuestionItem, AskUserOption), formatAnswer helper, stream-index suppression pattern, and error-result swallowing logic all reusable. UI design decisions (suppress tool card, suppress error result, bottom-sheet, single-select-sends-immediately) are proven from phone testing. Key difference: detection was in client-side Lit adapter, now goes in server-side StateBuilder."], "current": 5, "session": "/home/modha/Repos/gueridon"}, "done_at": "2026-02-24T05:10:06Z"}
{"id": "gdn-gebuni", "type": "outcome", "title": "Dev sandbox runs alongside production without interference", "brief": {"why": "Currently dev testing can disrupt the live session on the phone. Need isolated dev bridge + test hooks so Claude can iterate on UI without affecting the user's active session. RELATED: gdn-wifana (session cross-contamination) shares the state-directory concern — do these together. See also passe-nerisu (passe repo) for the Chrome-side of this.", "what": "1. Add PORT env var to bridge.ts (default 3001) — hardcoded in at least two places: the listen call and BRIDGE_URL logic. Check for others 2. Dev bridge needs its OWN state directory (not shared sessions.json) to avoid cross-contamination — same class of bug as gdn-wifana. Use GDN_STATE_DIR env var or --state-dir flag 3. Add window.__gdn test hooks namespace (simulateDisconnect, showToast, setContextGauge, triggerAskUser) — must be tree-shaken in production builds, only present when import.meta.env.DEV is true 4. Document dev sandbox setup in docs/", "done": "PORT=3002 GDN_STATE_DIR=/tmp/gdn-dev npm run bridge starts an isolated dev bridge; window.__gdn.showToast('test') fires a toaster in dev UI but __gdn is undefined in production build; production on :3001 is unaffected and state files are separate"}, "status": "done", "order": 22, "created_at": "2026-02-16T17:55:54Z", "created_by": "spm1001", "updated_at": "2026-02-16T18:07:35Z", "done_at": "2026-02-21T22:36:47Z"}
{"id": "gdn-geduzo", "type": "action", "title": "Lit component smoke tests for GueridonInterface", "brief": {"why": "Nothing tests that the UI actually renders. A future Claude could break prop passing to message-list or streaming-message-container and every test would pass green. jsdom is already installed but unused.", "what": "1. Set up Lit test helpers with jsdom environment in vitest 2. Test GueridonInterface: create element, feed a text CC event sequence, assert assistant-message element exists in DOM 3. Test connection status rendering (connected/disconnected) 4. Test error state rendering", "done": "At least one test creates GueridonInterface in jsdom and verifies rendered output after feeding CC events. Catches wiring bugs between adapter state and Lit templates."}, "status": "done", "parent": "gdn-cejaba", "order": 13, "created_at": "2026-02-09T10:15:18Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Set up Lit test helpers with jsdom environment in vitest", "Test GueridonInterface: create element, feed a text CC event sequence, assert assistant-message element exists in DOM", "Test connection status rendering (connected/disconnected)", "Test error state rendering"], "current": 4}, "done_at": "2026-02-09T10:39:19Z"}
{"id": "gdn-gijawi", "type": "action", "title": "Exiting a session has no clear path on mobile", "brief": {"why": "/exit may not work through the bridge, and there's no UI affordance for ending a session. On desktop you Ctrl-C or type /exit — neither exists on mobile. User has no way to intentionally end a conversation and start fresh.", "what": "1. Verify whether /exit works through bridge stdin 2. If not, add bridge-level session termination 3. Add UI affordance (button or gesture) for ending current session 4. Ensure ended session doesn't resume on next folder connect", "done": "/exit or equivalent cleanly ends session, next connect to same folder starts fresh, no ghost process left behind"}, "status": "done", "parent": "gdn-bujove", "order": 5, "created_at": "2026-02-16T08:09:03Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T21:47:06Z", "updated_by": "edited", "done_at": "2026-02-21T21:47:44Z"}
{"id": "gdn-gitaju", "type": "action", "title": "Wire command registry into bridge session", "brief": {"why": "The registry exists as pure functions but nothing uses it yet. The bridge needs to build the registry when it receives the init event from CC and store it on the session.", "what": "1. Add commandRegistry field to Session interface (initially null) 2. In wireProcessToSession stdout handler, detect system/init events and build registry on first init 3. Log classification counts for debugging 4. No behavioural change to existing flows", "done": "Bridge logs 'command registry built: X commands (Y local, Z skills, W builtin-api)' on session start"}, "status": "done", "parent": "gdn-dicire", "order": 2, "created_at": "2026-02-12T06:58:14Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-21T22:30:30Z"}
{"id": "gdn-gocuze", "type": "action", "title": "Pull-to-refresh shows empty content when scrolling up in resumed session", "brief": {"why": "After resuming a paused session (orange dot), scrolling up to earlier messages triggers a pull-to-refresh gesture and shows no content above. It resolves itself but is disorienting — suggests the message history isn't fully loaded or the scroll container doesn't know its bounds.", "what": "1. Check if messageBuffer replay populates the full scroll container or loads lazily 2. Check if the scroll container height is set correctly after replay 3. May need to pin scrollHeight after replay completes", "done": "Scrolling up in a resumed session shows full message history without empty gaps or pull-to-refresh artifacts"}, "status": "done", "parent": "gdn-situwu", "order": 6, "created_at": "2026-02-10T08:49:39Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T20:20:48Z"}
{"id": "gdn-goloki", "type": "action", "title": "Context gauge feeds back to Claude, not just the human", "brief": {"why": "Claude can't see how much context it's consuming. It reads large files without knowing the cost, can't make economical choices about what to inline vs deposit to file. The human sees the fuel gauge but Claude is flying blind.", "what": "1. Include context usage in a system-level signal Claude can see (e.g. append-system-prompt with current usage, or inject into tool results) 2. Design so it's ambient — not a separate tool call Claude has to make 3. Inject at threshold crossings (50%, 80%, 90%) with guidance to be economical, write to files, be concise 4. Track threshold crossings in adapter to avoid repeat injection", "done": "Claude receives ambient context pressure signals at thresholds. Makes economical choices about file reads and tool calls based on remaining capacity."}, "status": "done", "parent": "gdn-zewumo", "order": 3, "created_at": "2026-02-11T07:59:14Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T21:47:22Z", "updated_by": "edited", "done_at": "2026-02-23T20:54:50Z"}
{"id": "gdn-gomale", "type": "action", "title": "Multi-block messages repeat earlier text segments", "brief": {"why": "When CC sends text → tool_use → text within one message, currentText accumulates across all blocks. Each content delta replays all prior text, creating visible repetition on the phone (4x 'Good questions. Let me audit...' in screenshot).", "what": "1. Track currentText per block index (Map<number, string> instead of single string) 2. Emit content delta with only that block's text 3. Join all text blocks in handleAssistant for the committed message 4. Remove WebFetch dead code from extractToolInput while here", "done": "Multi-text-block message renders each text segment once. Screenshots IMG_1617/IMG_1618 scenario no longer repeats."}, "status": "done", "parent": "gdn-situwu", "order": 30, "created_at": "2026-02-23T21:54:13Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:48:12Z"}
{"id": "gdn-govuca", "type": "action", "title": "Bridge buffers output while phone is away, replays on reconnect", "brief": {"why": "Events emitted while no WS clients are connected are permanently lost. A 30-second WiFi dropout mid-response means a hole in the conversation. The session JSONL has the full record but there's no replay mechanism.", "what": "1. Ring buffer per session in bridge (last N events) 2. On WS reconnect, replay buffered events before live stream 3. Client requests catch-up with sequence numbers to avoid duplicates", "done": "Lock phone for 30s while Claude is streaming. Unlock. See the full response, no gaps."}, "status": "done", "parent": "gdn-hatiho", "order": 8, "created_at": "2026-02-09T21:05:18Z", "created_by": "spm1001", "waiting_for": "After minimum tier (susuna, murimo, weletu done). See docs/lifecycle-map.md medium tier.", "done_at": "2026-02-10T13:56:16Z"}
{"id": "gdn-gudube", "type": "action", "title": "Add command registry types and builder to bridge-logic.ts", "brief": {"why": "Need pure, testable foundation for classifying slash commands from CC init data. The init event gives us slash_commands (all) and skills (user only) — set difference reveals built-ins.", "what": "1. Add CommandCategory type (local/skill/builtin-api/bridge-only) 2. Add SlashCommandInfo and CommandRegistry types 3. Add LOCAL_BUILTINS set (context, cost) and BRIDGE_ONLY set (exit, quit) 4. Implement buildCommandRegistry() that classifies from two string arrays 5. Implement classify(text) method that extracts command name from prompt string 6. Write tests: classification logic, classify() with args/case/unknown, edge cases", "done": "buildCommandRegistry correctly classifies all command categories, classify() handles /command args format, comprehensive tests in bridge-logic.test.ts"}, "status": "done", "parent": "gdn-dicire", "order": 1, "created_at": "2026-02-12T06:58:07Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-21T22:30:30Z"}
{"id": "gdn-gukivo", "type": "action", "title": "Investigate image input via CC stdin content arrays", "brief": {"why": "ChatPanel lets users attach images but adapter strips them to text-only. CC stdin format uses string content — unknown whether content arrays with image blocks work.", "what": "1. Test CC stdin with content array containing image_url block (base64 data URI) 2. If CC accepts it, add image encoding in WSTransport.send() or agent.prompt() 3. Wire paperclip button to file picker → base64 → content array 4. Test round-trip: attach image, verify CC receives and responds to it", "done": "User can tap paperclip, select an image, and CC receives it as input. Response references image content."}, "status": "done", "parent": "gdn-paciju", "order": 4, "created_at": "2026-02-08T19:04:28Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T08:06:31Z"}
{"id": "gdn-guruno", "type": "action", "title": "AskUserQuestion mobile interception", "brief": {"why": "In -p mode, AskUserQuestion fires as a tool_use event with full question/options structure BEFORE the error result. Bridge should intercept this, render as tappable buttons on mobile, and send the user's answer as the next message.", "what": "1. Bridge detects tool_use with name AskUserQuestion 2. Forward question/options to browser as a special event 3. Render as tappable button UI (not in chat flow) 4. User tap sends answer as next prompt 5. Coach CC via --append-system-prompt that AskUserQuestion errors are expected", "done": "AskUserQuestion renders as tappable buttons on mobile, user's selection flows back as a message"}, "status": "done", "parent": "gdn-cejaba", "order": 10, "created_at": "2026-02-08T17:57:57Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Bridge detects tool_use with name AskUserQuestion", "Forward question/options to browser as a special event", "Render as tappable button UI (not in chat flow)", "User tap sends answer as next prompt", "Coach CC via --append-system-prompt that AskUserQuestion errors are expected"], "current": 5}, "done_at": "2026-02-08T19:24:07Z"}
{"id": "gdn-hamafi", "type": "action", "title": "Tool call expand/collapse chevron is too small on mobile", "brief": {"why": "The ▸ chevron on collapsed tool calls is 0.85rem (~13px) — visually too small to look tappable on a phone. The whole header row IS tappable, but the chevron is the only visual affordance and it reads as decorative, not interactive.", "what": "1. Increase .tool-chevron font-size (1.1rem+ or use a larger SVG icon) 2. Ensure the tap target is the full header row with min-height 44px (Apple HIG) 3. Consider making the whole row more obviously tappable (subtle highlight on active)", "done": "Chevron is visibly tappable. Tool call headers have 44px min touch target."}, "status": "done", "parent": "gdn-situwu", "order": 45, "created_at": "2026-02-23T22:43:14Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:47:51Z"}
{"id": "gdn-hanaje", "type": "action", "title": "Coalesce CC partials before forwarding to clients", "brief": {"why": "Bridge forwards every CC stdout line as a separate ws.send() at token rate. On mobile/cellular this causes: (a) text dribbling in word-by-word (teletype), (b) garbled bursts after network stalls, (c) no backpressure when client can't keep up. All three are the same root cause.", "what": "1. Add tick-based conflation in wireProcessToSession — hold latest partial per message, flush on 250ms timer. 2. Non-partial events (result, error, processExit) flush immediately. 3. Check ws.bufferedAmount before sending; skip partials for saturated clients. 4. Cap messageBuffer size (prevents unbounded memory on long sessions).", "done": "Text arrives in readable chunks (~4/sec) on both localhost and cellular. No garbled bursts after network stalls. messageBuffer has a size cap."}, "status": "done", "parent": "gdn-besuse", "order": 10, "created_at": "2026-02-10T21:42:47Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T00:14:58Z"}
{"id": "gdn-hatiho", "type": "outcome", "title": "Sessions feel natural on mobile — walk away and come back without losing work", "brief": {"why": "Mobile sessions currently have no identity (random UUIDs), no closure ritual, and no handoff. When a session dies the next Claude starts blind. Desktop rituals (/open, /close, arc, handoffs) need mobile equivalents so sessions survive the context boundary.", "what": "1. Bridge session registry + folder list endpoint 2. Folder chooser UI with search 3. Deterministic session IDs from folder path 4. Handoff/paused state display in chooser 5. Resume flow (paused → unfreeze, closed → fresh with handoff) 6. New folder creation with fun names 7. Mobile /close trigger 8. Closure nudge from fuel gauge", "done": "Tab resume is instant (visibilitychange). Page refresh preserves conversation. Medium tier: bridge buffers output while phone is away, idle timer doesn't kill working Claude, folder list shows Claude status. Ambitious: push notification when Claude finishes."}, "status": "done", "order": 3, "created_at": "2026-02-08T19:50:33Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T20:12:07Z"}
{"id": "gdn-hemute", "type": "action", "title": "Integration test for listFolders protocol", "brief": {"why": "The folder list API (listFolders/folderList) needs an integration test that verifies the WS protocol end-to-end. Currently test-bridge.ts covers prompt/abort but nothing folder-related.", "what": "1. Add listFolders test to scripts/test-bridge.ts (or new script) 2. Connect WS without ?session= (lobby mode) 3. Send listFolders, verify folderList response shape 4. Verify known folders appear with correct states 5. Send connectFolder, verify connected response with sessionId", "done": "Test script passes: connects, lists folders, gets enriched list back, connects to a folder. Can run against live bridge."}, "status": "done", "parent": "gdn-zovogo", "order": 5, "created_at": "2026-02-09T06:22:37Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-09T07:20:15Z"}
{"id": "gdn-hikosa", "type": "action", "title": "Folder list is a dashboard showing what each Claude is doing", "brief": {"why": "Folder picker is currently just a chooser — tap and dismiss. But with multiple sessions, you need to see which Claudes need attention. The bridge already knows whether CC is running; surfacing it turns the picker into a status screen.", "what": "1. Bridge tracks per-session state: not-started, working, finished-waiting, idle 2. Extend folderList message with session activity status 3. Folder selector shows status badges: working, needs input, idle 4. User opens folder list to check on things, not just to switch", "done": "Open folder list, see 'working' on one folder and 'finished — waiting for you' on another. Status updates live while dialog is open."}, "status": "done", "parent": "gdn-bujove", "order": 1, "created_at": "2026-02-09T21:05:35Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T00:14:58Z"}
{"id": "gdn-hocezu", "type": "action", "title": "Sort slash commands alphabetically, local first, add /exit", "brief": {"why": "Slash menu is unsorted and missing /exit — hard to scan on mobile", "what": "1. Sort commands alphabetically 2. Group local commands (exit, compact, context, cost) above CC commands 3. Add /exit to the local command list", "done": "Slash menu shows local commands first in alpha order, then CC commands in alpha order, /exit present and functional"}, "status": "done", "parent": "gdn-situwu", "order": 57, "created_at": "2026-02-24T06:03:40Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-24T06:04:14Z"}
{"id": "gdn-hoduji", "type": "outcome", "title": "UX testing harness for phone-driven iteration", "brief": {"why": "Need to iterate on mobile UI with agent driving changes and user viewing on phone. Mock bridge + Vite HMR + screenshot pipeline enables this.", "what": "Already built: mock bridge on :3001 (scripts/mock-bridge.ts), Vite dev on :5173 with --host, Taildrive share for screenshots. Phone connects to kube:5173, saves screenshots to ~/Repos/scratch/ via Taildrive.", "done": "Agent can edit UI, user sees changes on phone in seconds, screenshots flow back for agent to look_at. Done."}, "status": "done", "order": 20, "created_at": "2026-02-15T19:31:03Z", "created_by": "spm1001", "done_at": "2026-02-15T19:31:08Z"}
{"id": "gdn-hugoso", "type": "action", "title": "Clearer working indicator when Claude is processing", "brief": {"why": "Coming back to the app, no visual signal that Claude is mid-turn. Red stop button exists but is subtle.", "what": "1. Add shimmer/pulse animation to input bar or status area during streaming 2. Consider pulsing dot or spinner near folder name", "done": "Glancing at the app instantly tells you whether Claude is working"}, "status": "done", "parent": "gdn-situwu", "order": 12, "created_at": "2026-02-15T19:30:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T19:46:10Z"}
{"id": "gdn-hurodo", "type": "action", "title": "Context compaction toaster still appearing", "brief": {"why": "User thought context toaster was eliminated but it still popped up. Either the suppression was incomplete or theres a code path that still triggers it.", "what": "1. Grep for compaction/toaster/context-compact in codebase 2. Find all trigger paths 3. Suppress or remove entirely", "done": "No context toaster appears during normal use"}, "status": "done", "parent": "gdn-besuse", "order": 17, "created_at": "2026-02-16T07:06:36Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-16T19:33:14Z"}
{"id": "gdn-hurume", "type": "action", "title": "Grace timer kills CC process while user is actively connected", "brief": {"why": "iOS drops SSE EventSource during screen lock or app switch. Bridge sees 0 clients, starts 5-min grace timer, SIGTERMs the CC process. Session resumes but context is lost and work repeats. This happened 6 times in one session.", "what": "1. Track lastPromptAt on session — grace timer should not fire if a prompt arrived recently (e.g. within 10min) 2. Promote grace/SSE events to info log level (done this session) 3. Consider longer grace for sessions with active push subscriptions — phone is nearby even if SSE dropped", "done": "CC process survives iOS screen lock. Grace timer only fires after genuine abandonment (no prompts for 10+ min AND no SSE clients)."}, "status": "done", "parent": "gdn-situwu", "order": 54, "created_at": "2026-02-24T05:58:52Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Track lastPromptAt on session — grace timer should not fire if a prompt arrived recently (e.g. within 10min)", "Promote grace/SSE events to info log level (done this session)", "Consider longer grace for sessions with active push subscriptions — phone is nearby even if SSE dropped"], "current": 3, "session": "/home/modha/Repos/gueridon", "skipped": {"1": "Already done in previous session", "2": "lastPromptAt guard covers this — push-aware grace is belt-and-suspenders, revisit if kills still occur"}}, "updated_at": "2026-02-24T06:48:04Z", "updated_by": "stepped", "done_at": "2026-02-24T06:48:04Z"}
{"id": "gdn-jahaku", "type": "action", "title": "HTTPS via Tailscale cert for Push API", "brief": {"why": "Push API requires a secure context (HTTPS). Guéridon runs on http://kube:3001 over Tailscale. tailscale cert kube.atlas-cloud.ts.net gives a real LE cert. Bridge needs to serve HTTPS or sit behind a reverse proxy.", "what": "1. Generate cert: tailscale cert kube.atlas-cloud.ts.net 2. Option A: bridge.ts listens on 443 with TLS (node https.createServer) 3. Option B: Caddy/nginx reverse proxy with the cert 4. Update systemd unit if port changes 5. Verify SW registration and push subscription work over HTTPS 6. Update BRIDGE_URL logic in frontend for wss:// 7. Auto-renew cert (tailscale cert auto-renews, but need restart hook)", "done": "Browser shows 🔒 on https://kube.atlas-cloud.ts.net. WebSocket upgrades to wss://. Push subscription succeeds."}, "status": "done", "parent": "gdn-jetune", "order": 3, "created_at": "2026-02-15T21:41:41Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Generate cert: tailscale cert kube.atlas-cloud.ts.net", "Option A: bridge.ts listens on 443 with TLS (node https.createServer)", "Option B: Caddy/nginx reverse proxy with the cert", "Update systemd unit if port changes", "Verify SW registration and push subscription work over HTTPS", "Update BRIDGE_URL logic in frontend for wss://", "Auto-renew cert (tailscale cert auto-renews, but need restart hook)"], "current": 7, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-15T22:10:50Z", "done_at": "2026-02-15T22:10:50Z"}
{"id": "gdn-jalose", "type": "action", "title": "App icon: Garamond asterisk on Anthropic coral", "brief": {"why": "iOS home screen icon still shows 'BB' from brisk-bear. Needs a Guéridon identity.", "what": "1. Create SVG icon: black Garamond asterisk on #E8734A (Anthropic coral) rounded-rect, asterisk scaled to just touch edges 2. Export as icon-192.svg and icon-512.svg (or PNG at both sizes) 3. Update manifest.json icon references 4. Remove old BB icon files", "done": "Adding to home screen on iOS shows coral lozenge with black asterisk. No BB reference anywhere."}, "status": "done", "parent": "gdn-situwu", "order": 32, "created_at": "2026-02-23T22:20:53Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Create SVG icon: black Garamond asterisk on #E8734A (Anthropic coral) rounded-rect, asterisk scaled to just touch edges", "Export as icon-192.svg and icon-512.svg (or PNG at both sizes)", "Update manifest.json icon references", "Remove old BB icon files"], "current": 4, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-24T05:51:29Z", "updated_by": "stepped", "done_at": "2026-02-24T05:51:29Z"}
{"id": "gdn-jamida", "type": "action", "title": "File upload deposits to disk, CC gets paths not base64", "brief": {"why": "Phone users need to share screenshots, photos, documents — any file. Old v1 encoded base64 into stdin content arrays, burning context tokens. Files should deposit to disk; CC gets paths and reads what it needs.", "what": "1. Add POST /upload/:folder endpoint — accepts multipart file, saves to ~/.config/gueridon/uploads/{sessionId}/{original-name} 2. Bridge sends file paths as user message text (e.g. 'User uploaded: /path/to/file.png, /path/to/doc.pdf') so CC can Read them on demand 3. Frontend: attach button (paperclip or +) opens file picker, uploads via fetch, shows thumbnail/filename in chat 4. Drag-and-drop support on the message area (desktop browser use case) 5. Resize images client-side before upload (reuse existing image-utils if any survived v2) 6. Cleanup: delete session uploads on session close, sweep >24h on startup 7. Support multiple files in one upload (both picker and drag-and-drop)", "done": "Can attach any file from phone. File lands on disk. CC gets path in message text. CC reads file successfully. No base64 in context. Cleanup on session close."}, "status": "done", "order": 8, "created_at": "2026-02-16T18:48:44Z", "created_by": "spm1001", "parent": "gdn-paciju", "waiting_for": null, "updated_at": "2026-02-23T22:48:28Z", "updated_by": "edited", "done_at": "2026-02-24T05:13:15Z"}
{"id": "gdn-jebudo", "type": "outcome", "title": "Folder dialog flash — find and fix root cause", "brief": {"why": "Dialog flashes open then immediately closes on page load. onSessionId fires right after onFolderList, closing the dialog before user can interact. Guarded with pendingFolderConnect flag (symptom suppressed) but root cause unknown. console.trace debug instrumentation still in folder-selector.ts.", "what": "1. Add instrumentation logging to trace exact sequence: WS open → lobbyConnected → folderList → connectFolder → connected → onSessionId 2. Reproduce the flash by opening the app fresh 3. Identify which event fires the spurious dialog close 4. Fix root cause (likely: remove the guard, fix the event ordering) 5. Remove console.trace debug instrumentation from folder-selector.ts", "done": "Opening the app shows folder dialog and it stays open until user selects. No flash. console.trace removed."}, "status": "done", "order": 7, "created_at": "2026-02-09T15:00:04Z", "created_by": "spm1001", "done_at": "2026-02-09T16:49:21Z"}
{"id": "gdn-jegosi", "type": "action", "title": "Folder lifecycle in main.ts is an explicit state machine, not callback soup", "brief": {"why": "main.ts folder switching uses shared mutable flags (pendingFolderConnect, deferredFolderPath) across multiple callbacks. The deferred connect pattern — detect mid-session, returnToLobby, wait for lobby callback, connect folder — is a three-step dance across two callbacks. This is where the dialog flash bug lives and where the returnToLobby WS race lived. Both were fixed with guards but the shape invites the next bug.", "what": "1. Define folder lifecycle states (idle, selecting, switching, connecting, connected) as a union type 2. Extract folder state machine from main.ts — transitions replace the pendingFolderConnect/deferredFolderPath flags 3. Each transition has a single handler — no split logic across onSessionId/onLobbyConnected/onFolderList callbacks 4. Unit test the state machine: transitions, guards, edge cases (double-click, rapid switch)", "done": "main.ts folder lifecycle uses typed states and transitions. pendingFolderConnect and deferredFolderPath flags are gone. State machine has unit tests."}, "status": "done", "parent": "gdn-hatiho", "order": 7, "created_at": "2026-02-09T16:04:03Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Write folder-lifecycle.ts — types + initial() + transition()", "Write folder-lifecycle.test.ts — pure function tests for all transitions", "Rewrite main.ts to use dispatch/executeEffect pattern", "Remove console.trace from folder-selector.ts (line 53)", "Run full test suite + build, verify jebudo flash is structurally prevented"], "current": 5}, "done_at": "2026-02-09T16:49:10Z"}
{"id": "gdn-jelotu", "type": "action", "title": "Input box disappears behind iOS keyboard in web app mode", "brief": {"why": "Input bar uses position:fixed bottom:0. interactive-widget=resizes-content is Chrome-only — Safari ignores it. No visualViewport API usage. Keyboard pushes input behind itself.", "what": "1. Add visualViewport resize listener 2. Offset input bar above keyboard via transform or bottom adjustment 3. Test in iOS Safari standalone/PWA mode", "done": "Tap input on iOS — keyboard opens, input stays visible above it"}, "status": "done", "parent": "gdn-situwu", "order": 19, "created_at": "2026-02-16T07:06:22Z", "created_by": "spm1001", "waiting_for": "Step 3 is manual iOS device testing — needs phone. Park until next mobile session.", "updated_at": "2026-02-21T21:47:06Z", "updated_by": "edited", "done_at": "2026-02-24T05:13:15Z"}
{"id": "gdn-jetune", "type": "outcome", "title": "User knows when Claude finishes without staring at the screen", "brief": {"why": "The #1 remaining lifecycle gap. User sends a prompt, switches away, has no signal when Claude finishes or needs input. Must work from phone-in-pocket to desktop-tab.", "what": "1. Page title + favicon badge (desktop tabs, zero infra) 2. Service worker + manifest + Notification API (iOS standalone unlock, both triggers: turn-complete and AskUserQuestion) 3. HTTPS via Tailscale cert (prerequisite for Push API) 4. Push API with VAPID, sound, vibration (phone in pocket — bridge pushes when no clients connected)", "done": "Lock phone, put it down, Claude finishes work — phone buzzes. Pick it up, tap notification, land in the right session."}, "status": "done", "order": 21, "created_at": "2026-02-15T21:41:15Z", "created_by": "spm1001", "done_at": "2026-02-21T22:27:15Z"}
{"id": "gdn-jijina", "type": "action", "title": "Add error handling to lobby message queue", "brief": {"why": "lobbyQueue chains .then() with no .catch(). If handleLobbyMessage rejects, every subsequent lobby message for that connection silently never executes. The session handler at line 708 has .catch() but the lobby doesn't.", "what": "Add .catch() to lobbyQueue chain matching session handler pattern.", "done": "lobbyQueue has error handling. A failing lobby message doesn't kill the connection."}, "status": "done", "parent": "gdn-besuse", "order": 11, "created_at": "2026-02-10T21:42:48Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:32:24Z"}
{"id": "gdn-jimozo", "type": "action", "title": "End-to-end adapter sequence test", "brief": {"why": "Individual event handlers are tested but the full composition isn't. A prompt→stream→tool_use→tool_result→text_response→result sequence through handleCCEvent would catch ordering bugs and state leaks between phases.", "what": "1. Create a test that feeds a complete multi-turn CC event sequence 2. Assert intermediate state at each phase (isStreaming, pendingToolCalls, messages array) 3. Cover: text-only turn, tool-use turn, AskUserQuestion turn", "done": "At least one full-sequence test exercises the adapter from prompt to result, verifying state at each transition."}, "status": "done", "parent": "gdn-vevoca", "order": 8, "created_at": "2026-02-09T09:44:52Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Create a test that feeds a complete multi-turn CC event sequence", "Assert intermediate state at each phase (isStreaming, pendingToolCalls, messages array)", "Cover: text-only turn, tool-use turn, AskUserQuestion turn"], "current": 3}, "done_at": "2026-02-09T09:55:18Z"}
{"id": "gdn-jiwize", "type": "action", "title": "Build bridge server", "brief": {"why": "The bridge server is what makes the adapter functional — it spawns and manages claude -p processes, pipes stdin/stdout as JSONL, and exposes a WebSocket endpoint for the browser.", "what": "1. Node.js WebSocket server (ws package) 2. Process-per-session: spawn claude -p with required flags on WS connect 3. Pipe WS messages to CC stdin as stream-json input format 4. Parse CC stdout JSONL and forward events over WS 5. Session management: idle timeout, kill, --resume on reconnect 6. Handle process lifecycle (exit, crash, restart)", "done": "Bridge server runs, browser can connect via WS, typing in ChatPanel sends to CC and streamed response renders in the UI"}, "status": "done", "parent": "gdn-cejaba", "order": 7, "created_at": "2026-02-08T17:54:50Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Node.js WebSocket server (ws package)", "Process-per-session: spawn claude -p with required flags on WS connect", "Pipe WS messages to CC stdin as stream-json input format", "Parse CC stdout JSONL and forward events over WS", "Session management: idle timeout, kill, --resume on reconnect", "Handle process lifecycle (exit, crash, restart)"], "current": 6}, "done_at": "2026-02-08T18:17:48Z"}
{"id": "gdn-jogoja", "type": "action", "title": "Service worker + manifest + Notification API", "brief": {"why": "iOS standalone mode requires a registered service worker and a manifest with display:standalone for the Notification API to work. This is the unlock for all notification features on mobile. Both turn-complete and AskUserQuestion triggers.", "what": "1. Create minimal manifest.json (name, start_url, display:standalone, icons) 2. Create sw.js with push + notificationclick handlers 3. Register SW from main.ts 4. On agent_end (turn complete): show notification 'Claude finished in {folder}' 5. On AskUserQuestion: show notification 'Claude needs your input in {folder}' 6. notificationclick focuses existing tab or opens app 7. Request notification permission on first prompt (user gesture)", "done": "Add to Home Screen on iOS. Send prompt, switch to another app. Banner appears when Claude finishes. Tap banner, land back in Guéridon in the right session."}, "status": "done", "parent": "gdn-jetune", "order": 2, "created_at": "2026-02-15T21:41:32Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Create minimal manifest.json (name, start_url, display:standalone, icons)", "Create sw.js with push + notificationclick handlers", "Register SW from main.ts", "On agent_end (turn complete): show notification 'Claude finished in {folder}'", "On AskUserQuestion: show notification 'Claude needs your input in {folder}'", "notificationclick focuses existing tab or opens app", "Request notification permission on first prompt (user gesture)"], "current": 7, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-15T21:48:53Z", "done_at": "2026-02-15T21:48:53Z"}
{"id": "gdn-jomahi", "type": "action", "title": "Integration test for message queueing in test-bridge.ts", "brief": {"why": "Queue logic (accept mid-turn, flush on result, discard on exit) has no integration test. Unit tests cover pure functions but the wiring through wireProcessToSession and handleSessionMessage is only tested by running the bridge.", "what": "1. Add test: send prompt, send second prompt mid-turn, verify promptQueued ack 2. Add test: first turn completes, queued prompt auto-delivers, verify promptReceived 3. Add test: abort mid-turn with queued prompts, verify queue cleared", "done": "test-bridge.ts has 3 queueing tests that pass against running bridge"}, "status": "done", "parent": "gdn-puzoni", "order": 6, "created_at": "2026-02-15T21:33:05Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T21:47:01Z", "updated_by": "edited", "done_at": "2026-02-21T22:56:11Z"}
{"id": "gdn-jopavo", "type": "action", "title": "Visual e2e test: send message, refresh page, verify messages reappear", "brief": {"why": "Unit tests prove the replay machinery works but we haven't verified the full send→refresh→replay path end-to-end. The replay path is the kind of thing that breaks silently.", "what": "1. Use test-bridge.ts or webctl: connect to folder, send message, wait for response 2. Refresh page (webctl navigate) 3. Verify conversation messages reappear without opening folder picker", "done": "Automated test in scripts/test-bridge.ts passes: refresh preserves conversation"}, "status": "done", "parent": "gdn-hatiho", "order": 10, "created_at": "2026-02-09T23:23:03Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Use test-bridge.ts or webctl: connect to folder, send message, wait for response", "Refresh page (webctl navigate)", "Verify conversation messages reappear without opening folder picker"], "current": 3}, "done_at": "2026-02-09T23:35:55Z"}
{"id": "gdn-judonu", "type": "action", "title": "Export adapter pure helpers to eliminate as-any test casts", "brief": {"why": "49 adapter tests access mapContentBlocks/mapUsage/mapStopReason via (agent as any). TypeScript can't see through the cast — rename a method and tests break at runtime with 'undefined is not a function' instead of a compile error.", "what": "1. Extract mapContentBlocks, mapUsage, mapStopReason, emptyUsage as exported pure functions (not class methods) 2. Update ClaudeCodeAgent to call the exported functions 3. Update 49 tests to import functions directly instead of (agent as any).methodName 4. Verify all tests pass with no as-any casts on these helpers", "done": "Zero as-any casts for adapter helper access in test files. Renaming a helper function causes a compile error, not a runtime mystery."}, "status": "done", "parent": "gdn-paciju", "order": 2, "created_at": "2026-02-09T10:15:08Z", "created_by": "spm1001", "waiting_for": "Deferred: Developer hygiene, no user impact. Revisit when doing adapter work.", "done_at": "2026-02-12T00:14:58Z"}
{"id": "gdn-kacona", "type": "action", "title": "Define typed event discriminated union in server/events.ts", "brief": {"why": "Type safety on every emit call — compile-time guarantees that event payloads are correct. Decouples event shape from consumers.", "what": "New file server/events.ts with a discriminated union covering all lifecycle events: session:spawn, session:exit, session:resolve, turn:start, turn:complete, sse:connect, sse:disconnect, grace:start, grace:expire, prompt:deliver, prompt:queue, init:timeout, process:kill, push:send, push:fail, client:error, request:rejected, log (generic). Each variant has typed payload fields (sessionId, folder, pid, duration, tokens, etc).", "done": "server/events.ts exports BridgeEvent union type. Each variant is narrowable via type field. No runtime deps."}, "status": "done", "parent": "gdn-wecimo", "order": 1, "created_at": "2026-02-22T17:06:12Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Audit bridge.ts, push.ts, folders.ts for all console.log/error/warn sites and catalog the data each carries", "Define the BridgeEvent discriminated union with all event type variants", "Verify types compile cleanly"], "current": 3, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-22T19:25:09Z", "updated_by": "stepped", "done_at": "2026-02-22T19:25:09Z"}
{"id": "gdn-kaloci", "type": "action", "title": "Queued message text is unreadable", "brief": {"why": "Queued messages apply opacity: 0.6 on top of an already-dim accent background. On the dark theme, the 'queued' label and message text are nearly invisible — you can't tell what you sent. Note: gdn-lijoli (coral colour switch) will change the accent-dim value, which may partially address this — but the opacity stacking is the core issue regardless of colour.", "what": "1. Increase contrast on queued message text — either raise opacity or use a brighter text colour 2. Ensure the 'queued' label is legible against the message background 3. Test pending state too (opacity: 0.5, even worse)", "done": "Queued and pending message text is easily readable on the dark theme without straining."}, "status": "open", "parent": "gdn-situwu", "order": 61, "created_at": "2026-02-24T06:09:58Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-24T06:24:01Z", "updated_by": "edited"}
{"id": "gdn-keseho", "type": "action", "title": "Font sizes match for folder name and context percentage", "brief": {"why": "Folder name and context % in input bar are different sizes — looks unpolished", "what": "1. Find the size mismatch in gueridon-interface.ts input bar template 2. Unify to same text-xs or text-sm", "done": "Folder label and context percentage are visually balanced in the input bar"}, "status": "done", "parent": "gdn-situwu", "order": 10, "created_at": "2026-02-15T19:30:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T19:46:10Z"}
{"id": "gdn-kifuba", "type": "action", "title": "Claude knows when bridge restart completes and resumes work", "brief": {"why": "When the bridge restarts (deploy, manual systemctl restart, crash), CC processes get orphan-reaped. The client reconnects and CC resumes via --resume, but Claude has no awareness that a restart happened. If Claude itself requested the restart (e.g. to activate server-side changes), it can't confirm success or pick up where it left off. The user has to manually re-orient.", "what": "1. Track which sessions were interrupted during orphan reaping on startup 2. When a client reconnects to a reaped session and CC resumes, inject context telling Claude a restart occurred and what it was doing before 3. Consider: prepend to first post-resume prompt, or use --append-system-prompt, or a synthetic system message via SSE", "done": "After bridge restart, Claude's first response acknowledges the restart happened, confirms the server-side changes are active, and resumes previous work without manual re-orientation from the user."}, "status": "open", "parent": "gdn-situwu", "order": 63, "created_at": "2026-02-24T06:13:38Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-kijoni", "type": "outcome", "title": "Plan mode surfaces in Guéridon UI", "brief": {"why": "We discovered CC emits plan mode events (EnterPlanMode/ExitPlanMode) in stream-json. Guéridon currently renders these as raw JSON blobs — visible but unusable on mobile. This is part of a broader class: several CC tool calls (ExitPlanMode, EnterPlanMode, AskUserQuestion, possibly TodoWrite) produce structured output that the client shows as collapsed JSON rather than rich UI. A systematic approach to tool output rendering would solve plan mode and future tools in one go.", "what": "1. Capture CC plan mode events empirically (what JSONL does EnterPlanMode/ExitPlanMode produce?) 2. Identify the broader class of tool calls whose output is rendered as raw JSON in Guéridon — ExitPlanMode, EnterPlanMode, AskUserQuestion all have this problem. Enumerate which tools produce structured output that needs custom rendering 3. Design a general tool-output renderer registry (not one-off components per tool) 4. Design plan mode UI treatment — how should the plan file content be displayed, and how does the user approve/reject from mobile? 5. Implement plan mode state tracking in the adapter 6. Build UI components for plan display and approval interaction 7. Handle the read-only constraint (plan mode restricts CC to read-only tools)", "done": "User can trigger a plan-worthy prompt from Guéridon, see the plan rendered in the UI, and tap to approve or reject — full round-trip works from mobile"}, "status": "done", "order": 16, "created_at": "2026-02-12T06:57:46Z", "created_by": "spm1001", "done_at": "2026-02-21T22:26:50Z"}
{"id": "gdn-kikowe", "type": "action", "title": "Remote webctl — CC on Kube controls Mac's Chrome", "brief": {"why": "webctl + chrome-log is a powerful workflow for browsing as the authenticated user. Currently requires CC and Chrome on the same machine. Tailscale serve can bridge the gap.", "what": "1. Update webctl config on Kube: cdp_endpoint → sameers-macbook-air Tailscale hostname 2. Test webctl navigate + snapshot from Kube to Mac's Chrome 3. Test chrome-log capture from remote CDP 4. Document any latency or reliability issues", "done": "From a Gueridon session on Kube, webctl navigate/snapshot/click works against Chrome running on Mac. chrome-log captures traffic."}, "status": "open", "parent": "gdn-musimu", "order": 3, "created_at": "2026-02-11T07:50:05Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-kodelu", "type": "action", "title": "Wire vendor drift detection into update-all.sh", "brief": {"why": "No mechanism exists to detect when our 6 vendored pi-web-ui files change upstream. update-all.sh runs daily in HEAVY tier — perfect place for a git diff check.", "what": "1. Create src/vendor/.provenance.json with commit hash and file mapping 2. Add note to src/vendor/README.md pointing to provenance file 3. Add HEAVY section 7 to update-all.sh: fetch upstream, diff 6 files, append to news 4. Test with simulated drift (old commit) then verify clean run", "done": "update-all.sh detects drift when gitCommit is set to an old commit, reports it in ~/.claude/.update-news, and logs clean when no drift exists"}, "status": "done", "parent": "gdn-zigepu", "order": 1, "created_at": "2026-02-09T20:10:25Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Create src/vendor/.provenance.json with commit hash and file mapping", "Add note to src/vendor/README.md pointing to provenance file", "Add HEAVY section 7 to update-all.sh: fetch upstream, diff 6 files, append to news", "Test with simulated drift (old commit) then verify clean run"], "current": 4}, "done_at": "2026-02-09T20:12:19Z"}
{"id": "gdn-kokugu", "type": "action", "title": "Wire event bus into bridge.ts — emit lifecycle events, remove console.log calls", "brief": {"why": "bridge.ts has ~30 console.log/error calls with interpolated strings. Replacing them with typed emit() calls cleans up business logic and feeds all subscribers.", "what": "Import emit from event-bus.ts. Replace every console.log/error/warn in bridge.ts with an emit() of the appropriate typed event. Remove string formatting from business logic — structured fields only. Initialize logger and buffer subscribers at server startup.", "done": "Zero console.log/error/warn calls remain in bridge.ts. Every former log site emits a typed BridgeEvent. Subscribers initialized in server startup path."}, "status": "done", "parent": "gdn-wecimo", "order": 5, "created_at": "2026-02-22T17:27:47Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add import for emit and initLogger/initStatusBuffer at top of bridge.ts", "Replace all ~30 console.log/error/warn calls with typed emit() calls", "Add subscriber initialization in server startup section"], "current": 3, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-22T21:21:50Z", "updated_by": "stepped", "done_at": "2026-02-22T21:21:50Z"}
{"id": "gdn-kopiki", "type": "action", "title": "pi-web-ui element dependency tree is mapped and all needed elements registered", "brief": {"why": "MessageList renders <user-message>, <assistant-message> etc. as custom elements. Each may render further elements (e.g. <markdown-block>). If ANY element in the chain isn't imported/registered, content is invisible. Currently playing whack-a-mole with missing registrations.", "what": "1. Grep all @customElement and customElements.define in pi-mono/packages/web-ui/src 2. Build dependency tree: which elements create which other elements in their render() 3. Import all needed elements in gueridon-interface.ts (or a dedicated registrations file) 4. Verify with browser DevTools that all elements upgrade", "done": "Send a message in browser, user bubble appears with text, assistant response streams and renders"}, "status": "done", "parent": "gdn-cejaba", "order": 15, "created_at": "2026-02-09T13:35:29Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Grep all @customElement and customElements.define in pi-mono/packages/web-ui/src", "Build dependency tree: which elements create which other elements in their render()", "Import all needed elements in gueridon-interface.ts (or a dedicated registrations file)", "Verify with browser DevTools that all elements upgrade"], "current": 4}, "done_at": "2026-02-09T14:42:23Z"}
{"id": "gdn-kufobe", "type": "action", "title": "Extend StateBuilder: todos, richer tool input, per-block text tracking", "brief": {"why": "StateBuilder drops CC todo events and has basic extractToolInput coverage. Also currentText accumulates across all text blocks per message — correct for single-block but means earlier content deltas are subsets of later ones in multi-block messages.", "what": "1. Handle CC todo events → populate BBState.todos array 2. Add Skill, NotebookEdit, MCP tool names to extractToolInput 3. Track currentText per block index (emit independent content deltas per text block)", "done": "Todos render in UI. extractToolInput covers top-20 CC tools. Multi-text-block messages produce independent content deltas."}, "status": "done", "parent": "gdn-paciju", "order": 9, "created_at": "2026-02-21T21:48:12Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:01:12Z"}
{"id": "gdn-kugeto", "type": "action", "title": "Bridge uses --allowed-tools whitelist instead of --dangerously-skip-permissions", "brief": {"why": "Bridge currently uses --dangerously-skip-permissions which bypasses all safety. --allowed-tools is additive auto-approve — CC still has all tools but approved ones don't prompt. Safer posture, same UX.", "what": "1. Map which tools Guéridon sessions actually need auto-approved (Bash, Read, Write, Edit, Glob, Grep, WebFetch, Task) 2. Replace --dangerously-skip-permissions with --allowed-tools list in buildCCArgs 3. Test that approved tools run without prompt 4. Test that unapproved tools still work (just prompt)", "done": "Bridge spawns CC with --allowed-tools whitelist. No --dangerously-skip-permissions. All current functionality works."}, "status": "done", "parent": "gdn-zewumo", "order": 7, "created_at": "2026-02-12T19:36:11Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-16T19:16:17Z"}
{"id": "gdn-kurato", "type": "action", "title": "State derivation unit test — closed wins over paused", "brief": {"why": "The closed-wins-over-paused logic and resume guard are regression-prone. Someone reading the code might think 'paused should win' without understanding session files persist forever. The resume bug (resuming closed sessions) was found by the user in live use.", "what": "1. Mock fs for folders with: both session+handoff (closed), session only (paused), handoff only (closed), neither (fresh) 2. Assert state derivation correctness 3. Test connectFolder: closed folder gets fresh UUID, paused folder reuses session ID", "done": "Tests cover all state derivation paths and the resume guard. Regression on closed-wins-over-paused would fail a test."}, "status": "done", "parent": "gdn-vevoca", "order": 6, "created_at": "2026-02-09T08:03:34Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-09T09:43:56Z"}
{"id": "gdn-lafetu", "type": "action", "title": "Test whether --allowed-tools propagates to Task subagents", "brief": {"why": "If --allowed-tools only applies to the parent CC process and not Task subagents, a subagent could route around denied tools. Risk identified during --allowed-tools investigation in wt-sleuthing session 6fe4b50f.", "what": "1. Spawn CC with --allowed-tools Bash only 2. Ask CC to use Task tool to run a Bash command 3. Check if subagent auto-approves or prompts 4. Document propagation behaviour in empirical-verification.md", "done": "Propagation behaviour documented. If it doesn't propagate, noted as risk in decisions.md."}, "status": "done", "parent": "gdn-zewumo", "order": 8, "created_at": "2026-02-12T19:36:19Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Spawn CC with --allowed-tools Bash only", "Ask CC to use Task tool to run a Bash command", "Check if subagent auto-approves or prompts", "Document propagation behaviour in empirical-verification.md"], "current": 4, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-23T21:01:30Z", "updated_by": "stepped", "done_at": "2026-02-23T21:01:30Z"}
{"id": "gdn-lafobe", "type": "action", "title": "Add POST /client-error endpoint for mobile error reporting", "brief": {"why": "On mobile there are no devtools. Client errors vanish. Service worker failures are invisible. A reporting endpoint captures what's actually breaking.", "what": "Add POST /client-error route to bridge.ts. Accepts JSON body {message, stack, userAgent, url}. Emits a client:error typed event. Rate-limit to prevent floods (max 10 per minute per SSE client).", "done": "POST /client-error accepts error reports, emits typed events, appears in logs and /status buffer. Rate-limited."}, "status": "done", "parent": "gdn-wecimo", "order": 10, "created_at": "2026-02-22T17:28:20Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add POST /client-error route to bridge.ts with rate limiting"], "current": 1, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-23T06:52:32Z", "updated_by": "stepped", "done_at": "2026-02-23T06:52:32Z"}
{"id": "gdn-lalepa", "type": "action", "title": "Context injection to Claude at usage thresholds", "brief": {"why": "Claude can't see context pressure. At 50/80/90% it should get a gentle system-level hint to be economical.", "what": "1. Track threshold crossings in adapter 2. Inject via --append-system-prompt or similar at 50%, 80%, 90% 3. Message content guides Claude to write to files, be concise", "done": "Claude receives ambient context pressure signals at thresholds without the user asking"}, "status": "done", "parent": "gdn-zewumo", "order": 10, "created_at": "2026-02-15T19:30:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-21T21:47:25Z"}
{"id": "gdn-laneve", "type": "action", "title": "Verify double-render fix visually", "brief": {"why": "Patched AgentInterface to clear streaming container on message_end (not just agent_end) to fix duplicate message display. Committed but never tested live.", "what": "1. Start bridge + dev server 2. Send a multi-turn conversation 3. Watch for duplicate messages during turn transitions 4. Verify streaming container clears when message completes", "done": "No visible duplicate messages during streaming→complete transition across 3+ turns."}, "status": "done", "parent": "gdn-cejaba", "order": 12, "created_at": "2026-02-08T22:19:14Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Start bridge + dev server", "Send a multi-turn conversation", "Watch for duplicate messages during turn transitions", "Verify streaming container clears when message completes"], "current": 4}, "done_at": "2026-02-08T22:45:12Z"}
{"id": "gdn-lefoze", "type": "outcome", "title": "Guéridon is ready for other people to use", "brief": {"why": "The app works for us but isn't shippable: YOLO permissions, no docs, rough UI edges. Need to close the gap between 'works for me' and 'works for anyone.'", "what": "1. User-friendly docs/README (gdn-dadupo) 2. Permissions via --allowed-tools (gdn-kugeto) 3. UI polish: connection status (gdn-mezajo), font sizes (gdn-keseho), tap focus (gdn-vipita), working indicator (gdn-hugoso), message queueing (gdn-cahoci) 4. Notifications (research brief at docs/research-brief-notifications.md) 5. Swipe to delete folders (gdn-letahe) 6. Context injection at thresholds (gdn-lalepa)", "done": "Someone else's Claude can set up and use Guéridon from the README alone. No --dangerously-skip-permissions."}, "status": "done", "order": 19, "created_at": "2026-02-15T19:30:26Z", "created_by": "spm1001", "updated_at": "2026-02-15T19:32:30Z", "done_at": "2026-02-21T22:48:48Z"}
{"id": "gdn-lenuge", "type": "action", "title": "Build ClaudeCodeAgent adapter", "brief": {"why": "The adapter is the core translation layer between CC stream-json events and pi-web-ui's Agent interface. All context about the Agent contract and event mapping is warm in this session.", "what": "1. Subclass Agent from pi-agent-core 2. Override prompt() to send via transport (WebSocket later) 3. Build CC event handler that translates stream-json events to pi AgentEvents and state changes 4. Wire into main.ts replacing stub Agent 5. Verify ChatPanel still renders with adapter", "done": "ClaudeCodeAgent class exists, handles all CC event types from event-mapping.md, ChatPanel renders with it (non-functional until bridge exists)"}, "status": "done", "parent": "gdn-cejaba", "order": 6, "created_at": "2026-02-08T11:22:57Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Subclass Agent from pi-agent-core", "Override prompt() to send via transport (WebSocket later)", "Build CC event handler that translates stream-json events to pi AgentEvents and state changes", "Wire into main.ts replacing stub Agent", "Verify ChatPanel still renders with adapter"], "current": 5}, "done_at": "2026-02-08T11:25:39Z"}
{"id": "gdn-letahe", "type": "action", "title": "Swipe to delete folder/conversation", "brief": {"why": "No way to clean up the folder list on mobile. Long swipe gesture is natural for deletion.", "what": "1. Add swipe-to-delete gesture on folder list items 2. Only allow deletion for user-created folders (not system ones) 3. Confirmation before delete 4. Bridge endpoint to close/clean session", "done": "Can swipe to remove a folder from the list on mobile. Confirmation prevents accidents."}, "status": "done", "parent": "gdn-bujove", "order": 4, "created_at": "2026-02-15T19:30:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T20:20:48Z"}
{"id": "gdn-lihibi", "type": "action", "title": "Build WebSocket transport for browser", "brief": {"why": "The adapter has a CCTransport interface but no implementation. The browser needs a WebSocket client that connects to the bridge and satisfies CCTransport.", "what": "1. Implement CCTransport over WebSocket 2. Auto-reconnect with exponential backoff 3. Wire into ClaudeCodeAgent.connectTransport() in main.ts 4. Connection status indicator in UI", "done": "Browser connects to bridge on page load, messages flow both directions, reconnects after disconnect"}, "status": "done", "parent": "gdn-cejaba", "order": 8, "created_at": "2026-02-08T17:55:00Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Implement CCTransport over WebSocket", "Auto-reconnect with exponential backoff", "Wire into ClaudeCodeAgent.connectTransport() in main.ts", "Connection status indicator in UI"], "current": 4}, "done_at": "2026-02-08T18:41:59Z"}
{"id": "gdn-lijoli", "type": "action", "title": "Replace purple accent with Anthropic Coral", "brief": {"why": "The app uses purple (#c9a0ff / #6b4d8a) as its accent colour, but Guéridon's identity is Anthropic Coral (#E8734A). Purple has no connection to the brand — coral ties it visually to Claude.", "what": "1. Replace --accent (#c9a0ff) with a coral-based light value 2. Replace --accent-dim (#6b4d8a) with a coral-based dark value 3. Audit all accent usages for contrast — user bubbles, send button, input focus, slash command names, status bar elements 4. Ensure WCAG AA contrast against --bg (#1a1a1a) and --surface (#242424)", "done": "No purple anywhere in the palette. All accent-coloured elements use coral tones. Contrast passes AA on dark background. Visual identity matches the app icon."}, "status": "open", "parent": "gdn-situwu", "order": 62, "created_at": "2026-02-24T06:10:03Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-likira", "type": "action", "title": "Transport folder API and lobby handling", "brief": {"why": "The browser-side WSTransport needs methods to request the folder list and connect to a folder. It also needs to handle the lobby state where no session exists yet.", "what": "1. Add listFolders() and connectFolder(path) methods to WSTransport 2. Add onFolderList callback in options 3. Handle folderList message type in handleMessage 4. Handle connected with null sessionId (lobby mode) — don't fire onSessionId until connectFolder completes 5. Update docs/bridge-protocol.md with new message types and lobby flow", "done": "Transport can request folder list and receive it via callback. connectFolder triggers session establishment. Protocol docs updated."}, "status": "done", "parent": "gdn-zovogo", "order": 4, "created_at": "2026-02-09T06:15:34Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add listFolders() and connectFolder(path) methods to WSTransport", "Add onFolderList callback in options", "Handle folderList message type in handleMessage", "Handle connected with null sessionId (lobby mode) — don't fire onSessionId until connectFolder completes", "Update docs/bridge-protocol.md with new message types and lobby flow"], "current": 5}, "done_at": "2026-02-09T07:19:52Z"}
{"id": "gdn-lisina", "type": "action", "title": "Tool call blocks have inconsistent widths", "brief": {"why": "Collapsed tool call blocks render at different widths despite identical structure. Looks unpolished — visible in gdn-nogabe-replay.png.", "what": "1. Check .tool-call CSS — likely missing width:100% or has content-dependent sizing 2. Ensure all tool call blocks stretch to full container width", "done": "All tool call blocks render at consistent width."}, "status": "done", "parent": "gdn-situwu", "order": 53, "created_at": "2026-02-23T23:06:15Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:47:51Z"}
{"id": "gdn-loveva", "type": "action", "title": "Reconnecting state should be visually obvious — desaturated screen + message box as status channel", "brief": {"why": "Reconnecting indicator is a tiny 'reconnecting...' label next to the grey dot in the status bar. Easy to miss — screen looks empty and broken. The message box placeholder is wasted space that could communicate state.", "what": "1. On disconnect: apply CSS filter (grayscale + reduced opacity) to the message area — old content visible but clearly 'wrong', like Mac deep-sleep resume 2. Remove or demote the small 'reconnecting...' text label — the desaturation does the job", "done": "Disconnected state is immediately visually obvious (greyed-out conversation). No need to spot tiny status text."}, "status": "done", "parent": "gdn-situwu", "order": 35, "created_at": "2026-02-23T22:32:11Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T22:33:19Z", "updated_by": "edited", "done_at": "2026-02-23T23:49:39Z"}
{"id": "gdn-lugona", "type": "action", "title": "Session list spammed by auto-spawned subagent sessions", "brief": {"why": "Expanding a folder shows ALL session JSONL files including Task subagent sessions. test-project has 107 sessions, most are subagent-spawned UUIDs with no human interaction. Finding the real session is needle-in-haystack. Screenshot shows 20+ raw UUID entries all '9h' old.", "what": "1. Identify subagent sessions — they have no user-typed messages, only system+assistant+result events. Or detect by session metadata (spawned by Task tool, short-lived, low context) 2. Filter or collapse subagent sessions by default — show only human-interactive sessions 3. Show subagent count as a badge ('107 sessions, 3 interactive') 4. Consider a 'show all' toggle for debugging", "done": "Session list shows only human-interactive sessions by default. Subagent sessions hidden or collapsed. test-project shows 2-3 meaningful sessions, not 107 UUIDs."}, "status": "done", "parent": "gdn-situwu", "order": 48, "created_at": "2026-02-23T22:51:34Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:51:30Z"}
{"id": "gdn-mapubi", "type": "action", "title": "Mine persistent-assistant for reusable patterns", "brief": {"why": "DB's persistent-assistant (Telegram harness) has solved permission routing, tool result synthesis, and structured question handling — problems we're working on in Guéridon. Cross-reference with existing items like summarizeToolInput.", "what": "1. Read persistent-assistant codebase (permission routing, tool result flow) 2. Identify patterns applicable to Guéridon bridge 3. Cross-reference with open arc items (nakoko, goloki, dejave) 4. File specific extraction actions if patterns are reusable", "done": "Reusable patterns identified and either adopted or filed as specific actions."}, "status": "done", "parent": "gdn-zewumo", "order": 9, "created_at": "2026-02-12T19:36:28Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-16T19:16:04Z"}
{"id": "gdn-matihe", "type": "action", "title": "Sessions survive bridge restart", "brief": {"why": "Bridge restart (deploy, crash, manual) wipes the in-memory sessions Map. All running CC processes become orphaned — they keep running but no WS can reconnect to them. The bridge falls back to disk-based session resolution, which works for resume but loses ephemeral state (messageBuffer, turnInProgress, idle timers). On mobile, a deploy = silent session loss.", "what": "1. Write active session→folder mapping to a small JSON file on session create/destroy 2. On bridge startup, read the file and adopt any CC processes still running (check PID alive) 3. Clean up stale entries where PID is dead 4. Ensure idle timers and message buffers reinitialize on adopt", "done": "Kill bridge process, restart it, reconnect from mobile — same session continues with history intact. Orphaned CC processes are adopted, not duplicated."}, "status": "done", "parent": "gdn-besuse", "order": 19, "created_at": "2026-02-16T08:47:04Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Write active session→folder mapping to a small JSON file on session create/destroy", "On bridge startup, read the file and adopt any CC processes still running (check PID alive)", "Clean up stale entries where PID is dead", "Ensure idle timers and message buffers reinitialize on adopt"], "current": 4, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-16T09:34:08Z", "done_at": "2026-02-16T09:34:08Z"}
{"id": "gdn-mazeni", "type": "action", "title": "Folder selector dialog replaces model chooser", "brief": {"why": "pi-web-ui orchestration layer (ChatPanel, AgentInterface, MessageEditor) is full of abstractions we don't need (model selector, thinking level, cost tracking) and blocks input area customisation. Own the orchestration, consume the rendering (MessageList, StreamingMessageContainer) — the seam is clean (12 props + 1 imperative method).", "what": "1. Write GueridonInterface skeleton — Lit component rendering message-list + streaming-container + basic textarea, event translation loop, replace ChatPanel in main.ts 2. Build custom input bar — image upload placeholder, folder button with CWD display (truncated), inline context gauge %, send/abort button 3. Write FolderSelector dialog — centered modal with search and state dots, reuse folder-chooser rendering 4. Wire folder button to dialog to transport, auto-open on first load 5. Move connection status below chat input 6. Remove old code — ChatPanel/AppStorage setup, context-gauge.ts, full-screen folder-chooser.ts", "done": "GueridonInterface renders messages correctly. Custom input bar has folder button + gauge + send. Folder dialog opens from button and auto-opens on first load. Connection status at bottom. No ChatPanel/AgentInterface/MessageEditor dependency. No as-any casts for customStats."}, "status": "done", "parent": "gdn-hatiho", "order": 5, "created_at": "2026-02-09T07:54:25Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Write GueridonInterface skeleton — Lit component rendering message-list + streaming-container + basic textarea, event translation loop, replace ChatPanel in main.ts", "Build custom input bar — image upload placeholder, folder button with CWD display (truncated), inline context gauge %, send/abort button", "Write FolderSelector dialog — centered modal with search and state dots, reuse folder-chooser rendering", "Wire folder button to dialog to transport, auto-open on first load", "Move connection status below chat input", "Remove old code — ChatPanel/AppStorage setup, context-gauge.ts, full-screen folder-chooser.ts"], "current": 6}, "done_at": "2026-02-09T08:38:20Z"}
{"id": "gdn-mevama", "type": "action", "title": "DERP relay causes frequent WS disconnects on mobile cellular", "brief": {"why": "Phone connects to kube via Tailscale DERP relay (not direct) on cellular. Relay path is fragile — pong timeouts at 10s cause disconnects every few minutes. Mac SSH over the same bearer is stable because TCP handles relay hiccups better than WS.", "what": "1. Increase pong timeout from 10s to 30s (quick win for relay latency spikes) 2. Consider making WS reconnect invisible — suppress disconnect flash if reconnect succeeds within N seconds 3. Investigate Tailscale direct connection failures on mobile carriers (UDP hole punching)", "done": "Mobile sessions on cellular stay connected for 10+ minutes without visible interruption"}, "status": "done", "parent": "gdn-hatiho", "order": 12, "created_at": "2026-02-10T08:47:34Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:59:46Z"}
{"id": "gdn-mezajo", "type": "action", "title": "Connection status uses input bar hints instead of misleading green dot", "brief": {"why": "Green dot is misleading — suggests Claude is active when it just means WS connected. Placeholder text and send button states are better signalling surfaces.", "what": "1. Remove green dot 2. Use textarea placeholder for status (e.g. 'Connecting...', 'Message Claude...') 3. Send button: black arrow=send, red square=stop, pulsing green=reconnecting", "done": "Connection state is communicated through input bar elements, not a separate dot"}, "status": "done", "parent": "gdn-situwu", "order": 9, "created_at": "2026-02-15T19:30:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T19:46:10Z"}
{"id": "gdn-modesu", "type": "action", "title": "Verify main.ts auto_connect doesn't conflict with transport reconnect", "brief": {"why": "main.ts has an auto_connect path (localStorage → connectFolder on lobbyConnected). Transport now auto-sends connectFolder on reconnect and suppresses onLobbyConnected. Code reading confirms no conflict, but should verify with a manual test: connect to folder, force-refresh, confirm no double connectFolder in bridge logs.", "what": "1. Connect to folder on kube via mobile 2. Force-refresh page 3. Check bridge logs for connectFolder messages — should see exactly one per reconnect 4. Test returnToLobby then reconnect — should see lobby then auto_connect from localStorage", "done": "Manual test confirms single connectFolder on reconnect and correct auto_connect on fresh load"}, "status": "done", "parent": "gdn-besuse", "order": 9, "created_at": "2026-02-10T21:06:17Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:32:24Z"}
{"id": "gdn-mohupa", "type": "action", "title": "Create circular buffer subscriber in server/status-buffer.ts", "brief": {"why": "Enables /status endpoint to show recent events without file I/O. Viewable from the mobile client itself — no SSH needed.", "what": "New file server/status-buffer.ts. Subscribes to event bus. Maintains a fixed-size ring buffer (capacity ~200 entries). Exports getRecent(n?: number) returning the last N events in order. Each entry is the BridgeEvent plus a timestamp.", "done": "status-buffer.ts keeps last 200 events in memory. getRecent() returns them chronologically. Buffer wraps correctly when full."}, "status": "done", "parent": "gdn-wecimo", "order": 4, "created_at": "2026-02-22T17:06:32Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Write status-buffer.ts — ring buffer subscriber with getRecent()", "Write status-buffer.test.ts — verify wrap and chronological ordering"], "current": 2, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-22T21:19:50Z", "updated_by": "stepped", "done_at": "2026-02-22T21:19:50Z"}
{"id": "gdn-mopiho", "type": "action", "title": "Add GET /status debug endpoint", "brief": {"why": "Quick health check without SSH. Viewable from phone via curl or browser. Surfaces live state and recent history.", "what": "Add GET /status route to bridge.ts. Returns JSON with: bridge uptime, Node memory usage (process.memoryUsage), active sessions (folder, pid, uptime, context%, turnInProgress), SSE client count per session, recent events from circular buffer (last 50).", "done": "GET /status returns well-structured JSON. Works from curl and browser. Shows sessions, clients, recent events, and system health."}, "status": "done", "parent": "gdn-wecimo", "order": 9, "created_at": "2026-02-22T17:28:15Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add GET /status route to bridge.ts HTTP server"], "current": 1, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-23T06:51:54Z", "updated_by": "stepped", "done_at": "2026-02-23T06:51:54Z"}
{"id": "gdn-muloda", "type": "action", "title": "Folder scan unit tests with mocked fs", "brief": {"why": "server/folders.ts has pure functions and mockable fs calls — high value, low effort. The regex-based handoff parsing is fragile and untested against edge cases.", "what": "1. Create server/folders.test.ts 2. Test encodePath edge cases (slashes, dots, spaces, root) 3. Test getLatestSession with vi.mock('node:fs/promises') — ENOENT, empty dir, picks newest, ignores non-jsonl 4. Test getLatestHandoff — well-formed, malformed, missing dir 5. Test scanFolders — state derivation for all four states, sort order, hidden dirs skipped, activeProcesses map", "done": "All tests pass. Covers encodePath, getLatestSession, getLatestHandoff, scanFolders with mocked filesystem."}, "status": "done", "parent": "gdn-vevoca", "order": 2, "created_at": "2026-02-09T06:38:47Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Create server/folders.test.ts", "Test encodePath edge cases (slashes, dots, spaces, root)", "Test getLatestSession with vi.mock('node:fs/promises') — ENOENT, empty dir, picks newest, ignores non-jsonl", "Test getLatestHandoff — well-formed, malformed, missing dir", "Test scanFolders — state derivation for all four states, sort order, hidden dirs skipped, activeProcesses map"], "current": 5}, "done_at": "2026-02-09T09:24:47Z"}
{"id": "gdn-murimo", "type": "action", "title": "Trim desktop chrome for mobile — keep useful controls", "brief": {"why": "Pi-web-ui's button row has desktop-oriented controls (thinking toggle, model selector, attachment button, Anthropic logo) that eat vertical space on mobile. Some are useful to wire up (attachment for image input?), model selector is irrelevant (CC handles model selection server-side).", "what": "1. Audit which pi-web-ui button-row controls are still relevant after owning the shell 2. Remove irrelevant controls (model selector, Anthropic logo) 3. Keep/adapt useful ones (attachment → paperclip already exists) 4. Ensure input area is optimised for mobile viewport", "done": "Input area uses only mobile-relevant controls. No desktop-only chrome consuming vertical space."}, "status": "done", "parent": "gdn-cejaba", "order": 2, "created_at": "2026-02-08T22:19:25Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Audit which pi-web-ui button-row controls are still relevant after owning the shell", "Remove irrelevant controls (model selector, Anthropic logo)", "Keep/adapt useful ones (attachment → paperclip already exists)", "Ensure input area is optimised for mobile viewport"], "current": 4}, "done_at": "2026-02-09T21:37:18Z"}
{"id": "gdn-musimu", "type": "outcome", "title": "Mac is a viewport into Kube, not a separate dev environment", "brief": {"why": "Working across Mac and Kube means syncing repos, which causes git corruption risk, OS-difference piranha bites, and .arc/ conflicts. Mid-session device switching is impossible with sync-based approaches.", "what": "1. CLI bridge client for Mac terminal 2. Tailscale plumbing (Taildrive, serve for CDP) 3. Remote webctl over Tailscale 4. Image upload protocol extension", "done": "Can start a CC session from Mac terminal via bridge, browse as user via Chrome controlled from Kube, edit files in Sublime via Taildrive mount, and see context gauge at all times. Design doc: docs/kube-brain-mac-body.md"}, "status": "done", "order": 14, "created_at": "2026-02-11T07:49:38Z", "created_by": "spm1001", "waiting_for": "Someday/maybe — CLI is stale WS code, needs full rewrite for SSE+POST before any of this is actionable", "updated_at": "2026-02-21T22:27:05Z", "updated_by": "waited", "done_at": "2026-02-23T20:48:08Z"}
{"id": "gdn-nafazi", "type": "action", "title": "Run full integration tests 1-3 with real CC process", "brief": {"why": "Tests 1-3 in test-bridge.ts spawn a real CC process and test prompt→response, multi-turn, and reconnect. They were updated to use lobby→connectFolder path but haven't been run with a live CC since the ?session= removal. Lobby tests (4-9) pass.", "what": "1. Start bridge 2. Run npx tsx scripts/test-bridge.ts (without --lobby) 3. Verify tests 1-3 pass with real CC spawning 4. Fix any issues", "done": "All 9 integration tests pass against running bridge with real CC processes"}, "status": "done", "parent": "gdn-puzoni", "order": 5, "created_at": "2026-02-10T21:06:12Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T21:47:01Z", "updated_by": "edited", "done_at": "2026-02-21T22:56:11Z"}
{"id": "gdn-nakoko", "type": "action", "title": "AskUserQuestion works natively, not via error-and-workaround", "brief": {"why": "Currently AskUserQuestion errors in -p mode (no TTY). The bridge detects the tool_use event, renders buttons for the human, and the error is suppressed via append-system-prompt. Claude has to be told to ignore the error. This works but it's a hack — Claude's instinct is to apologise for or retry errors.", "what": "1. Investigate CC's AskUserQuestion behaviour in -p stream-json mode 2. Design bridge interception — catch tool_use, render for client, synthesise a successful tool_result back to CC stdin 3. Implement so Claude sees a clean success, not an error followed by a workaround message", "done": "Investigated thoroughly (wt-sleuthing session). CC -p mode has no mechanism to inject synthetic tool_results via stdin — the error-and-workaround via append-system-prompt is the best available approach. AskUserQuestion renders as tappable buttons, user selection flows back as next message. Works reliably."}, "status": "done", "parent": "gdn-zewumo", "order": 2, "created_at": "2026-02-11T07:59:05Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:32:23Z"}
{"id": "gdn-nasahe", "type": "action", "title": "Bridge lobby mode and folder protocol", "brief": {"why": "Currently every WS connection immediately creates a session. The folder chooser needs a pre-session 'lobby' where the browser can list folders and pick one before any CC process is spawned.", "what": "1. Add folder field to Session interface 2. WS connects without ?session= enters lobby mode (no session created) 3. Handle listFolders message — call scanFolders(), return folderList response 4. Handle connectFolder message — create/resume session for chosen folder, send connected with sessionId 5. Reject prompt/abort in lobby mode with error 6. Existing ?session= path unchanged for backwards compat", "done": "WS can connect, send listFolders, get enriched list back, send connectFolder, get session. Prompt before connectFolder returns error. Old ?session= flow still works."}, "status": "done", "parent": "gdn-zovogo", "order": 2, "created_at": "2026-02-09T06:15:19Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add folder field to Session interface", "WS connects without ?session= enters lobby mode (no session created)", "Handle listFolders message — call scanFolders(), return folderList response", "Handle connectFolder message — create/resume session for chosen folder, send connected with sessionId", "Reject prompt/abort in lobby mode with error", "Existing ?session= path unchanged for backwards compat"], "current": 6}, "done_at": "2026-02-09T06:51:15Z"}
{"id": "gdn-neperu", "type": "action", "title": "Deterministic session IDs and resume flow", "brief": {"why": "Currently session IDs are random UUIDs — picking a folder can't find its session. Folder path must deterministically produce a session ID so resume works. The three resume paths (active/paused/closed) each behave differently.", "what": "1. Define deterministic session ID derivation from folder path (e.g. hash or encoded path) 2. Update bridge-logic.ts resolveSessionForFolder to use deterministic IDs 3. Update bridge.ts connectFolder to look up by derived ID 4. Verify resume flow: active → reconnect, paused → resume, closed → fresh session with new ID", "done": "Same folder always produces same session ID. Reconnecting to an active session works. Resuming a paused session works. Closed sessions start fresh."}, "status": "done", "parent": "gdn-hatiho", "order": 4, "created_at": "2026-02-08T22:13:07Z", "created_by": "spm1001", "waiting_for": "Deferred: Resume already works via bridge-logic.ts session resolution. Deterministic IDs are refinement, not prerequisite.", "done_at": "2026-02-10T19:59:40Z"}
{"id": "gdn-nibiru", "type": "action", "title": "Folder chooser ranking and grouping needs rework", "brief": {"why": "The current Active/Dormant/Recent grouping doesn't match how folders are actually used. Ranking logic needs to surface what matters — recently active folders with meaningful sessions — not just time-based buckets.", "what": "1. Review current grouping logic in renderSwitcher 2. Design better ranking: recent interaction > has active CC process > has handoff > session count 3. Consider collapsing folders with no recent human interaction 4. Test with real folder set (mix of active projects, dormant repos, one-off tests)", "done": "Folder chooser surfaces the folders you want within the first screen. Rarely-used folders are demoted, not just time-sorted."}, "status": "open", "parent": "gdn-situwu", "order": 47, "created_at": "2026-02-23T22:51:23Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-nicaju", "type": "action", "title": "Remove legacy ?session= reconnect path — all connections go through lobby", "brief": {"why": "The ?session= URL path bypasses connectFolder, creating sessions with folder:null. This causes: (1) CC spawned with no cwd on bridge restart, (2) session invisible to folder lookup, (3) lost conversation history on return. The speed gain (~200ms) over lobby→connectFolder is negligible — first-load already uses the lobby path without complaint.", "what": "1. Remove ?session= handling from bridge.ts connection handler (lines 688-726) 2. In ws-transport.ts doConnect(), always connect without ?session= — store folder path, re-send connectFolder on reconnect 3. Verify connectFolder finds existing bridge session (multi-WS reconnect path) 4. Update tests 5. Test on kube: kill WS, verify reconnect goes through lobby and replays buffer correctly", "done": "Single connection path: all WS connections start in lobby, reconnects use connectFolder. No folder:null sessions. Reconnect on mobile replays buffer correctly after bridge restart."}, "status": "done", "parent": "gdn-besuse", "order": 8, "created_at": "2026-02-10T20:46:57Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Remove ?session= handling from bridge.ts connection handler", "ws-transport.ts: always connect plain, re-send connectFolder on reconnect", "Update tests for both bridge and transport", "Verify existing multi-WS reconnect path in connectFolder works", "Test end-to-end: disconnect + reconnect replays buffer correctly"], "current": 5}, "done_at": "2026-02-10T20:56:15Z"}
{"id": "gdn-ninake", "type": "action", "title": "Slash button, input box and send button aren't vertically centred", "brief": {"why": "The input row uses align-items: flex-end, aligning all three elements to the bottom edge. The / button, textarea, and send button have different heights, so their visual centres are misaligned.", "what": "1. Change .input-row align-items from flex-end to center 2. Test with single-line and multi-line textarea to ensure buttons stay centred (or bottom-aligned when textarea grows tall — may need conditional logic)", "done": "All three input row elements are vertically centred when textarea is single-line. Screenshot comparison confirms alignment."}, "status": "done", "parent": "gdn-situwu", "order": 38, "created_at": "2026-02-23T22:34:17Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:02:32Z"}
{"id": "gdn-ninawa", "type": "outcome", "title": "Study Shelley's claudetool/ for reusable patterns", "brief": {"why": "Shelley implements model-adaptive tool schemas (simplified for weaker models, full for Opus/Sonnet) in its patch tool. Their bash, keyword_search, and subagent tools may have patterns worth studying. Cloned at ~/Repos/shelley.", "what": "1. Read claudetool/patch.go — understand model-adaptive schema pattern 2. Read claudetool/bash.go — compare to CC's Bash tool, note JIT tool installation support 3. Read claudetool/subagent.go — parent-child tracking, timeout-based progress summaries 4. Read claudetool/keyword_search.go — compare to CC's Grep/Glob 5. Write findings to docs/ if anything is worth adapting", "done": "Written assessment of which patterns (if any) are worth adapting for Guéridon or feeding back to CC"}, "status": "done", "order": 23, "created_at": "2026-02-16T18:07:58Z", "created_by": "spm1001", "done_at": "2026-02-21T22:26:50Z"}
{"id": "gdn-niwaru", "type": "action", "title": "Page title and favicon badge signal Claude's state", "brief": {"why": "Desktop users with multiple tabs can't tell which Guéridon tab has a finished response. Zero infrastructure needed — just document.title and a favicon swap. No iOS standalone benefit but free.", "what": "1. On agent_end: document.title = '✓ folder — Guéridon'. On agent_start: '⏳ folder — Guéridon'. On AskUserQuestion: '❓ folder — Guéridon' 2. Revert to normal title on user interaction (focus, keydown, or next prompt) 3. Favicon badge: create dot-overlay variant of favicon, swap link[rel=icon] on state change 4. Tests for title state machine", "done": "Open two Guéridon tabs on desktop. Send a prompt in one, switch to the other. Tab title shows ✓ when Claude finishes. Favicon has a dot."}, "status": "done", "parent": "gdn-jetune", "order": 1, "created_at": "2026-02-15T21:41:24Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["On agent_end: document.title = '✓ folder — Guéridon'. On agent_start: '⏳ folder — Guéridon'. On AskUserQuestion: '❓ folder — Guéridon'", "Revert to normal title on user interaction (focus, keydown, or next prompt)", "Favicon badge: create dot-overlay variant of favicon, swap link[rel=icon] on state change", "Tests for title state machine"], "current": 4, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-15T21:44:38Z", "done_at": "2026-02-15T21:44:38Z"}
{"id": "gdn-nogabe", "type": "action", "title": "Tool calls visible during streaming but vanish after turn completes", "brief": {"why": "During live streaming, tool calls render correctly (orange dots, names, inputs). After the turn completes and the full state snapshot replaces the delta-built state, tool calls disappear entirely. Persists after page reload. Screenshots show Read, Read, Glob visible mid-stream, then gone — only text remains, with all turn text merged into one block.", "what": "1. Bug is in live streaming state, NOT JSONL replay — tool calls appear correctly on full timed-out reload (replay path) but vanish during live session turn-end snapshot 2. Investigate: compare getState() output at turn end vs what deltas built — add logging in onTurnComplete to dump message tool_calls 3. Check if the dedup logic (seenMessageIds) causes handleAssistant to skip on a second assistant event that carries the complete content 4. Check if the full state broadcast in onTurnComplete overwrites delta-built tool_calls with a snapshot that has none 5. Fix: ensure committed messages in state always include tool_calls from stream events", "done": "Tool calls persist after turn completion and page reload. Multi-turn tool-heavy conversations show all tool call blocks."}, "status": "done", "parent": "gdn-situwu", "order": 44, "created_at": "2026-02-23T22:42:55Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T23:05:47Z", "updated_by": "edited", "done_at": "2026-02-23T23:48:12Z"}
{"id": "gdn-nucafa", "type": "action", "title": "Image upload via bridge protocol", "brief": {"why": "Image input is a revolution (drag to terminal). Both CLI and web clients will want it. Needs a bridge protocol extension since the image lives on the client, not on Kube.", "what": "1. Design protocol message for binary/base64 image data 2. Bridge receives image, injects into CC stdin as content array 3. CLI client: read local file, encode, send 4. Web client: file picker or paste, encode, send", "done": "Can send an image from Mac CLI client or Gueridon web UI, CC receives and processes it. Existing gdn-gukivo covers the CC stdin side."}, "status": "done", "parent": "gdn-musimu", "order": 4, "created_at": "2026-02-11T07:50:12Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Create src/image-utils.ts — pure utility functions (resize, base64, validation)", "Create src/image-utils.test.ts — test pure functions", "Wire paperclip button + file input + addFiles in gueridon-interface.ts", "Add thumbnail preview strip to input bar template", "Modify handleSend() to build ContentBlock[] when images pending", "Add clipboard paste handler on textarea", "Add drag-and-drop with overlay on root element", "Show images in user message bubbles (agent displayContent + UserMessage render)", "Update send button state + cleanup in disconnectedCallback", "Add image upload tests to gueridon-interface.test.ts"], "current": 10}, "done_at": "2026-02-12T00:31:29Z"}
{"id": "gdn-nutizi", "type": "action", "title": "Tool use blocks are chunky and intercept scroll", "brief": {"why": "Tool blocks take up too much vertical space on mobile, and touching inside one captures the scroll gesture — scrolling the tool contents instead of the conversation. Users rarely need to see tool contents, just that it happened and whether it succeeded.", "what": "1. Collapse tool blocks by default — show tool name + status (success/error) 2. Tap to expand for full contents 3. Fix scroll capture — tool block contents should not intercept page scroll 4. Error state should be visually distinct (expand automatically on error?)", "done": "Tool blocks collapsed by default, expandable on tap, don't intercept scroll, errors auto-expand"}, "status": "done", "parent": "gdn-situwu", "order": 2, "created_at": "2026-02-10T08:18:44Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:12:36Z"}
{"id": "gdn-paciju", "type": "outcome", "title": "Adapter cleanly translates CC events without workarounds", "brief": {"why": "5 actions in claude-code-agent.ts — isStreaming hack, as-any test casts, unverified gauge, unexplored image input, artifacts mismatch. Each is a workaround or gap in the adapter layer.", "what": "1. Move isStreaming into stream event handlers 2. Export pure helpers to eliminate as-any casts 3. Verify context gauge against /context 4. Investigate image input via content arrays 5. Resolve artifacts tool mismatch", "done": "Adapter has no workarounds, no as-any test casts, gauge is validated, image and artifacts paths are resolved or documented"}, "status": "done", "order": 12, "created_at": "2026-02-10T20:11:41Z", "created_by": "spm1001", "done_at": "2026-02-24T06:24:05Z"}
{"id": "gdn-padebo", "type": "action", "title": "Folder switch doesn't isolate — old session bleeds through", "brief": {"why": "storeFolder runs on connection success, not on switch intent. If WS drops mid-switch, reconnect auto-connects to the OLD stored folder. User sees wrong session's messages and button locking.", "what": "1. Store intended folder at connectToFolder() time, not onFolderConnected 2. Or clear stored folder during switch so reconnect falls to picker 3. Test: switch folders with network flap simulation", "done": "Switch folders on flaky mobile connection — never see old session's messages"}, "status": "done", "parent": "gdn-besuse", "order": 16, "created_at": "2026-02-16T07:06:12Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Store intended folder at connectToFolder() time, not onFolderConnected", "Or clear stored folder during switch so reconnect falls to picker", "Test: switch folders with network flap simulation"], "current": 3, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-16T07:12:37Z", "done_at": "2026-02-16T07:12:37Z"}
{"id": "gdn-pahawu", "type": "action", "title": "Code-split heavy deps for mobile data", "brief": {"why": "Bundle is 4.7MB (1.2MB gzip) — fine on WiFi but painful on mobile data. KaTeX, PDF.js, highlight.js are only needed when CC sends math/docs/code.", "what": "1. Audit pi-web-ui imports for lazy-loadable chunks 2. Dynamic import() for KaTeX, PDF.js, highlight.js on first use 3. Consider service worker for offline cache", "done": "First load under 500KB gzip on fresh cache. Heavy deps load on demand."}, "status": "done", "parent": "gdn-cejaba", "order": 11, "created_at": "2026-02-08T21:35:36Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-09T15:46:38Z"}
{"id": "gdn-patati", "type": "action", "title": "Build CLI bridge client", "brief": {"why": "Need a terminal client on Mac that connects to Gueridon's bridge on Kube. This is the core deliverable — makes Mac a first-class CC viewport without running CC locally.", "what": "1. WebSocket connection to bridge 2. Folder picker (listFolders → select → connectFolder) 3. Prompt input loop 4. Stream CC events and render text/tool calls 5. Always-visible context gauge from result event usage data 6. AskUserQuestion detection and option rendering", "done": "Can run client from Mac terminal, pick a Kube repo, have a full conversation with streaming output and context gauge visible. AskUserQuestion renders as selectable options."}, "status": "done", "parent": "gdn-musimu", "order": 1, "created_at": "2026-02-11T07:49:47Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T00:14:58Z"}
{"id": "gdn-patese", "type": "action", "title": "First messages scroll under iOS status bar icons", "brief": {"why": "Messages area has padding: 12px 14px 16px — no safe-area-inset-top. First few messages in a new conversation sit behind the iOS clock/signal/battery icons. Fine once content fills the screen, but broken at conversation start.", "what": "1. Add var(--safe-top) to .messages padding-top: padding: calc(var(--safe-top) + 12px) 14px 16px", "done": "First message in a new conversation sits below the iOS status bar, not behind it."}, "status": "done", "parent": "gdn-situwu", "order": 37, "created_at": "2026-02-23T22:33:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:02:31Z"}
{"id": "gdn-pefeva", "type": "action", "title": "Extract bridge IO handlers for testability", "brief": {"why": "handleSessionMessage, handleLobbyMessage, wireProcessToSession are untestable because importing bridge.ts starts a WebSocketServer. The bridge-logic.ts extraction covered pure functions but the IO routing logic — which is where session lifecycle bugs live — still has no tests.", "what": "1. Wrap WebSocketServer creation in bridge.ts behind a factory or lazy init (so import doesn't start server) 2. Extract handleSessionMessage and handleLobbyMessage to accept session/conn as args 3. Write unit tests for lobby→session transition, prompt routing, error on wrong-mode messages 4. Test lobbyQueue error propagation (.catch on chain)", "done": "bridge.ts can be imported in tests without starting a server. handleSessionMessage and handleLobbyMessage have unit tests covering the routing and error paths."}, "status": "done", "parent": "gdn-puzoni", "order": 1, "created_at": "2026-02-09T10:15:24Z", "created_by": "spm1001", "waiting_for": "Deferred: Testability improvement, no user impact. Will matter when building buffering/lifecycle features.", "updated_at": "2026-02-21T21:47:00Z", "updated_by": "edited", "done_at": "2026-02-21T22:56:11Z"}
{"id": "gdn-penaki", "type": "action", "title": "Continue UX polish iteration with phone testing harness", "brief": {"why": "Session established the testing loop: mock bridge + Vite HMR + phone screenshots. Two fixes shipped (right-align bubbles, toggle layout shift). Many more UI items queued.", "what": "1. Start harness: sudo systemctl stop gueridon && nohup npx tsx scripts/mock-bridge.ts &, then nohup npx vite --host 0.0.0.0 & 2. Phone connects to kube:5173 3. Screenshots save via Taildrive to ~/Repos/scratch/ (iOS names like IMG_XXXX.PNG) 4. Work through: gdn-mezajo (connection status), gdn-keseho (font sizes), gdn-hugoso (working indicator), gdn-vipita (tap focus) 5. After mock testing, rebuild (npm run build) and restart real bridge (sudo systemctl start gueridon)", "done": "At least 3 more UI issues fixed and verified on phone"}, "status": "done", "parent": "gdn-situwu", "order": 13, "created_at": "2026-02-15T19:32:41Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Start harness: sudo systemctl stop gueridon && nohup npx tsx scripts/mock-bridge.ts &, then nohup npx vite --host 0.0.0.0 &", "Phone connects to kube:5173", "Screenshots save via Taildrive to ~/Repos/scratch/ (iOS names like IMG_XXXX.PNG)", "Work through: gdn-mezajo (connection status), gdn-keseho (font sizes), gdn-hugoso (working indicator), gdn-vipita (tap focus)", "After mock testing, rebuild (npm run build) and restart real bridge (sudo systemctl start gueridon)"], "current": 5, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-15T19:46:44Z", "done_at": "2026-02-15T19:46:44Z"}
{"id": "gdn-picoki", "type": "action", "title": "Simplify folder lifecycle — two concerns, not three", "brief": {"why": "Three overlapping state models exist: transport ConnectionState (5 states), folder lifecycle FolderPhase (4 phases, ~22 transitions), and the status dot (driven by transport). The folder lifecycle is doing double duty — UI state (picker open/closed) AND transport mechanics (lobby teardown, retries, switching). The real model is two independent things: transport (pipe status, drives the status dot, owns reconnect/retry) and picker (open/closed, which folder tapped). The folder lifecycle state machine in the middle should be eliminated, its transport concerns absorbed by ws-transport and its UI concerns reduced to two booleans.", "what": "1. Move switching/reconnect/retry logic into ws-transport — transport accepts 'connect to folder X' and handles lobby teardown internally. 2. Replace folder-lifecycle.ts with two independent pieces of state: pickerOpen boolean, connectedFolder string|null. 3. Loading state (connecting spinner) is local to the folder row in the picker, not a global phase. 4. Status dot continues to be driven by transport state (already works this way). 5. Update gueridon-interface and main.ts to use the simplified model.", "done": "folder-lifecycle.ts is gone or reduced to trivial picker open/close logic. No knowledge of lobby mode, WS teardown, or retry counting in UI state. Transport layer owns all reconnect mechanics. Two concerns, not three."}, "status": "done", "parent": "gdn-bujove", "order": 3, "created_at": "2026-02-10T22:35:57Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T00:14:58Z"}
{"id": "gdn-pokuhe", "type": "action", "title": "Markdown parser missing headers, italic, strikethrough, links, task lists", "brief": {"why": "The hand-rolled md() parser only handles bold, inline code, code blocks, tables, and flat lists. Headers (##), italic (*), strikethrough (~~), links [text](url), task lists (- [x]), and nested lists all render as raw text. Screenshot shows Claude's markdown showcase failing across the board.", "what": "1. Add header handling (# through ######) → h1-h6 tags 2. Add italic (*text*) to inline() — must not conflict with bold (**) 3. Add strikethrough (~~text~~) to inline() 4. Add link [text](url) to inline() 5. Add task list checkbox rendering (- [x] / - [ ]) 6. Handle nested list indentation (2-space or 4-space prefix) 7. Handle bullet • as list prefix (not just -)", "done": "Claude's markdown showcase screenshot renders correctly: headers sized, italic/strikethrough styled, links clickable, task lists show checkboxes."}, "status": "done", "parent": "gdn-situwu", "order": 42, "created_at": "2026-02-23T22:36:46Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:47:50Z"}
{"id": "gdn-pomoma", "type": "action", "title": "Production smoke test catches serving regressions", "brief": {"why": "Manual 'open browser and see' catches nothing in CI. The bridge serves index.html directly (no build step) but nothing verifies it actually starts and responds.", "what": "1. Add test: start bridge, curl localhost:3001 returns HTML with expected markers 2. Add test: curl /folders returns JSON array 3. Add test: curl /nonexistent returns 404 4. Tear down bridge process in afterAll", "done": "npm test includes a smoke test that starts bridge on a free port, verifies HTTP responses, and tears down cleanly"}, "status": "done", "parent": "gdn-puzoni", "order": 4, "created_at": "2026-02-10T06:20:33Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T22:56:17Z", "updated_by": "edited", "done_at": "2026-02-22T07:24:50Z"}
{"id": "gdn-popucu", "type": "action", "title": "Tailscale plumbing — Taildrive and serve", "brief": {"why": "Tailscale replaces three separate tools: SSHFS (for editor file access), SSH tunnels (for CDP), and port forwarding (for dev servers). All already running on both machines.", "what": "1. tailscale drive share repos ~/Repos on Kube 2. Verify drive:share and drive:access ACL attributes 3. Mount Taildrive on Mac via Finder/CLI 4. tailscale serve 9222 on Mac for Chrome CDP 5. Test webctl from Kube reaching Mac's Chrome 6. Fix --accept-routes health warning on Kube", "done": "Sublime on Mac can open and edit files on Kube via Taildrive mount. webctl on Kube can navigate and snapshot Mac's Chrome. No SSH tunnels involved."}, "status": "open", "parent": "gdn-musimu", "order": 2, "created_at": "2026-02-11T07:49:55Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-pudaco", "type": "action", "title": "Unknown CC event types logged, not silently dropped", "brief": {"why": "No default case in handleCCEvent or handleStreamEvent. When CC adds new event types, they vanish without trace. Makes debugging schema drift impossible.", "what": "1. Add default case to handleCCEvent with console.debug for unknown types 2. Add default case to handleStreamEvent 3. Add test: unknown event type emits debug log, doesn't throw", "done": "Unknown CC event types produce console.debug with event type and payload summary"}, "status": "done", "parent": "gdn-cejaba", "order": 19, "created_at": "2026-02-09T15:46:58Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add default case to handleCCEvent", "Add default case to handleStreamEvent", "Add tests"], "current": 3}, "done_at": "2026-02-09T16:17:31Z"}
{"id": "gdn-puzoni", "type": "outcome", "title": "Bridge integration tests prove the wiring works end-to-end", "brief": {"why": "Unit tests cover pure functions (200+ tests) but the IO wiring in bridge.ts — session lifecycle, idle guards, replay, queueing — has zero automated coverage. Bugs here are invisible until production.", "what": "1. Extract IO handlers for testability (gdn-pefeva) 2. Idle guard integration tests 3. Replay integration test 4. Production smoke test 5. Full integration tests with real CC 6. Message queueing integration test", "done": "npm test includes integration tests that start the bridge, exercise session lifecycle paths, and tear down cleanly. No manual bridge restart needed to run them."}, "status": "done", "order": 24, "created_at": "2026-02-21T21:46:56Z", "created_by": "spm1001", "done_at": "2026-02-23T20:46:24Z"}
{"id": "gdn-ranovi", "type": "action", "title": "Session exit should be a visible slash command, not a hidden long-press", "brief": {"why": "The only way to end a session is long-pressing the context gauge — a gesture nobody would discover. /exit should appear in the slash menu as a local command that triggers exitSession().", "what": "1. Add 'exit' to the client-side local commands with description 'End session and return to lobby' 2. Wire it to call exitSession() (with the existing confirmation dialog) 3. Keep the long-press as a power-user shortcut but it's no longer the only path", "done": "/exit appears in the slash menu. Tapping it shows confirmation and returns to lobby. Long-press still works as shortcut."}, "status": "done", "parent": "gdn-situwu", "order": 40, "created_at": "2026-02-23T22:35:05Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:49:39Z"}
{"id": "gdn-rawira", "type": "action", "title": "Safari Reader Mode shows stale content after session switch", "brief": {"why": "Safari Reader Mode captures a snapshot of the DOM. Switching sessions changes the underlying content but Reader Mode retains its cached snapshot. Re-entering Reader Mode after a session switch shows the old session's content instead of the current one.", "what": "1. Investigate whether this is a Safari Reader Mode caching behaviour we can influence (meta tags, DOM mutation signals) 2. Check if there's a way to invalidate Reader Mode's cache on session switch (document.title change, significant DOM restructure) 3. If Safari-side and unfixable, document as known limitation", "done": "Re-entering Reader Mode after a session switch shows current session content, OR documented as unfixable Safari behaviour with workaround noted."}, "status": "done", "parent": "gdn-situwu", "order": 7, "created_at": "2026-02-10T08:37:57Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T20:20:54Z"}
{"id": "gdn-refiju", "type": "action", "title": "Audit bridge operations that should work in session mode", "brief": {"why": "listFolders was blocked in session mode causing stale folder picker. Other operations may be similarly over-restricted. As we add dashboard features (gdn-hikosa), more queries will need session-mode access.", "what": "1. List all bridge message types and their current session/lobby restrictions 2. Identify read-only operations that should be allowed in session mode 3. Consider a queue pattern for async session messages (currently uses .catch() band-aid)", "done": "All read-only bridge operations work in session mode, async error handling is consistent"}, "status": "done", "parent": "gdn-besuse", "order": 3, "created_at": "2026-02-09T22:47:56Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:32:24Z"}
{"id": "gdn-rehona", "type": "action", "title": "Adapter unit tests from verified JSONL", "brief": {"why": "The adapter translates CC stream-json events to pi AgentEvents. We have verified JSONL schemas in docs/empirical-verification.md — feeding them through handleCCEvent() and asserting output catches regressions.", "what": "1. Test framework (vitest) 2. Feed verified JSONL sequences through handleCCEvent 3. Assert resulting pi AgentEvents and state changes 4. Cover: text response, tool use, thinking blocks, error, abort", "done": "Tests pass, cover all event types from empirical-verification.md"}, "status": "done", "parent": "gdn-vevoca", "order": 5, "created_at": "2026-02-08T17:57:48Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Test framework (vitest)", "Feed verified JSONL sequences through handleCCEvent", "Assert resulting pi AgentEvents and state changes", "Cover: text response, tool use, thinking blocks, error, abort"], "current": 4}, "done_at": "2026-02-09T09:31:47Z"}
{"id": "gdn-rewuke", "type": "action", "title": "Swipe-to-delete UX feels wrong on iOS — red flashes on tap, threshold too low", "brief": {"why": "Red delete zone flashes briefly on normal folder taps. The swipe threshold is too sensitive — iOS convention requires more deliberate horizontal pull before revealing the action. Current feel is janky, not native.", "what": "1. Increase horizontal swipe threshold before delete zone appears 2. Add velocity/distance gating so taps don't trigger flash 3. Match iOS Mail-style kinetics — progressive reveal with momentum", "done": "Tap to select never shows red flash, swipe requires deliberate horizontal gesture before delete appears"}, "status": "done", "parent": "gdn-situwu", "order": 16, "created_at": "2026-02-16T08:16:06Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Increase horizontal swipe threshold before delete zone appears", "Add velocity/distance gating so taps don't trigger flash", "Match iOS Mail-style kinetics — progressive reveal with momentum"], "current": 3, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-16T21:27:42Z", "done_at": "2026-02-16T21:27:42Z"}
{"id": "gdn-ridiku", "type": "action", "title": "Add client-side error reporter in index.html", "brief": {"why": "Completes the client→server error pipeline. Global handlers catch unhandled errors and rejected promises that would otherwise be silent on mobile.", "what": "In index.html, add window.onerror and window.onunhandledrejection handlers that POST to /client-error with {message, stack, userAgent, url}. Fire-and-forget fetch (no await, no error handling on the report itself). Deduplicate identical errors within 5 seconds.", "done": "Unhandled JS errors and promise rejections are reported to the server. Deduplicated. Visible in server logs and /status."}, "status": "done", "parent": "gdn-wecimo", "order": 11, "created_at": "2026-02-22T17:28:26Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add global error handlers in index.html that POST to /client-error"], "current": 1, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-23T06:53:10Z", "updated_by": "stepped", "done_at": "2026-02-23T06:53:10Z"}
{"id": "gdn-rigojo", "type": "action", "title": "New project/folder creation from mobile", "brief": {"why": "Currently can only connect to existing folders that have CC session files. No way to start a session in a new project folder from the phone. Need to think carefully — creating arbitrary directories on the server from a phone UI has safety implications (gdn-zamaju: deleteFolder guards).", "what": "1. Repurpose the switcher search box as search-or-create: typing filters existing folders, if no match found offer 'Create folder: <name>' as a tappable option at bottom of results 2. Creating a new folder: mkdir in a safe sandbox area (e.g. ~/Repos/<name>), git init, then connect session to it 3. Guardrails: only create in approved parent directories (~/Repos/), validate folder name (alphanumeric + hyphens), refuse names that collide with existing projects 4. Consider using fun-names.ts as suggestion when user taps create without typing a name", "done": "Typing a non-existent name in the switcher search box offers to create it. New folder is git-initialised and ready for a session. Cannot create outside ~/Repos/."}, "status": "open", "parent": "gdn-situwu", "order": 49, "created_at": "2026-02-23T22:51:46Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T22:59:29Z", "updated_by": "edited"}
{"id": "gdn-rilowe", "type": "action", "title": "Coalesced tool call items can't be tapped open", "brief": {"why": "When consecutive successful tool calls coalesce into a summary, expanding the summary shows inner items (name + input preview). But those items are static divs with no click handler — you can't tap them to see the full input/output. On desktop you rarely need to, but on mobile the previews are truncated and the detail matters.", "what": "1. Pass full tool call data (input + output) through to renderToolSummary — currently only name and input preview reach the DOM 2. Make each tool-summary-item tappable to expand its full input/output (same tool-body pattern as individual tool calls) 3. Add expand/collapse state per inner item 4. Ensure the hit target is the full row, not a tiny element", "done": "Tapping an inner item inside a coalesced summary reveals its full input and output. Each item expands/collapses independently."}, "status": "open", "parent": "gdn-situwu", "order": 64, "created_at": "2026-02-24T06:14:49Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-24T06:24:04Z", "updated_by": "edited"}
{"id": "gdn-rimeti", "type": "action", "title": "Slash menu: sorted, local-first, /exit always present", "brief": {"why": "Once CC spawns and sends slash_commands, the menu replaces LOCAL_SLASH_COMMANDS entirely — /exit and /abort vanish. The CC list is also unsorted, making it hard to scan on a phone. Two separate LOCAL_CMDS definitions (state-builder vs frontend) drift independently.", "what": "1. Merge local commands into CC's list rather than replacing 2. Sort alphabetically within each group (local at top, CC below) 3. Unify the two LOCAL_CMDS definitions so they can't drift 4. Ensure /exit and /abort survive CC spawn", "done": "Slash menu always shows /exit and /abort regardless of CC state. Local commands grouped at top. All commands alpha-sorted within their group. Single source of truth for which commands are local."}, "status": "open", "parent": "gdn-situwu", "order": 58, "created_at": "2026-02-24T06:05:03Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-ritise", "type": "action", "title": "Session replay doesn't show user messages", "brief": {"why": "On reconnect/refresh, the bridge replays buffered CC events but user messages are missing from the replayed conversation. User sees Claude's responses without the prompts that triggered them — disorienting context.", "what": "1. Check what messageBuffer captures — does it include the user prompt events or only CC stdout? 2. If user messages aren't in CC's output stream, bridge needs to buffer them separately when received via WS 3. Verify replay includes interleaved user + assistant messages in correct order", "done": "Page refresh shows full conversation: user messages interleaved with Claude responses in correct order."}, "status": "done", "parent": "gdn-besuse", "order": 4, "created_at": "2026-02-10T08:55:46Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T00:14:58Z"}
{"id": "gdn-rizaje", "type": "action", "title": "Visual smoke test before code archaeology", "brief": {"why": "This session spent significant context reading DialogBase/Dialog/bridge source for the flash bug before ever loading the app in a browser. A 2-minute visual check would have revealed 3 issues (layout, close button, blank messages) instantly. Pattern: eyes before brain.", "what": "1. Add a visual smoke test checklist to CLAUDE.md or docs/: start servers, open browser, check layout, send message, verify bubble appears 2. Make this the first step in any UI-related arc action", "done": "Checklist exists, referenced in CLAUDE.md, next Claude follows it"}, "status": "done", "parent": "gdn-cejaba", "order": 16, "created_at": "2026-02-09T13:35:38Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-09T15:46:40Z"}
{"id": "gdn-ruduzo", "type": "action", "title": "Mobile tab resume reconnects instantly via visibilitychange", "brief": {"why": "No visibilitychange listener. When mobile tab comes back to foreground, WS may be dead but reconnect waits up to 30s for ping timeout. User stares at stale UI.", "what": "1. Add visibilitychange listener in WSTransport 2. On visible: check WS readyState, reconnect immediately if not OPEN 3. Test with fake timers: visibility change triggers immediate reconnect attempt", "done": "Switching back to gueridon tab triggers immediate WS health check and reconnect if needed"}, "status": "done", "parent": "gdn-hatiho", "order": 1, "created_at": "2026-02-09T15:47:05Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add visibilitychange listener in WSTransport", "On visible: check WS readyState, reconnect immediately if not OPEN", "Test with fake timers: visibility change triggers immediate reconnect attempt"], "current": 3}, "done_at": "2026-02-09T22:53:54Z"}
{"id": "gdn-saciva", "type": "action", "title": "Create structured logger subscriber in server/logger.ts", "brief": {"why": "Replace unstructured console.log with machine-parseable JSON lines. Writes to stderr (protecting stdout/SSE stream from corruption). Optional LOG_FILE for persistence.", "what": "New file server/logger.ts. Subscribes to event bus. On each event: 1) check level against LOG_LEVEL env var (debug/info/warn/error, default info), 2) serialize to JSON line {ts, level, type, ...payload}, 3) write to stderr, 4) optionally append to LOG_FILE. Maps event types to levels (e.g. session:spawn→info, init:timeout→error, sse:connect→debug). Exported init function to call at startup.", "done": "logger.ts subscribes and writes JSON lines to stderr. LOG_LEVEL filters correctly. LOG_FILE appends when set. stderr, never stdout."}, "status": "done", "parent": "gdn-wecimo", "order": 3, "created_at": "2026-02-22T17:06:26Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Write logger.ts — subscribe to bus, filter by LOG_LEVEL, write JSON lines to stderr + optional LOG_FILE", "Write logger.test.ts — verify level filtering and output format"], "current": 2, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-22T21:12:08Z", "updated_by": "stepped", "done_at": "2026-02-22T21:12:08Z"}
{"id": "gdn-sahega", "type": "action", "title": "Input bar floats above bottom edge in iOS standalone mode", "brief": {"why": "In iOS standalone (Add to Home Screen) mode, the input bar doesn't sit at the true bottom of the screen — there's a gap beneath it. The previous fix didn't hold.", "what": "1. Reproduce in iOS standalone mode 2. Diagnose what's pushing the input bar up (safe-area-inset-bottom, viewport units, or standalone-specific CSS) 3. Fix positioning so input bar sits flush at bottom 4. Verify in both Safari tab and standalone mode", "done": "Input bar flush with bottom edge in iOS standalone mode. No regression in Safari tab view."}, "status": "open", "parent": "gdn-situwu", "order": 33, "created_at": "2026-02-23T22:24:18Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-24T06:06:59Z", "updated_by": "reopened"}
{"id": "gdn-sanete", "type": "action", "title": "Rethink connection dot — prominent disconnected may replace it", "brief": {"why": "Green 'connected' dot is placed awkwardly on both conversation and lobby screens. With desaturated disconnect state (gdn-loveva) and placeholder status text (gdn-cihuvu), connected state is just 'normal' — the dot confirms the default, which is noise. Switcher dots (green/amber/grey per folder) serve a different purpose and may still be useful.", "what": "1. Remove green connection dot from conversation screen status bar — disconnected state is communicated by desaturation + placeholder 2. Remove global connection dot from switcher header (left of search box) — if the switcher loaded, you're connected 3. Keep per-folder dots in switcher — they show folder/session liveness (green/amber/grey), not connection state 4. Clean up connectionDot CSS and JS state management for both removed dots", "done": "Conversation screen has no connection dot. Disconnected state is communicated through desaturation and placeholder. Switcher folder dots reviewed separately."}, "status": "done", "parent": "gdn-situwu", "order": 52, "created_at": "2026-02-23T22:57:43Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T22:58:45Z", "updated_by": "edited", "done_at": "2026-02-23T23:49:39Z"}
{"id": "gdn-satolu", "type": "action", "title": "Queued messages should stay pinned until ingested into context", "brief": {"why": "When a message is queued (Claude busy), it immediately scrolls into the message flow looking like a normal message. User can't tell when Claude actually ingested it, so subsequent output feels untrustworthy — did Claude see my message or not?", "what": "1. Revive the pending state (currently hardcoded false at line 2165) — message shows as pending until bridge confirms receipt 2. Both pending and queued messages render pinned near input area, not in message flow 3. Transition: pending (dotted, near input) → queued (dashed, near input, bridge has it) → ingested (normal bubble, scrolls into flow) 4. Bridge already returns {queued: true} on 202 — use that as pending→queued transition. Ingested transition needs a new signal (e.g. when CC emits the user event back on stdout)", "done": "Queued message stays visible near input until ingested. User can distinguish 'waiting to be processed' from 'Claude has seen this'. Screenshot: 'pending scrolls up' scenario no longer ambiguous."}, "status": "done", "parent": "gdn-situwu", "order": 31, "created_at": "2026-02-23T22:15:48Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-24T05:34:55Z", "updated_by": "cleared", "done_at": "2026-02-24T05:34:55Z"}
{"id": "gdn-semibe", "type": "action", "title": "Line spacing too wide and gappy in Claude outputs", "brief": {"why": "Mobile screen real estate is precious — gappy line spacing wastes vertical space and makes conversations feel longer than they are", "what": "1. Identify which CSS rules control line-height in assistant message rendering 2. Test tighter spacing (probably 1.4 vs current) 3. Check it doesn't break code blocks or markdown rendering", "done": "Assistant messages have tighter line spacing that feels natural on mobile without cramping code blocks"}, "status": "done", "parent": "gdn-situwu", "order": 1, "created_at": "2026-02-10T08:18:26Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:12:36Z"}
{"id": "gdn-sinefu", "type": "action", "title": "Folder chooser UI with search and session states", "brief": {"why": "User needs to pick a folder before chatting. With tens of repos, a flat list isn't enough — needs search/filter. Each folder shows its session state (active/paused/closed/fresh) so the user knows what they're getting into.", "what": "1. Full-screen chooser shown before chat (replaces empty chat on first load) 2. Scrollable list of folders from bridge API 3. Search/filter input at top (filters as you type) 4. Visual states: green dot (active), amber dot (paused + time ago), handoff purpose line (closed), plain (fresh) 5. 'New folder' option at top with fun auto-generated name 6. Selecting a folder transitions to chat view with CWD in gauge", "done": "Can scroll through 30+ folders, search narrows list instantly, all four states render distinctly, selecting transitions to chat."}, "status": "done", "parent": "gdn-hatiho", "order": 3, "created_at": "2026-02-08T22:12:57Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Full-screen chooser shown before chat (replaces empty chat on first load)", "Scrollable list of folders from bridge API", "Search/filter input at top (filters as you type)", "Visual states: green dot (active), amber dot (paused + time ago), handoff purpose line (closed), plain (fresh)", "'New folder' option at top with fun auto-generated name", "Selecting a folder transitions to chat view with CWD in gauge"], "current": 6}, "done_at": "2026-02-09T07:34:12Z"}
{"id": "gdn-sirila", "type": "action", "title": "Fix test-bridge.ts Test 7 — listFolders in session mode", "brief": {"why": "Test 7 expects listFolders in session mode to return error, but bridge now allows it (returns folderList). Test has been broken since the session-mode listFolders change.", "what": "1. Update Test 7 to expect folderList response instead of error 2. Verify with npm run bridge + npx tsx scripts/test-bridge.ts", "done": "Test 7 passes with the current bridge behaviour"}, "status": "done", "parent": "gdn-besuse", "order": 7, "created_at": "2026-02-10T05:47:12Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T20:57:23Z"}
{"id": "gdn-situwu", "type": "outcome", "title": "Mobile UX is polished and bug-free", "brief": {"why": "If output isn't comfortable to read on a phone, the whole app fails regardless of how solid the bridge is.", "what": "1. Fix line spacing 2. Collapse tool blocks and fix scroll capture 3. Batch streaming renders 4. Auto-scroll on resume and new messages 5. Jump-to-top/bottom controls 6. Fix pull-to-refresh empty content 7. Investigate Safari Reader Mode", "done": "Claude output reads naturally on mobile — spacing, scroll, tool blocks all feel native."}, "status": "open", "order": 11, "created_at": "2026-02-10T20:11:40Z", "created_by": "spm1001", "updated_at": "2026-02-21T22:26:55Z", "updated_by": "edited"}
{"id": "gdn-sohadi", "type": "action", "title": "Scaffold project and wire up pi-web-ui", "brief": {"why": "Need working build pipeline before writing adapter code. pi-web-ui packages are on npm, need Vite bundler with Tailwind.", "what": "1. npm init with type:module 2. Install pi-web-ui, pi-agent-core, pi-ai, mini-lit, lit 3. Vite config with Tailwind plugin 4. Minimal index.html + main.ts loading AgentInterface 5. Verify components render", "done": "npm run dev serves a page with pi-web-ui chat interface visible (even if non-functional)"}, "status": "done", "parent": "gdn-cejaba", "order": 4, "created_at": "2026-02-08T10:31:56Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["npm init with type:module", "Install pi-web-ui, pi-agent-core, pi-ai, mini-lit, lit", "Vite config with Tailwind plugin", "Minimal index.html + main.ts loading AgentInterface", "Verify components render"], "current": 5}, "done_at": "2026-02-08T11:10:17Z"}
{"id": "gdn-sosodo", "type": "action", "title": "Move vendor drift section from claude-config to claude-suite", "brief": {"why": "update-all.sh section 7 (vendor drift detection) only exists in ~/.claude/scripts/update-all.sh (claude-config). It's not in claude-suite's scripts/ directory. Reinstalling from claude-suite would lose it.", "what": "1. Move the vendor drift section to claude-suite/scripts/update-all.sh 2. Ensure symlink picks it up 3. Verify drift detection still works after move", "done": "Vendor drift section exists in claude-suite source repo. Fresh install via claude-suite gets it."}, "status": "done", "parent": "gdn-cejaba", "order": 20, "created_at": "2026-02-09T21:05:42Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:59:40Z"}
{"id": "gdn-suhape", "type": "action", "title": "Page scrolls horizontally in Safari — lock to vertical only", "brief": {"why": "In Safari (not standalone/web app mode), wide content like code blocks allows the entire page to scroll horizontally. Content clips on both sides.", "what": "1. Add overflow-x: hidden to html or body 2. Ensure code blocks still scroll within their own container (pre overflow-x: auto is fine if parent clips)", "done": "Cannot scroll the page horizontally in Safari. Code blocks scroll within their own container."}, "status": "done", "parent": "gdn-situwu", "order": 43, "created_at": "2026-02-23T22:36:52Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T22:36:57Z"}
{"id": "gdn-susuna", "type": "action", "title": "Repeatable mobile test workflow", "brief": {"why": "Every session wastes time rediscovering how to connect Chrome Debug + webctl to the dev server. Without a reliable test recipe, UI fixes and resilience work are blind. This is the foundation — everything else is faster with eyes open.", "what": "1. Document the test recipe (chrome-debug, npm run dev, npm run bridge, webctl start, navigate) 2. Test the recipe works end-to-end from a fresh state 3. Verify core paths on real mobile: fresh load → folder select → chat, mid-session folder switch, phone lock/unlock 4. Write a scripts/test-mobile.sh or npm script that launches everything needed", "done": "A Claude session can reliably open guéridon in Chrome Debug, interact with it via webctl, and take screenshots — without rediscovering the tooling each time."}, "status": "done", "parent": "gdn-cejaba", "order": 1, "created_at": "2026-02-09T17:11:05Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Document the test recipe (chrome-debug, npm run dev, npm run bridge, webctl start, navigate)", "Test the recipe works end-to-end from a fresh state", "Verify core paths on real mobile: fresh load → folder select → chat, mid-session folder switch, phone lock/unlock", "Write a scripts/test-mobile.sh or npm script that launches everything needed"], "current": 4}, "done_at": "2026-02-09T21:25:47Z"}
{"id": "gdn-suvuka", "type": "action", "title": "Slash menu inserts command name without the leading /", "brief": {"why": "Tapping a slash command from the sheet puts 'compact' in the input box, not '/compact'. CC expects the slash prefix to recognise it as a command.", "what": "1. Line 2257: change ta.value = cmd.name to ta.value = '/' + cmd.name", "done": "Tapping a slash menu item inserts '/commandname' in the input box."}, "status": "done", "parent": "gdn-situwu", "order": 39, "created_at": "2026-02-23T22:34:38Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:02:32Z"}
{"id": "gdn-takubi", "type": "action", "title": "Handoffs don't exist on kube — no session history context", "brief": {"why": "Handoffs are stored locally at ~/.claude/handoffs/ on the Mac. Bridge on kube has no access to them, so the beautiful session resume context (Done/Next/Gotchas) is missing. This breaks the session continuity promise.", "what": "1. Think through options: sync handoffs to kube? Store handoffs server-side? Make bridge write handoffs? 2. Design approach that works for multi-device (Mac + kube + future) 3. Implement chosen approach", "done": "CC sessions on kube have access to handoff context from previous sessions regardless of which machine created them"}, "status": "done", "parent": "gdn-hatiho", "order": 11, "created_at": "2026-02-10T08:18:49Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:59:37Z"}
{"id": "gdn-taleta", "type": "action", "title": "Context gauge unit tests", "brief": {"why": "context-gauge.ts has clean public API (update, setCwd, notifyCompaction, renderStats) and colour threshold logic that's never been verified.", "what": "1. Create src/context-gauge.test.ts with jsdom environment 2. Test colour thresholds (green >20%, amber 10-20%, red <10%) 3. Test CWD shortening (full path → folder name) 4. Test notifyCompaction toast timing with fake timers 5. Test renderStats returns valid Lit templates", "done": "All tests pass. Colour bands verified. Compaction toast appears and auto-dismisses."}, "status": "done", "parent": "gdn-vevoca", "order": 4, "created_at": "2026-02-09T06:39:04Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-09T09:41:27Z"}
{"id": "gdn-tawica", "type": "action", "title": "Investigate working directory bug in CC child process spawning", "brief": {"why": "Diagnosed: the ?session= reconnect path creates sessions with folder:null. When CC needs spawning on such a session, spawnCC gets no cwd and CC inherits the bridge's working directory. Observed in kube logs — legacy reconnects after DERP disconnects hit this path. Root cause is the dual connection path, not spawnCC itself.", "what": "Investigation complete. Root cause: ?session= sets folder:null on session creation (bridge.ts line 699). Fix filed as gdn-nicaju (remove ?session= path entirely). No separate fix needed — nicaju eliminates the code path that causes this.", "done": "Root cause identified and fix filed as gdn-nicaju."}, "status": "done", "parent": "gdn-besuse", "order": 1, "created_at": "2026-02-10T13:56:22Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T20:48:08Z"}
{"id": "gdn-tazomi", "type": "outcome", "title": "Session interface decomposed into composable concerns", "brief": {"why": "Session object has grown to 16 fields spanning idle guards, conflation, turn tracking, queueing, diagnostics, and context — one mutation needs to reset half the fields, easy to forget one", "what": "1. Audit Session interface — map each field to its concern (idle, conflation, turn, queue, diagnostics, context)\n2. Define sub-interfaces: SessionIdle {start, timer, guardWasDeferred}, SessionConflation {pendingDeltas, flushTimer}, SessionTurn {inProgress, hadContent, lastOutput, contextPct}, SessionQueue {promptQueue}\n3. Add reset functions: resetIdle(session), resetConflation(session), resetTurn(session) — each resets only its own fields\n4. Update wireProcessToSession to use concern-specific resets instead of scattered field assignments\n5. Update process exit/error handlers — currently reset turnInProgress, promptQueue, _hadContentThisTurn individually; replace with resetTurn() + resetQueue()\n6. Update createSession factory — compose sub-objects instead of 16 flat fields\n7. Verify idle guards still work — checkIdle reads turnInProgress and lastOutputTime which move into session.turn\n8. Verify conflation still works — isStreamDelta/extractDeltaInfo read pendingDeltas which moves into session.conflation\n9. Run full test suite (npx vitest run) — existing 423 tests must pass\n10. Update getActiveSessions in bridge-logic.ts — SessionProcessInfo needs to read from sub-objects", "done": "Session interface uses composable sub-objects, each with own reset — no more scattered field resets"}, "status": "done", "order": 1, "created_at": "2026-02-18T12:26:26Z", "created_by": "spm1001", "updated_at": "2026-02-18T12:27:58Z", "done_at": "2026-02-21T22:26:50Z"}
{"id": "gdn-tehuhu", "type": "action", "title": "Push permission denied has no UX indication", "brief": {"why": "If user denies notification permission on first send tap, there's no visual indicator that notifications are disabled and no in-app way to re-enable. User wonders why they never get push notifications.", "what": "1. After permission denied, show subtle indicator near status bar 2. Tapping indicator explains how to re-enable in Settings 3. Don't nag — show once per session", "done": "Deny notification permission, see indicator in status bar. Tap it, see instructions."}, "status": "done", "parent": "gdn-situwu", "order": 27, "created_at": "2026-02-21T21:48:04Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T22:27:00Z", "updated_by": "edited", "done_at": "2026-02-23T23:53:00Z"}
{"id": "gdn-telune", "type": "action", "title": "Concurrent Claude sessions editing same files need coordination", "brief": {"why": "Two parallel CC sessions (tmux + Gueridon, or two Gueridon tabs) can edit the same file simultaneously. The /close from one session overwrote CLAUDE.md changes from the other. No locking, no merge, last-write-wins.", "what": "1. Investigate scope — how often does this happen in practice? 2. Consider file-level advisory locks or git-based conflict detection 3. At minimum, warn in CLAUDE.md that parallel sessions are unsafe for shared files", "done": "Concurrent sessions either coordinate edits or clearly warn when conflicts occur"}, "status": "done", "parent": "gdn-zewumo", "order": 13, "created_at": "2026-02-16T10:57:11Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T21:47:06Z", "updated_by": "edited", "done_at": "2026-02-23T20:54:50Z"}
{"id": "gdn-tetini", "type": "action", "title": "Page refresh doesn't lose the conversation", "brief": {"why": "No client-side message persistence. Mobile tabs get killed by OS — user loses entire conversation on refresh. Biggest UX gap for mobile use.", "what": "Bridge buffer + auto-reconnect (plan: ~/.claude/plans/goofy-mapping-owl.md). 1. Bridge: messageBuffer on Session, buffer CC events inline in wireProcessToSession (serialize once), replay in attachWsToSession with historyStart/historyEnd markers (synchronous — no readline interleave) 2. Adapter: startReplay()/endReplay() with emit suppression + callback guards (onAskUser, onCwdChange, onCompaction). endReplay emits message_update if mid-stream then agent_start for sync 3. Transport: historyStart/historyEnd callbacks in WSTransportOptions 4. Folder lifecycle: auto_connect event (idle→connecting, skips dialog), store_folder/clear_stored_folder effects 5. Main.ts: localStorage helpers, auto-connect dispatch on lobby_entered, wire history callbacks + new effect handlers 6. Tests alongside each step 7. Visual verification", "done": "Refreshing the page (or mobile tab kill/restore) shows previous conversation messages"}, "status": "done", "parent": "gdn-hatiho", "order": 2, "created_at": "2026-02-09T15:47:01Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Bridge: add messageBuffer to Session, buffer CC events in wireProcessToSession, replay in attachWsToSession with historyStart/End markers", "Adapter: add startReplay/endReplay with emit suppression and callback guards", "Transport: add historyStart/historyEnd callbacks in WSTransport", "Folder lifecycle: add auto_connect event, store_folder/clear_stored_folder effects", "Main.ts: localStorage helpers, auto-connect on lobby_entered, wire history callbacks and new effects", "Tests: folder-lifecycle, ws-transport, claude-code-agent replay mode", "Visual verification: refresh page mid-conversation, messages reappear"], "current": 7}, "done_at": "2026-02-09T23:20:13Z"}
{"id": "gdn-tetupa", "type": "action", "title": "Create event bus module using diagnostics_channel in server/event-bus.ts", "brief": {"why": "Decouples event production from consumption. Business logic emits events, subscribers (logger, buffer, future metrics) consume independently. diagnostics_channel is built into Node — no deps.", "what": "New file server/event-bus.ts. Thin wrapper: emit(event: BridgeEvent) publishes to a named channel. subscribe(cb: (event: BridgeEvent) => void) registers a listener. Channel name constant exported. No conditional logic — just the plumbing.", "done": "event-bus.ts exports emit() and subscribe(). A test proves emit→subscribe round-trips a typed event."}, "status": "done", "parent": "gdn-wecimo", "order": 2, "created_at": "2026-02-22T17:06:19Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Write event-bus.ts with emit() and subscribe() over diagnostics_channel", "Write event-bus.test.ts proving round-trip"], "current": 2, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-22T21:11:24Z", "updated_by": "stepped", "done_at": "2026-02-22T21:11:24Z"}
{"id": "gdn-teweta", "type": "action", "title": "Add missing event emissions for currently-silent operations", "brief": {"why": "Several important operations happen silently: SSE client connect/disconnect, grace timer lifecycle, body-too-large rejections, session resolution outcome (fresh vs resume), prompt queue operations.", "what": "Add emit() calls at: 1) SSE client connect (line ~218) and disconnect (line ~243), 2) grace timer start and expiry, 3) body-too-large rejection (line ~625), 4) session resolution outcome in resolveOrCreateSession, 5) prompt queue add/flush.", "done": "All five categories emit typed events. Debug-level logging shows the full session lifecycle from SSE connect through prompt delivery to disconnect."}, "status": "done", "parent": "gdn-wecimo", "order": 8, "created_at": "2026-02-22T17:28:08Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add SSE connect/disconnect events in setupSSE and res.on close", "Add grace timer start/expire events in detachFromSession", "Add session:resolve event in resolveOrCreateSession", "Add request:rejected for body-too-large and prompt queue"], "current": 4, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-23T06:33:50Z", "updated_by": "stepped", "done_at": "2026-02-23T06:33:50Z"}
{"id": "gdn-tezima", "type": "action", "title": "Add bridge test for content-array prompts through handleSessionMessage", "brief": {"why": "The isExitCommand crash only happened because no test exercised a prompt with content array (no text field) through the full session message handler. bridge-logic tests cover isUserTextEcho but not the prompt dispatch path.", "what": "1. Add test: content-array prompt passes through isExitCommand without crash 2. Add test: content-array prompt reaches writeToStdin with correct envelope 3. Add test: content-array prompt is buffered for replay", "done": "Three tests covering content-array prompts in handleSessionMessage. isExitCommand guard tested explicitly."}, "status": "done", "parent": "gdn-besuse", "order": 14, "created_at": "2026-02-12T08:06:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T20:26:05Z"}
{"id": "gdn-ticiga", "type": "action", "title": "Markdown rendering in user messages", "brief": {"why": "User messages render as plain text (textContent) while assistant messages get full markdown (md()). On mobile, backtick-wrapped code, URLs, and bold/italic are common even in short messages. Plain text makes these unreadable — backticks show literally, URLs aren't tappable, emphasis is invisible.", "what": "1. Apply inline markdown to user messages: backtick code spans, bold, italic, strikethrough, and auto-linked URLs 2. Do NOT apply block-level markdown (headers, code blocks, tables, lists) — user bubbles are compact and block formatting would look broken 3. Use innerHTML with the inline() sub-function from md(), not the full md() parser 4. Ensure esc() runs first (XSS prevention — user input goes through innerHTML) 5. Verify queued/pending message states still render correctly with innerHTML", "done": "Backtick code in user messages renders as inline code spans. URLs are tappable links. Bold/italic/strikethrough render. No XSS vectors. Block-level markdown ignored. Queued/pending states unaffected."}, "status": "open", "parent": "gdn-situwu", "order": 66, "created_at": "2026-02-24T06:49:04Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-tiloze", "type": "action", "title": "Wire event bus into push.ts and folders.ts — replace console calls", "brief": {"why": "Same cleanup as bridge.ts but smaller scope (~10 call sites across two files). Completes the console.log removal.", "what": "Replace all console.log/error/warn in push.ts and folders.ts with typed emit() calls. push.ts covers VAPID init, subscription add/remove, send failures. folders.ts covers scan errors.", "done": "Zero console.log/error/warn in push.ts and folders.ts. All former log sites emit typed events."}, "status": "done", "parent": "gdn-wecimo", "order": 6, "created_at": "2026-02-22T17:27:52Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Replace console calls in push.ts with emit()", "Replace console calls in folders.ts with emit()"], "current": 2, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-22T21:23:08Z", "updated_by": "stepped", "done_at": "2026-02-22T21:23:08Z"}
{"id": "gdn-tivati", "type": "action", "title": "Session switcher: tap-to-dismiss broken, swipe-down triggers pull-to-refresh", "brief": {"why": "Bottom sheet can't be dismissed naturally. Three issues: (1) Tapping scrim triggers iOS double-tap-to-zoom instead of click handler — needs touch-action: manipulation. (2) 'Empty' area below list items is actually the 82vh switcher (z-index 100), not the backdrop (z-index 99). (3) Pulling down triggers iOS pull-to-refresh instead of swipe-to-dismiss.", "what": "1. Add click handler on the switcher's own empty space (below list items) to dismiss — or shrink sheet to content height 2. Add overscroll-behavior: none on the switcher to prevent pull-to-refresh hijacking 3. Add swipe-down-to-dismiss touch handler on the sheet handle/body (translateY tracking) 4. Remove X button once natural dismissal works", "done": "Tapping above sheet OR in empty space below list dismisses. Swiping down on sheet dismisses. No pull-to-refresh interference. X button gone."}, "status": "done", "parent": "gdn-situwu", "order": 34, "created_at": "2026-02-23T22:26:31Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T22:26:47Z", "updated_by": "edited", "done_at": "2026-02-23T23:49:39Z"}
{"id": "gdn-togeca", "type": "action", "title": "Context fuel gauge component", "brief": {"why": "Mobile sessions run long without visibility. The adapter already tracks context usage from CC result events — need to surface it as a glanceable UI element.", "what": "1. Thin progress bar component using context % from adapter 2. Color thresholds: green default, yellow >70%, red >90% 3. Compaction detection (input_tokens drop) with notification 4. Position near input area for mobile visibility", "done": "Context bar visible in UI, updates after each turn, color changes at thresholds, compaction notified"}, "status": "done", "parent": "gdn-cejaba", "order": 9, "created_at": "2026-02-08T17:55:10Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Thin progress bar component using context % from adapter", "Color thresholds: green default, yellow >70%, red >90%", "Compaction detection (input_tokens drop) with notification", "Position near input area for mobile visibility"], "current": 4}, "done_at": "2026-02-08T19:55:05Z"}
{"id": "gdn-topupe", "type": "action", "title": "Remove model indicator from mobile status bar", "brief": {"why": "Model name (claude-opus-4-6) takes scarce horizontal space on mobile. User doesn't need to see it every time — the model rarely changes mid-session.", "what": "1. Remove or hide the model span from the status bar 2. Consider showing model only on session connect (as a brief toast or in switcher metadata)", "done": "Status bar has more breathing room. Model info available somewhere but not competing with context % and folder name."}, "status": "open", "parent": "gdn-situwu", "order": 55, "created_at": "2026-02-24T05:58:59Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-toputi", "type": "action", "title": "Emit turn metrics on turn completion", "brief": {"why": "Per-turn performance data is the most useful single thing for understanding what Claude is doing. Currently no metrics are tracked.", "what": "In onTurnComplete callback in bridge.ts, emit a turn:complete event with: folder, turn duration (ms, from prompt delivery to completion), input tokens, output tokens, context%, tool call count. Record prompt delivery timestamp when prompt is sent.", "done": "Every turn completion emits a turn:complete event with duration, token counts, context%, and tool count. Visible in /status buffer and log output."}, "status": "done", "parent": "gdn-wecimo", "order": 7, "created_at": "2026-02-22T17:28:00Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add turnStartedAt timestamp to Session and set it in deliverPrompt", "Emit turn:complete event in onTurnComplete with duration, tokens, context%, tool count"], "current": 2, "session": "/home/modha/Repos/gueridon"}, "updated_at": "2026-02-22T21:38:52Z", "updated_by": "stepped", "done_at": "2026-02-22T21:38:52Z"}
{"id": "gdn-vadona", "type": "action", "title": "Trim MEMORY.md to 200 lines and update with JSONL history feature", "brief": {"why": "MEMORY.md is 230 lines (over 200-line limit), missing JSONL history feature, 285 test count, and worktree lesson", "what": "1. Trim stale content 2. Add gdn-keduci summary 3. Update test count to 285 4. Add worktree lesson to Design Lessons", "done": "MEMORY.md under 200 lines, new features documented"}, "status": "done", "parent": "gdn-cejaba", "order": 24, "created_at": "2026-02-10T05:47:12Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T07:48:03Z"}
{"id": "gdn-vafifi", "type": "action", "title": "Forward command list to clients via bridge protocol", "brief": {"why": "Client needs to know what commands exist and their categories for future autocomplete and help. The bridge has the registry — needs to send it to connected clients.", "what": "1. Add BridgeCommandList message type to bridge protocol 2. Broadcast commandList to all session clients when registry first built 3. In ws-transport.ts add onCommandList callback and handle the new message type 4. In claude-code-agent.ts store command list and expose via getter 5. In main.ts wire the callback", "done": "Client receives commandList message after session connect, adapter exposes commands property, ws-transport test covers new message type"}, "status": "done", "parent": "gdn-dicire", "order": 3, "created_at": "2026-02-12T06:58:21Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-21T22:30:30Z"}
{"id": "gdn-vahahi", "type": "action", "title": "Input bar buttons crowd text on multi-line messages", "brief": {"why": "Slash button and send button sit beside the textarea. When text wraps to 2+ lines, buttons compress the text area width. On mobile the squeeze makes editing painful.", "what": "1. Keep buttons inline on single-line input 2. On 2+ lines, move buttons to a row below the textarea (or let textarea span full width with buttons at the edges of a second row) 3. Test with iOS keyboard visible — safe-area must still work", "done": "Multi-line input has full width. Buttons don't compress text. Single-line stays compact."}, "status": "open", "parent": "gdn-situwu", "order": 56, "created_at": "2026-02-24T05:59:08Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-vahazu", "type": "outcome", "title": "Active sessions survive bridge restarts", "brief": {"why": "Bridge crash or systemd restart kills all active CC subprocesses. User loses in-flight work with no recovery path. claude-go solved this with tmux (processes survive parent death) and KillMode=process in systemd.", "what": "1. On bridge start, scan for orphaned CC processes (by session-id convention or PID file) 2. Reconnect stdout/stdin to orphaned processes OR use --resume to start fresh with conversation intact 3. Persist message buffer to disk so replay works after restart 4. Add KillMode=process (or equivalent) to systemd service so CC children survive restarts", "done": "systemctl restart gueridon does not kill active CC sessions. Bridge reconnects to in-flight sessions within 10 seconds. Message buffer replays correctly on client reconnect."}, "status": "done", "order": 9, "created_at": "2026-02-10T08:52:17Z", "created_by": "spm1001", "done_at": "2026-02-10T20:12:07Z"}
{"id": "gdn-vesefi", "type": "action", "title": "serveStatic has real logic but no tests", "brief": {"why": "Static file serving has path traversal guard, SPA fallback, MIME lookup, cache headers — all untested. Same extraction pattern as bridge-logic.ts proved valuable.", "what": "1. Extract serveStatic + MIME map into bridge-logic.ts (or new static-serving.ts) 2. Unit test: path traversal blocked, SPA fallback, MIME types, cache headers on /assets/, 404 for missing files", "done": "serveStatic logic has unit tests, bridge.ts imports the extracted function"}, "status": "done", "parent": "gdn-cejaba", "order": 27, "created_at": "2026-02-10T06:20:27Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Extract serveStatic + MIME map into bridge-logic.ts (or new static-serving.ts)", "Unit test: path traversal blocked, SPA fallback, MIME types, cache headers on /assets/, 404 for missing files"], "current": 2}, "done_at": "2026-02-10T07:56:53Z"}
{"id": "gdn-vevoca", "type": "outcome", "title": "Automated test coverage for guéridon", "brief": {"why": "Zero test framework, zero automated tests. The adapter (most protocol-sensitive code) has no tests. As bridge refactor and folder chooser add complexity, regressions will compound silently.", "what": "Vitest framework setup, adapter unit tests (from verified JSONL fixtures), folder scan tests (mocked fs), transport tests (mock WebSocket), gauge tests, eventually bridge SessionManager extraction", "done": "npm test runs vitest. Adapter and folder scan have >80% coverage. CI-ready (no manual steps, no running servers needed)."}, "status": "done", "order": 5, "created_at": "2026-02-09T06:38:30Z", "created_by": "spm1001", "done_at": "2026-02-09T09:55:27Z"}
{"id": "gdn-vibemo", "type": "action", "title": "Tapping push notification deep-links to the notifying folder", "brief": {"why": "Currently tapping a notification opens the app but doesn't navigate to the folder that sent it. User has to manually find and tap the right folder. Breaks the 'phone in pocket' workflow.", "what": "1. Include folder path in push notification payload 2. Service worker notificationclick reads folder from data and navigates to it 3. If app is already open, switch to that folder without full reload", "done": "Tap notification → app opens with that folder's conversation visible, not the lobby or a different folder"}, "status": "done", "parent": "gdn-situwu", "order": 26, "created_at": "2026-02-16T08:24:29Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T22:27:00Z", "updated_by": "edited", "done_at": "2026-02-24T05:13:15Z"}
{"id": "gdn-vigifo", "type": "action", "title": "Permission denial detection and mobile UI card", "brief": {"why": "Phase 1 (gdn-fuhepu) replaces the flag but unlisted Bash commands hang the persistent stdin process. Phase 2 detects the hang (tool_use with no tool_result within N seconds), kills the process, surfaces the denied tool as a tappable permission card on mobile. Completes the approval loop.", "what": "1. Detect permission hang: monitor for tool_use event followed by no tool_result within timeout 2. On hang detection: extract tool name and input, kill CC process 3. Bridge sends permissionDenied protocol message to clients 4. Client renders permission card (amber banner, tool summary, Allow/Deny buttons) 5. On Allow: bridge adds tool to session extraAllowedTools, respawns CC with --resume and expanded --allowed-tools 6. On Deny: dismiss card, send synthetic message telling CC the tool was denied", "done": "Bash command outside settings.json patterns triggers permission card on mobile. Tapping Allow restarts CC with tool approved. Full loop works end-to-end."}, "status": "open", "parent": "gdn-zewumo", "order": 12, "created_at": "2026-02-16T18:54:04Z", "created_by": "spm1001", "waiting_for": "Requires upstream subagent permission propagation (CC #20264); permissive --allowed-tools makes hang detection moot", "updated_at": "2026-02-23T21:18:45Z", "updated_by": "waited"}
{"id": "gdn-vipebi", "type": "action", "title": "Toast is too generic for mobile error feedback", "brief": {"why": "showToast is the only user feedback mechanism — used for both context compaction notifications and errors. A single transient pill at the bottom isn't enough when errors need different treatment (persistent, actionable, severity-colored). As abort controls and connection error handling improve, the feedback surface needs to grow.", "what": "1. Audit current toast usage (compaction, show_error effect). 2. Design error UX appropriate for mobile — persistent banners for connection issues, transient toasts for info, actionable errors with retry/dismiss. 3. Implement.", "done": "Errors and info notifications are visually distinct. Connection errors persist until resolved. User can act on errors (retry, dismiss)."}, "status": "done", "parent": "gdn-situwu", "order": 8, "created_at": "2026-02-11T13:57:07Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T20:20:48Z"}
{"id": "gdn-vipita", "type": "action", "title": "Tap anywhere in message area gives input focus", "brief": {"why": "Currently must tap precisely on the textarea to focus — easy to miss on mobile", "what": "1. Add click handler on message area that focuses textarea 2. Don't steal focus if user is selecting text", "done": "Tapping empty space in conversation area focuses the input"}, "status": "done", "parent": "gdn-situwu", "order": 11, "created_at": "2026-02-15T19:30:54Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T19:46:10Z"}
{"id": "gdn-vosejo", "type": "action", "title": "prompt() guards against null transport", "brief": {"why": "If transport is null when prompt() called, user message is added to state and streaming set to true, but message silently dropped. UI stuck in streaming state forever.", "what": "1. Guard prompt() — if no transport, show error toast and return early without setting streaming=true 2. Add test case in claude-code-agent.test.ts", "done": "Calling prompt() without transport shows error to user, does not enter streaming state"}, "status": "done", "parent": "gdn-cejaba", "order": 18, "created_at": "2026-02-09T15:46:54Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Guard prompt() — return early with error if no transport", "Add test case"], "current": 2}, "done_at": "2026-02-09T16:16:49Z"}
{"id": "gdn-vubegi", "type": "action", "title": "Duplicate messages and tool blocks in stream", "brief": {"why": "On session resume, CC replays history on stdout while bridge already replayed from JSONL — adapter processes both, doubling every assistant message and tool block", "what": "1. Add seen-message-ID Set to adapter 2. Skip duplicates in handleAssistantComplete using CC message.id 3. Test with resumed session", "done": "Resume a session — each message appears exactly once"}, "status": "done", "parent": "gdn-besuse", "order": 15, "created_at": "2026-02-16T07:06:03Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-16T07:14:36Z", "done_at": "2026-02-16T07:14:36Z"}
{"id": "gdn-vupiso", "type": "action", "title": "Review deferred items after test workflow and UI are solid", "brief": {"why": "5 items deferred with 'revisit when core flow is solid' — artifacts, deterministic IDs, close trigger, adapter helpers, bridge extraction. Solid is subjective. Need a concrete trigger.", "what": "After gdn-susuna (test workflow) and gdn-murimo (UI trim) are done: review all waiting items. Unwait what's now relevant, close what's obsolete.", "done": "All 5 deferred items have been reviewed: each is either unwaited, closed, or has a refreshed waiting reason."}, "status": "done", "parent": "gdn-cejaba", "order": 21, "created_at": "2026-02-09T21:05:49Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:59:47Z"}
{"id": "gdn-walaco", "type": "action", "title": "Agent state resets cleanly on folder switch", "brief": {"why": "Singleton ClaudeCodeAgent accumulates messages, toolCallNames, context tokens across folder changes. Old session messages render in new session.", "what": "1. Add reset() method to ClaudeCodeAgent that clears messages, toolCallNames, askUserToolCallIds, usage, state 2. Call reset() in main.ts connectFolder callback before starting new session 3. Test: switch folders, verify no stale messages or token counts", "done": "Switching folders shows clean slate — no messages, no stale gauge, no accumulated tool state from previous session"}, "status": "done", "parent": "gdn-cejaba", "order": 17, "created_at": "2026-02-09T15:46:51Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add reset() method to ClaudeCodeAgent", "Call reset() in main.ts connectFolder callback", "Add tests for reset()", "Verify no stale state after folder switch"], "current": 4}, "done_at": "2026-02-09T16:16:12Z"}
{"id": "gdn-wawoko", "type": "action", "title": "Investigate Safari Reader Mode disappearing", "brief": {"why": "Safari Reader Mode was working at some point but has since disappeared. Title change (gdn-rawira) was a partial fix for stale content, but the bigger issue is Reader Mode not being available at all. May be related to SPA structure, meta tags, or content detection heuristics.", "what": "1. Research Safari Reader Mode availability heuristics (article tag, content length, meta tags) 2. Check if our Lit/SPA structure prevents Reader Mode detection 3. Add appropriate semantic HTML or meta tags to restore Reader Mode availability", "done": "Safari Reader Mode icon appears and shows current session content"}, "status": "done", "parent": "gdn-situwu", "order": 15, "created_at": "2026-02-15T20:29:46Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:41:13Z"}
{"id": "gdn-wecimo", "type": "outcome", "title": "Bridge has structured observability — logs, metrics, and debug endpoint", "brief": {"why": "Server logs via scattered console.log to stdout (a socket), with no levels, no structured format, no persistence, and no metrics. Debugging requires reading source. On mobile, client errors vanish — no devtools.", "what": "Event bus (diagnostics_channel), structured logger subscriber, circular buffer subscriber, /status endpoint, client error reporting, turn metrics", "done": "All console.log/error/warn replaced with typed event emissions. Logger writes JSON lines to stderr + optional LOG_FILE. /status returns live session and recent log data. Client errors POST back to server. Turn metrics (duration, tokens, context%, tools) emitted on completion. All existing tests pass."}, "status": "done", "order": 25, "created_at": "2026-02-22T17:06:04Z", "created_by": "spm1001", "done_at": "2026-02-23T20:48:08Z"}
{"id": "gdn-wefuto", "type": "outcome", "title": "Local command output renders in the UI", "brief": {"why": "/context and other local commands execute correctly but output never appears on screen — the event reaches state but not the renderer", "what": "1. Add console.log tracing in adapter and GueridonInterface 2. Check message-list rendering path for non-streamed messages 3. Fix the missing message_start lifecycle gap 4. Verify /context output displays", "done": "/context output visible in the UI after execution"}, "status": "done", "order": 18, "created_at": "2026-02-15T15:05:35Z", "created_by": "spm1001", "done_at": "2026-02-21T22:26:50Z"}
{"id": "gdn-weletu", "type": "action", "title": "Connecting and switching can fail gracefully", "brief": {"why": "Two stuck-forever states: connecting (retry loop with no limit) and switching (waits for lobby_entered that may never come). Bridge errors and processExit during connecting don't reach the state machine. No timeout. User is trapped with no escape. See docs/lifecycle-map.md for the full analysis.", "what": "1. Add retry counter to connecting phase (max 3) 2. Add timeout to connecting and switching phases (30s) 3. Wire bridge errors and processExit into state machine as connection_failed event 4. On failure: transition to browsing with error explanation 5. Test all failure paths", "done": "Connecting to a broken folder shows an error and returns to folder picker within 30s. Switching to a folder when bridge is down does the same. No infinite loops, no stuck states."}, "status": "done", "parent": "gdn-cejaba", "order": 3, "created_at": "2026-02-09T17:10:56Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add retry counter to connecting phase (max", "2. Add timeout to connecting and switching phases (30s)", "Wire bridge errors and processExit into state machine as connection_failed event", "On failure: transition to browsing with error explanation", "Test all failure paths"], "current": 5}, "done_at": "2026-02-09T21:47:56Z"}
{"id": "gdn-werohe", "type": "action", "title": "Tool calls: restore row shapes, remove oversized chevron", "brief": {"why": "Last session stripped tool calls to borderless inline log lines with a scale(3) chevron. The chevron looks like a tiny tap target you have to hit precisely, but the whole row is clickable. Visual affordance is on the wrong element — should be on the row shape, not the chevron.", "what": "1. Add background/border back to tool-call and tool-summary rows (subtle, not the old chunky cards) 2. Remove the scale(3) chevron treatment — use a normal-sized indicator or let the row shape itself signal expandability 3. Ensure the tap-target affordance reads as the full row, not a small icon", "done": "Tool call rows have visible shapes (background or border). No lozenge or oversized chevron. Tapping anywhere on the row expands — and the visual design makes that obvious."}, "status": "open", "parent": "gdn-situwu", "order": 60, "created_at": "2026-02-24T06:08:41Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-24T06:23:56Z", "updated_by": "edited"}
{"id": "gdn-wezoji", "type": "action", "title": "Test swipe-to-delete gesture and handleDeleteFolder", "brief": {"why": "Swipe-to-delete shipped with no test coverage. The touch gesture in folder-selector.ts and handleDeleteFolder in bridge.ts (including rm -rf path validation) are untested.", "what": "1. Unit test: handleDeleteFolder validates path against SCAN_ROOT 2. Unit test: handleDeleteFolder destroys active session before deleting 3. UI test: swipe gesture state transitions (touch start → move → end → confirm)", "done": "Bridge deletion handler and folder selector swipe have test coverage. Path validation tested explicitly."}, "status": "done", "parent": "gdn-situwu", "order": 24, "created_at": "2026-02-15T20:29:38Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T22:27:00Z", "updated_by": "edited", "done_at": "2026-02-24T05:11:47Z"}
{"id": "gdn-wicazo", "type": "action", "title": "Context burns fast on kube — skill loading + resume history", "brief": {"why": "Remote Claude sessions via Gueridon run out of context quickly. Two factors: (1) skill loading (arc=15K, open=10K) injects ~25KB into every session, (2) resuming a session with --resume loads the full JSONL history into CC context. A 488KB session history consumes most of the context window before the user types.", "what": "1. Measure actual token consumption at session start (before first user message) 2. Consider whether Gueridon sessions should skip skill loading or use lighter variants 3. For resume: investigate whether CC has a way to compact/summarize history rather than loading full JSONL 4. Document the context budget so users know what they are working with", "done": "Investigated in wt-sleuthing session b535b0c5. Per-turn cost is 11-16 tokens normally. The 14.5K/turn spike was cache prefix invalidation. Created scripts/context-profiler.py for future diagnosis."}, "status": "done", "parent": "gdn-besuse", "order": 6, "created_at": "2026-02-10T13:54:02Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:34:53Z"}
{"id": "gdn-wifana", "type": "action", "title": "Bridge session resolution picks up interactive CC session files", "brief": {"why": "getLatestSession finds the newest .jsonl regardless of who created it. An interactive 'claude' in tmux and a bridge-spawned 'claude -p' share the same project session directory. Phone replays terminal session history. RELATED: gdn-gebuni (dev sandbox) also needs isolated state — solve both with a state directory abstraction.", "what": "1. Tag bridge-created sessions (prefix, metadata, or separate subdir) 2. Filter getLatestSession to only match bridge-tagged sessions 3. Verify interactive sessions still work independently", "done": "Phone only shows sessions created through the bridge, never terminal CC sessions"}, "status": "done", "parent": "gdn-gebuni", "order": 1, "created_at": "2026-02-16T10:57:03Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T21:47:06Z", "updated_by": "edited", "done_at": "2026-02-21T22:36:47Z"}
{"id": "gdn-wiruvu", "type": "action", "title": "Hung CC process has no user-facing escape on mobile", "brief": {"why": "If CC hangs mid-turn (API timeout, stuck tool), the client has no abort button. The only escape is closing the tab, which triggers a slow chain: pong timeout (up to 60s) → idle check (5 min) → kill. No feedback to the user that anything is wrong. The bridge detects staleness after 10 min of no stdout, but only when no clients are connected.", "what": "TBD — two approaches: (a) better server-side detection (bridge notices CC is stuck and intervenes), (b) user-facing abort control on mobile, (c) both. Needs design thinking.", "done": "A hung CC process is either detected and killed automatically within a reasonable time, or the user has a way to intervene, or both."}, "status": "done", "parent": "gdn-situwu", "order": 29, "created_at": "2026-02-10T22:07:24Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T20:54:50Z", "updated_by": "edited", "done_at": "2026-02-23T23:53:00Z"}
{"id": "gdn-wisupe", "type": "action", "title": "Transport unit tests with mock WebSocket", "brief": {"why": "ws-transport.ts handles protocol discrimination, reconnect backoff, and prompt timeout — all testable with mock WebSocket and fake timers. Medium effort but catches real bugs (e.g. processExit not synthesizing result event).", "what": "1. Create src/ws-transport.test.ts 2. Stub global WebSocket with controllable mock 3. Test message dispatch (bridge vs cc source) 4. Test reconnect backoff (1s, 2s, 4s... 30s cap) with fake timers 5. Test prompt timeout (fires after 10s, clears on promptReceived) 6. Test processExit → synthetic result event", "done": "All tests pass with fake timers and mock WebSocket. No real connections needed."}, "status": "done", "parent": "gdn-vevoca", "order": 3, "created_at": "2026-02-09T06:38:56Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Create src/ws-transport.test.ts", "Stub global WebSocket with controllable mock", "Test message dispatch (bridge vs cc source)", "Test reconnect backoff (1s, 2s, 4s... 30s cap) with fake timers", "Test prompt timeout (fires after 10s, clears on promptReceived)", "Test processExit → synthetic result event"], "current": 6}, "done_at": "2026-02-09T09:41:13Z"}
{"id": "gdn-wiweka", "type": "action", "title": "Chat output streams character-by-character instead of chunked rendering", "brief": {"why": "StreamingMessageContainer renders every partial update as it arrives from CC, causing a teletype effect that's painful to watch on mobile. Content should appear in readable chunks, not character-by-character.", "what": "1. Profile where the per-character updates originate (CC stdout chunking vs adapter emit frequency vs Lit render batching) 2. Add debounce or requestAnimationFrame batching to streaming updates 3. Verify markdown rendering doesn't re-parse on every character", "done": "Streaming text appears in readable chunks. No visible character-by-character teletype effect."}, "status": "done", "parent": "gdn-cejaba", "order": 28, "created_at": "2026-02-10T08:37:46Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:52:33Z"}
{"id": "gdn-wodefa", "type": "action", "title": "Arc items created on kube don't sync back to Mac", "brief": {"why": "Arc stores items in .arc/items.jsonl inside each repo. Items created during a Gueridon session on kube exist only on kube. Same problem as handoffs — data created on one machine is invisible on the other.", "what": "1. Document as part of infra-sync analysis 2. For arc: git commit + push from kube after session, pull on Mac (or vice versa) 3. Consider whether /close on Gueridon should auto-commit .arc/ changes", "done": "Arc items created on either machine are visible on both within minutes"}, "status": "done", "parent": "gdn-hatiho", "order": 13, "created_at": "2026-02-10T08:47:38Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-10T19:59:38Z"}
{"id": "gdn-womabe", "type": "action", "title": "Set up vitest framework and npm test scripts", "brief": {"why": "No test framework exists. Need vitest (reuses vite.config.ts aliases and esbuild target), npm scripts, and basic config before any tests can be written.", "what": "1. npm install -D vitest 2. Add test and test:watch scripts to package.json 3. Verify vitest inherits vite.config.ts (pi-web-ui alias, es2020 target) 4. Write one trivial test (encodePath) to confirm setup works 5. Add jsdom devDep for future browser-side tests", "done": "npm test runs and passes. vitest picks up vite.config.ts aliases. One test exists and passes."}, "status": "done", "parent": "gdn-vevoca", "order": 1, "created_at": "2026-02-09T06:38:40Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["npm install -D vitest", "Add test and test:watch scripts to package.json", "Verify vitest inherits vite.config.ts (pi-web-ui alias, es2020 target)", "Write one trivial test (encodePath) to confirm setup works", "Add jsdom devDep for future browser-side tests"], "current": 5}, "done_at": "2026-02-09T09:20:14Z"}
{"id": "gdn-wukejo", "type": "action", "title": "End-to-end push test script", "brief": {"why": "No way to verify push pipeline works without waiting for a real CC turn. Silent non-delivery is the highest risk.", "what": "1. Create scripts/send-test-push.ts that imports push.ts and calls pushTurnComplete 2. Verify subscription exists, VAPID configured, notification arrives", "done": "Run npx tsx scripts/send-test-push.ts, phone buzzes"}, "status": "done", "parent": "gdn-situwu", "order": 25, "created_at": "2026-02-15T22:40:36Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T22:27:00Z", "updated_by": "edited", "done_at": "2026-02-24T05:13:15Z"}
{"id": "gdn-wumino", "type": "action", "title": "Fix compaction false positive on session resume", "brief": {"why": "Compaction toaster fires on brand new sessions after resume. _lastInputTokens accumulates during replay (only the callback is suppressed, not the tracking). First live assistant message with lower usage triggers the 20k/15% drop check against replay-inflated tokens. Seen on kube session warm-wolf.", "what": "1. Reset _lastInputTokens to 0 in endReplay() 2. Add test: replay with high-usage events then live message with low usage — verify no compaction callback 3. Verify existing compaction tests still pass", "done": "Resuming a session with replay history does not trigger compaction toaster. Genuine mid-session compaction still detected."}, "status": "done", "parent": "gdn-zewumo", "order": 5, "created_at": "2026-02-12T00:14:50Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:09:48Z"}
{"id": "gdn-wusici", "type": "action", "title": "Collapsed tool call headers look like thin strips on mobile", "brief": {"why": "Users can't tell tool calls happened — the collapsed header (chevron + name + preview) is ~30px tall and barely noticeable between message bubbles on phone. May be a design issue or a CSS rendering bug on iOS Safari.", "what": "1. Inspect on device with element inspector 2. Determine if header height is correct or truly collapsing to 2px 3. If design: increase header padding or add visual weight 4. If CSS bug: fix percentage width on tool-input-preview in flex context", "done": "Tool call blocks are clearly visible and tappable in the conversation flow on a real iOS device"}, "status": "done", "parent": "gdn-situwu", "order": 20, "created_at": "2026-02-21T21:47:57Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T20:46:23Z"}
{"id": "gdn-zalagi", "type": "action", "title": "Streaming content hijacks scroll position — user scroll should be inviolate", "brief": {"why": "renderMessages() (called on every SSE delta) ends with el.scrollTop = el.scrollHeight, unconditionally forcing scroll to bottom. If the user scrolls up to read earlier content, every streaming chunk drags them back down. Maddening in long conversations.", "what": "1. Track user scroll intent: if user has scrolled up (el.scrollTop + el.clientHeight < el.scrollHeight - threshold), set a userScrolledUp flag 2. Only auto-scroll to bottom when userScrolledUp is false 3. Clear userScrolledUp when user taps the input box (they want to see what they're replying to) 4. Clear userScrolledUp when user sends a message 5. Consider a 'jump to bottom' floating button when userScrolledUp is true (we already have jump-to-bottom from gdn-cewibe — check if it's wired)", "done": "Scrolling up during streaming stays put. Tapping input box or sending a message returns to bottom. No forced scroll during content deltas when user is reading earlier content."}, "status": "done", "parent": "gdn-situwu", "order": 46, "created_at": "2026-02-23T22:44:05Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:51:30Z"}
{"id": "gdn-zamaju", "type": "action", "title": "deleteFolder guards against deleting real project folders", "brief": {"why": "handleDeleteFolder in bridge.ts does rm -rf on the folder path. Fun-named scratch folders are expendable, but swiping on a real project (e.g. gueridon itself) would destroy it. No guard exists beyond path validation.", "what": "1. Add a safety check: only allow deletion of folders that were created by the bridge (fun-named pattern, or a .gueridon-created marker file) 2. For non-bridge folders, show a stronger warning or refuse 3. Add confirmation text that says 'permanently delete' for clarity", "done": "Cannot accidentally delete a real project folder via swipe-to-delete. Fun-named folders delete cleanly."}, "status": "done", "parent": "gdn-situwu", "order": 23, "created_at": "2026-02-15T20:29:22Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-24T05:11:47Z", "updated_by": "cleared", "done_at": "2026-02-24T05:11:47Z"}
{"id": "gdn-zaseze", "type": "action", "title": "Add automated replay integration test to test-bridge.ts", "brief": {"why": "The replay path breaks silently. Unit tests prove machinery works but the full send→refresh→replay path needs an integration test. Manual webctl verification catches issues but doesn't prevent regression.", "what": "1. In test-bridge.ts: connect to folder, send prompt, wait for response 2. Disconnect WS, reconnect to same folder 3. Verify historyStart/historyEnd messages received with buffered CC events 4. Verify message count matches pre-disconnect count", "done": "test-bridge.ts has a replay test that connects, prompts, disconnects, reconnects, and verifies buffer replay"}, "status": "done", "parent": "gdn-puzoni", "order": 3, "created_at": "2026-02-09T23:23:26Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-21T21:47:01Z", "updated_by": "edited", "done_at": "2026-02-21T22:56:11Z"}
{"id": "gdn-zecobi", "type": "action", "title": "Verify image resize works on iOS Safari", "brief": {"why": "OffscreenCanvas and createImageBitmap have spotty support on older iOS Safari. If they fail, resizeImage throws and handleSend shows a toast but the image never sends.", "what": "1. Open kube:3001 on phone 2. Attach a photo from camera roll 3. Verify thumbnail appears 4. Send and confirm CC responds to image content 5. Check console for canvas errors", "done": "Image sent and understood by CC from iOS Safari. No console errors from canvas APIs."}, "status": "done", "parent": "gdn-situwu", "order": 28, "created_at": "2026-02-12T08:06:47Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-23T20:48:08Z", "updated_by": "edited", "done_at": "2026-02-24T05:13:15Z"}
{"id": "gdn-zejeji", "type": "action", "title": "New session shows previous session's message thread in UI", "brief": {"why": "When a new CC session starts (new session ID), the mobile UI still shows the previous session's messages. The user sees continuity that doesn't exist — the new Claude has no context of those messages. Separately, the previous session (f7066a9a) appears to have been replaced without /exit, suggesting session resolution started fresh when it shouldn't have. Two bugs: (A) UI shows stale message thread from previous session, (B) previous session was abandoned without /exit but a new session started anyway.", "what": "1. Investigate session f7066a9a (previous, permissions work) and a3ae74d0 (current) — why did the bridge start a new session? Check session resolution logic. 2. Investigate why UI showed old messages — is messageBuffer not cleared on new session? Is replay pulling from the wrong session? 3. Investigate context gauge showing old session's usage (55%) — adapter state not reset on new session 4. Fix all three: clean message thread, clean gauge, correct session resolution 5. Also check the tiny 743da68d session (4KB, 18:43) — possibly a failed reconnect?", "done": "New session starts with clean UI. Previous session's messages don't bleed through. Session resolution correctly handles transition between sessions."}, "status": "done", "parent": "gdn-besuse", "order": 20, "created_at": "2026-02-16T19:14:29Z", "created_by": "spm1001", "waiting_for": null, "updated_at": "2026-02-16T19:18:39Z", "tactical": {"steps": ["Investigate session f7066a9a (previous, permissions work) and a3ae74d0 (current) — why did the bridge start a new session? Check session resolution logic.", "Investigate why UI showed old messages — is messageBuffer not cleared on new session? Is replay pulling from the wrong session?", "Investigate context gauge showing old session's usage (55%) — adapter state not reset on new session", "Fix all three: clean message thread, clean gauge, correct session resolution", "Also check the tiny 743da68d session (4KB, 18:43) — possibly a failed reconnect?"], "current": 5, "session": "/home/modha/Repos/gueridon"}, "done_at": "2026-02-16T19:18:39Z"}
{"id": "gdn-zerobu", "type": "action", "title": "Shared CC event interpreter for web and CLI clients", "brief": {"why": "Both the web UI (claude-code-agent.ts) and CLI client (cli/gdn.ts) independently translate raw CC events into their own rendering format. As the CLI matures (tool calls, AskUserQuestion, abort, error handling), it will reimplement the same event interpretation logic. The shared piece is 'CC event → semantic intent' — each client then renders the intent in its own way.", "what": "1. Extract CC event interpretation into a shared module (event types, turn detection, usage extraction, tool call lifecycle). 2. Web adapter consumes shared types, maps to AgentEvent for Lit. 3. CLI adapter consumes shared types, maps to ANSI output. 4. Both clients benefit from bug fixes in one place.", "done": "A shared event interpreter module exists. Both web and CLI clients import it. Adding a new CC event type requires one code change, not two."}, "status": "done", "parent": "gdn-paciju", "order": 6, "created_at": "2026-02-11T13:56:57Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T21:39:20Z"}
{"id": "gdn-zewumo", "type": "outcome", "title": "Claude's experience through the bridge is clean and predictable", "brief": {"why": "Claude is a user of the bridge too. Errors, missing signals, and workarounds degrade output quality — Claude wastes tokens retrying, apologising for expected errors, or making conservative choices because it can't see context pressure. The bridge should be as transparent to Claude as it is to the human.", "what": "1. Parallel tool calls don't poison siblings on failure 2. AskUserQuestion works without error-then-workaround 3. Context gauge visible to Claude (not just rendered for human) 4. Typing/composing indicator in protocol 5. Hook errors distinguishable from real failures", "done": "A Claude session through Gueridon produces zero spurious errors in the tool stream. Claude can see context pressure. No workarounds documented in system prompts for expected failures."}, "status": "done", "order": 15, "created_at": "2026-02-11T07:58:46Z", "created_by": "spm1001", "done_at": "2026-02-23T21:32:05Z"}
{"id": "gdn-zibaha", "type": "action", "title": "Folder dialog opens then immediately closes", "brief": {"why": "Dialog flashes then disappears on page load. onSessionId fires right after onFolderList, closing the dialog before user can interact. CWD shows itv-linkedin-analytics without user selection — something is auto-connecting.", "what": "1. Reproduce: open app, observe dialog flash 2. Add event sequence logging to identify which callback closes the dialog 3. If root cause is same as gdn-jebudo, mark as duplicate 4. If different, fix the specific trigger", "done": "Dialog stays open on fresh page load until user selects a folder. No flash."}, "status": "done", "parent": "gdn-hatiho", "order": 6, "created_at": "2026-02-09T09:04:31Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-09T15:57:00Z"}
{"id": "gdn-zibeji", "type": "action", "title": "Add tests for bridge review fixes", "brief": {"why": "Three fixes landed from bridge review (ping/pong handler removal, double folder scan elimination, lobbyQueue error recovery) — existing tests pass but no new tests cover the fixed behaviour. Regressions could reintroduce the double scan or the missing .catch().", "what": "1. Test that stopPingPong removes pong listener (verify no duplicate registration on hypothetical double-start). 2. Test lobbyQueue error recovery — a failing message doesn't kill subsequent messages. 3. Test connectFolder uses cached session object (no second scan).", "done": "bridge-logic.test.ts or bridge integration tests cover all three fixes."}, "status": "done", "parent": "gdn-besuse", "order": 12, "created_at": "2026-02-11T13:57:16Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-15T20:26:05Z"}
{"id": "gdn-zigepu", "type": "outcome", "title": "Vendored pi-web-ui drift surfaces before it bites us", "brief": {"why": "Vendored 6 files from pi-mono are frozen at commit 41c4157b. Mario's upstream changes (bug fixes, improvements) are invisible to us. We want the good stuff, not the sprawl — but first we need to know when things change.", "what": "Git-based drift detection: provenance file in guéridon records commit + file mapping, update-all.sh HEAVY tier diffs our 6 files against upstream/main daily, reports drift in session-start news.", "done": "When Mario changes any of our 6 vendored files in pi-mono, next session start shows which files changed and how much. No drift = silent."}, "status": "done", "order": 6, "created_at": "2026-02-09T14:59:55Z", "created_by": "spm1001", "done_at": "2026-02-09T20:12:31Z"}
{"id": "gdn-zokive", "type": "action", "title": "Push notifications unreliable after bridge restart", "brief": {"why": "After bridge restart, disk-persisted push subscriptions load but the first turn completions don't trigger push sends. The phone's service worker re-subscribes on SSE reconnect, but there's a race — turns complete before the re-subscribe arrives. Stale subscriptions from previous browser sessions may also be a factor.", "what": "1. Promote push:subscriptions-loaded to info level so it's visible in journalctl 2. Verify disk-loaded subscriptions are still valid (test send on startup?) 3. Investigate the timing gap: turn:complete at 06:19 and 06:21, push:subscribe at 06:22 4. Consider: bridge should hold turn-complete notifications briefly if no subscriptions are loaded yet", "done": "Push notifications arrive reliably after bridge restart. No silent gap between restart and first notification."}, "status": "open", "parent": "gdn-situwu", "order": 65, "created_at": "2026-02-24T06:24:13Z", "created_by": "spm1001", "waiting_for": null}
{"id": "gdn-zonane", "type": "action", "title": "Context gauge missing until first CC response", "brief": {"why": "The context percentage only appears after the first assistant message returns usage data. Before that, context_pct is 0, and 'if (pct)' is falsy so the gauge shows nothing. Visible across multiple screenshots — status bar shows folder name and model but no percentage.", "what": "1. Change condition from 'if (pct)' to 'if (pct \\!== undefined && pct \\!== null)' — show 0% when connected 2. Or: show gauge as soon as a session is connected, display '0%' or a placeholder until real data arrives", "done": "Context gauge visible from session connect, shows 0% initially, updates after first response."}, "status": "done", "parent": "gdn-situwu", "order": 50, "created_at": "2026-02-23T22:55:39Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-23T23:47:51Z"}
{"id": "gdn-zovogo", "type": "outcome", "title": "Bridge folder awareness — scan, enrich, connect", "brief": {"why": "The folder chooser needs to know: which folders exist, which have active/paused/closed sessions, and what each was working on. The bridge is the only actor with filesystem access. No registry — derive all state from CC session files + handoffs + runtime.", "what": "Folder scan module, bridge lobby mode, folder protocol (listFolders/connectFolder), multi-WS broadcast, transport API", "done": "Bridge returns enriched folder list. Multiple tabs can connect to different folders simultaneously. All state derived from filesystem, no registry file."}, "status": "done", "parent": null, "order": 4, "created_at": "2026-02-08T22:12:47Z", "created_by": "spm1001", "done_at": "2026-02-09T07:20:51Z"}
{"id": "gdn-zuhacu", "type": "action", "title": "GueridonInterface syncs pendingToolCalls on tool execution events", "brief": {"why": "handleAssistantComplete emits message_end BEFORE adding to pendingToolCalls. tool_execution_start/end aren't in the subscription handler, so UI only sees stale pendingToolCalls until the next message_end or agent_end.", "what": "1. Add tool_execution_start and tool_execution_end cases to setupSubscription switch in gueridon-interface.ts 2. Each case calls syncState() to push updated pendingToolCalls to the UI 3. Add test in gueridon-interface.test.ts: emit tool_execution_start, verify _pendingToolCalls updated", "done": "Tool spinner appears immediately when tool_execution_start fires, not delayed until next message_end"}, "status": "done", "parent": "gdn-cejaba", "order": 14, "created_at": "2026-02-09T11:10:10Z", "created_by": "spm1001", "waiting_for": null, "tactical": {"steps": ["Add tool_execution_start/end to setupSubscription in gueridon-interface.ts", "Add test in gueridon-interface.test.ts"], "current": 2}, "done_at": "2026-02-09T16:18:22Z"}
{"id": "gdn-zusavu", "type": "action", "title": "Commit compaction false positive WIP or branch it", "brief": {"why": "Stashed changes (test + fix for replay→live compaction false positive) are sitting loose in git stash. Easy to lose or forget. The fix resets _lastInputTokens at endReplay() to prevent spurious compaction detection.", "what": "1. Pop stash 2. Review the test and fix 3. Either commit directly (if complete) or create a branch for further work", "done": "Compaction WIP has a permanent home — either committed to main or on a named branch."}, "status": "done", "parent": "gdn-zewumo", "order": 6, "created_at": "2026-02-12T08:07:02Z", "created_by": "spm1001", "waiting_for": null, "done_at": "2026-02-12T19:09:48Z"}
